2019-10-14 17:35:31.956 -04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-10-14 17:35:32.569 -04:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-10-14 17:35:32.570 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-10-14 17:35:32.570 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-10-14 17:35:32.570 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-10-14 17:35:32.570 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-10-14 17:35:32.570 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-10-14 17:35:33.428 -04:00 [DBG] Login Url: /Account/Login
2019-10-14 17:35:33.431 -04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-10-14 17:35:33.431 -04:00 [DBG] Logout Url: /Account/Logout
2019-10-14 17:35:33.431 -04:00 [DBG] ConsentUrl Url: /consent
2019-10-14 17:35:33.431 -04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-10-14 17:35:33.431 -04:00 [DBG] Error Url: /home/error
2019-10-14 17:35:33.431 -04:00 [DBG] Error Id Parameter: errorId
2019-10-14 17:36:01.379 -04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-10-14 17:36:01.383 -04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-10-14 17:36:01.383 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-10-14 17:36:01.387 -04:00 [DBG] Start discovery request
2019-10-14 17:36:37.272 -04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-10-14 17:36:37.716 -04:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-10-14 17:36:37.716 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-10-14 17:36:37.716 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-10-14 17:36:37.716 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-10-14 17:36:37.716 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-10-14 17:36:37.717 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-10-14 17:36:38.438 -04:00 [DBG] Login Url: /Account/Login
2019-10-14 17:36:38.440 -04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-10-14 17:36:38.440 -04:00 [DBG] Logout Url: /Account/Logout
2019-10-14 17:36:38.440 -04:00 [DBG] ConsentUrl Url: /consent
2019-10-14 17:36:38.440 -04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-10-14 17:36:38.440 -04:00 [DBG] Error Url: /home/error
2019-10-14 17:36:38.440 -04:00 [DBG] Error Id Parameter: errorId
2019-10-14 17:36:40.352 -04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-10-14 17:36:40.355 -04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-10-14 17:36:40.356 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-10-14 17:36:40.360 -04:00 [DBG] Start discovery request
2019-10-14 17:42:04.781 -04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-10-14 17:42:05.193 -04:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-10-14 17:42:05.193 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-10-14 17:42:05.193 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-10-14 17:42:05.193 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-10-14 17:42:05.193 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-10-14 17:42:05.194 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-10-14 17:42:10.961 -04:00 [DBG] Login Url: /Account/Login
2019-10-14 17:42:10.963 -04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-10-14 17:42:10.963 -04:00 [DBG] Logout Url: /Account/Logout
2019-10-14 17:42:10.963 -04:00 [DBG] ConsentUrl Url: /consent
2019-10-14 17:42:10.963 -04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-10-14 17:42:10.963 -04:00 [DBG] Error Url: /home/error
2019-10-14 17:42:10.964 -04:00 [DBG] Error Id Parameter: errorId
2019-10-14 17:42:13.103 -04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-10-14 17:42:13.107 -04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-10-14 17:42:13.107 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-10-14 17:42:13.111 -04:00 [DBG] Start discovery request
2019-10-14 17:42:23.761 -04:00 [INF] AuthenticationScheme: idsrv was challenged.
2019-10-14 17:46:09.376 -04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-10-14 17:46:09.805 -04:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-10-14 17:46:09.805 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-10-14 17:46:09.805 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-10-14 17:46:09.805 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-10-14 17:46:09.805 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-10-14 17:46:09.805 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-10-14 17:46:10.484 -04:00 [DBG] Login Url: /Account/Login
2019-10-14 17:46:10.487 -04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-10-14 17:46:10.487 -04:00 [DBG] Logout Url: /Account/Logout
2019-10-14 17:46:10.487 -04:00 [DBG] ConsentUrl Url: /consent
2019-10-14 17:46:10.487 -04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-10-14 17:46:10.487 -04:00 [DBG] Error Url: /home/error
2019-10-14 17:46:10.487 -04:00 [DBG] Error Id Parameter: errorId
2019-10-14 17:46:13.442 -04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-10-14 17:46:13.445 -04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-10-14 17:46:13.445 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-10-14 17:46:13.449 -04:00 [DBG] Start discovery request
2019-10-14 17:46:38.551 -04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-10-14 17:46:38.551 -04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-10-14 17:46:38.552 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-10-14 17:46:38.552 -04:00 [DBG] Start discovery request
2019-10-14 17:46:50.136 -04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-10-14 17:46:50.136 -04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-10-14 17:46:50.136 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-10-14 17:46:50.136 -04:00 [DBG] Start discovery request
2019-10-14 17:46:51.220 -04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-10-14 17:46:51.220 -04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-10-14 17:46:51.220 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-10-14 17:46:51.220 -04:00 [DBG] Start discovery request
2019-10-14 17:46:52.059 -04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-10-14 17:46:52.059 -04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-10-14 17:46:52.059 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-10-14 17:46:52.059 -04:00 [DBG] Start discovery request
2019-10-14 17:46:52.835 -04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-10-14 17:46:52.835 -04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-10-14 17:46:52.835 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-10-14 17:46:52.836 -04:00 [DBG] Start discovery request
2019-10-14 17:46:53.583 -04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-10-14 17:46:53.583 -04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-10-14 17:46:53.583 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-10-14 17:46:53.584 -04:00 [DBG] Start discovery request
2019-10-14 17:47:18.639 -04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-10-14 17:47:19.096 -04:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-10-14 17:47:19.096 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-10-14 17:47:19.096 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-10-14 17:47:19.097 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-10-14 17:47:19.097 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-10-14 17:47:19.097 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-10-14 17:47:19.685 -04:00 [DBG] Login Url: /Account/Login
2019-10-14 17:47:19.688 -04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-10-14 17:47:19.688 -04:00 [DBG] Logout Url: /Account/Logout
2019-10-14 17:47:19.688 -04:00 [DBG] ConsentUrl Url: /consent
2019-10-14 17:47:19.688 -04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-10-14 17:47:19.689 -04:00 [DBG] Error Url: /home/error
2019-10-14 17:47:19.689 -04:00 [DBG] Error Id Parameter: errorId
2019-10-14 17:47:21.186 -04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-10-14 17:47:21.189 -04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-10-14 17:47:21.189 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-10-14 17:47:21.194 -04:00 [DBG] Start discovery request
2019-10-14 17:47:31.288 -04:00 [INF] AuthenticationScheme: idsrv was challenged.
2019-10-14 17:47:34.897 -04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-10-14 17:47:34.897 -04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-10-14 17:47:34.897 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-10-14 17:47:34.897 -04:00 [DBG] Start discovery request
2019-10-14 17:51:17.436 -04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-10-14 17:51:17.944 -04:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-10-14 17:51:17.944 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-10-14 17:51:17.944 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-10-14 17:51:17.944 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-10-14 17:51:17.944 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-10-14 17:51:17.944 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-10-14 17:52:01.593 -04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-10-14 17:54:17.754 -04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-10-14 17:54:18.142 -04:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-10-14 17:54:18.142 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-10-14 17:54:18.142 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-10-14 17:54:18.142 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-10-14 17:54:18.142 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-10-14 17:54:18.142 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-10-14 17:55:01.777 -04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-10-14 17:55:02.117 -04:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-10-14 17:55:02.117 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-10-14 17:55:02.117 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-10-14 17:55:02.117 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-10-14 17:55:02.117 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-10-14 17:55:02.117 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-10-14 17:55:03.736 -04:00 [DBG] Login Url: /Account/Login
2019-10-14 17:55:03.738 -04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-10-14 17:55:03.738 -04:00 [DBG] Logout Url: /Account/Logout
2019-10-14 17:55:03.739 -04:00 [DBG] ConsentUrl Url: /consent
2019-10-14 17:55:03.739 -04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-10-14 17:55:03.739 -04:00 [DBG] Error Url: /home/error
2019-10-14 17:55:03.739 -04:00 [DBG] Error Id Parameter: errorId
2019-10-14 17:56:17.888 -04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-10-14 17:56:18.339 -04:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-10-14 17:56:18.339 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-10-14 17:56:18.339 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-10-14 17:56:18.339 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-10-14 17:56:18.339 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-10-14 17:56:18.340 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-10-14 17:56:41.942 -04:00 [DBG] Login Url: /Account/Login
2019-10-14 17:56:41.945 -04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-10-14 17:56:41.945 -04:00 [DBG] Logout Url: /Account/Logout
2019-10-14 17:56:41.945 -04:00 [DBG] ConsentUrl Url: /consent
2019-10-14 17:56:41.945 -04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-10-14 17:56:41.945 -04:00 [DBG] Error Url: /home/error
2019-10-14 17:56:41.945 -04:00 [DBG] Error Id Parameter: errorId
2019-10-14 17:56:44.106 -04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-10-14 17:56:44.110 -04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-10-14 17:56:44.111 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-10-14 17:56:44.115 -04:00 [DBG] Start discovery request
2019-10-14 17:58:05.277 -04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-10-14 17:58:05.724 -04:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-10-14 17:58:05.724 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-10-14 17:58:05.724 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-10-14 17:58:05.725 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-10-14 17:58:05.725 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-10-14 17:58:05.725 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-10-14 17:58:35.717 -04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-10-14 17:58:36.019 -04:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-10-14 17:58:36.019 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-10-14 17:58:36.019 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-10-14 17:58:36.019 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-10-14 17:58:36.019 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-10-14 17:58:36.019 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-10-14 17:58:36.476 -04:00 [FTL] Application startup exception
System.ArgumentException: An item with the same key has already been added. Key: IdentityServer4.Models.Client
   at System.Collections.Generic.Dictionary`2.TryInsert(TKey key, TValue value, InsertionBehavior behavior)
   at MongoDB.Bson.Serialization.BsonClassMap.RegisterClassMap(BsonClassMap classMap)
   at MongoDB.Bson.Serialization.BsonClassMap.RegisterClassMap[TClass](Action`1 classMapInitializer)
   at IdentityServer.Startup.ConfigureMongoDriver2IgnoreExtraElements() in C:\_Repo\IdentityServer4.Samples.Mongo\IdentityServer4-Samples\7_EntityFrameworkStorage-mongo\src\IdentityServer\Startup.cs:line 171
   at IdentityServer.Startup.InitializeDatabase(IApplicationBuilder app) in C:\_Repo\IdentityServer4.Samples.Mongo\IdentityServer4-Samples\7_EntityFrameworkStorage-mongo\src\IdentityServer\Startup.cs:line 130
   at IdentityServer.Startup.Configure(IApplicationBuilder app, IHostingEnvironment env) in C:\_Repo\IdentityServer4.Samples.Mongo\IdentityServer4-Samples\7_EntityFrameworkStorage-mongo\src\IdentityServer\Startup.cs:line 113
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)
   at Microsoft.AspNetCore.Server.IISIntegration.IISSetupFilter.<>c__DisplayClass4_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()
2019-10-14 17:58:46.154 -04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-10-14 17:58:46.626 -04:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-10-14 17:58:46.626 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-10-14 17:58:46.626 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-10-14 17:58:46.626 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-10-14 17:58:46.626 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-10-14 17:58:46.626 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-10-14 17:58:49.769 -04:00 [DBG] Login Url: /Account/Login
2019-10-14 17:58:49.771 -04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-10-14 17:58:49.771 -04:00 [DBG] Logout Url: /Account/Logout
2019-10-14 17:58:49.771 -04:00 [DBG] ConsentUrl Url: /consent
2019-10-14 17:58:49.771 -04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-10-14 17:58:49.771 -04:00 [DBG] Error Url: /home/error
2019-10-14 17:58:49.771 -04:00 [DBG] Error Id Parameter: errorId
2019-10-14 17:58:55.433 -04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-10-14 17:58:55.436 -04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-10-14 17:58:55.437 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-10-14 17:58:55.440 -04:00 [DBG] Start discovery request
2019-10-14 17:59:21.970 -04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-10-14 17:59:22.381 -04:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-10-14 17:59:22.382 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-10-14 17:59:22.382 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-10-14 17:59:22.382 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-10-14 17:59:22.382 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-10-14 17:59:22.382 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-10-14 17:59:42.960 -04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-10-14 17:59:43.253 -04:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-10-14 17:59:43.254 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-10-14 17:59:43.254 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-10-14 17:59:43.254 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-10-14 17:59:43.254 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-10-14 17:59:43.254 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-10-14 18:00:00.721 -04:00 [FTL] Application startup exception
System.ArgumentException: An item with the same key has already been added. Key: IdentityServer4.Models.Client
   at System.Collections.Generic.Dictionary`2.TryInsert(TKey key, TValue value, InsertionBehavior behavior)
   at MongoDB.Bson.Serialization.BsonClassMap.RegisterClassMap(BsonClassMap classMap)
   at MongoDB.Bson.Serialization.BsonClassMap.RegisterClassMap[TClass](Action`1 classMapInitializer)
   at IdentityServer.Startup.ConfigureMongoDriver2IgnoreExtraElements() in C:\_Repo\IdentityServer4.Samples.Mongo\IdentityServer4-Samples\7_EntityFrameworkStorage-mongo\src\IdentityServer\Startup.cs:line 171
   at IdentityServer.Startup.InitializeDatabase(IApplicationBuilder app) in C:\_Repo\IdentityServer4.Samples.Mongo\IdentityServer4-Samples\7_EntityFrameworkStorage-mongo\src\IdentityServer\Startup.cs:line 130
   at IdentityServer.Startup.Configure(IApplicationBuilder app, IHostingEnvironment env) in C:\_Repo\IdentityServer4.Samples.Mongo\IdentityServer4-Samples\7_EntityFrameworkStorage-mongo\src\IdentityServer\Startup.cs:line 113
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)
   at Microsoft.AspNetCore.Server.IISIntegration.IISSetupFilter.<>c__DisplayClass4_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()
2019-10-14 18:01:41.838 -04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-10-14 18:01:42.301 -04:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-10-14 18:01:42.301 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-10-14 18:01:42.301 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-10-14 18:01:42.301 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-10-14 18:01:42.301 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-10-14 18:01:42.301 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-10-14 18:01:59.886 -04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-10-14 18:02:00.186 -04:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-10-14 18:02:00.186 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-10-14 18:02:00.186 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-10-14 18:02:00.186 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-10-14 18:02:00.186 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-10-14 18:02:00.186 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-10-14 18:02:00.584 -04:00 [DBG] Login Url: /Account/Login
2019-10-14 18:02:00.586 -04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-10-14 18:02:00.586 -04:00 [DBG] Logout Url: /Account/Logout
2019-10-14 18:02:00.586 -04:00 [DBG] ConsentUrl Url: /consent
2019-10-14 18:02:00.586 -04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-10-14 18:02:00.586 -04:00 [DBG] Error Url: /home/error
2019-10-14 18:02:00.586 -04:00 [DBG] Error Id Parameter: errorId
2019-10-14 18:15:41.032 -04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-10-14 18:15:41.647 -04:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-10-14 18:15:41.647 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-10-14 18:15:41.647 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-10-14 18:15:41.647 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-10-14 18:15:41.647 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-10-14 18:15:41.647 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-10-14 18:15:46.056 -04:00 [DBG] Login Url: /Account/Login
2019-10-14 18:15:46.059 -04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-10-14 18:15:46.060 -04:00 [DBG] Logout Url: /Account/Logout
2019-10-14 18:15:46.060 -04:00 [DBG] ConsentUrl Url: /consent
2019-10-14 18:15:46.060 -04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-10-14 18:15:46.060 -04:00 [DBG] Error Url: /home/error
2019-10-14 18:15:46.060 -04:00 [DBG] Error Id Parameter: errorId
2019-10-14 18:15:46.097 -04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-10-14 18:15:46.101 -04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-10-14 18:15:46.102 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-10-14 18:15:46.106 -04:00 [DBG] Start discovery request
2019-10-14 18:15:47.390 -04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-10-14 18:15:47.685 -04:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-10-14 18:15:47.685 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-10-14 18:15:47.685 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-10-14 18:15:47.685 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-10-14 18:15:47.685 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-10-14 18:15:47.686 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-10-14 18:15:48.112 -04:00 [DBG] Login Url: /Account/Login
2019-10-14 18:15:48.114 -04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-10-14 18:15:48.114 -04:00 [DBG] Logout Url: /Account/Logout
2019-10-14 18:15:48.114 -04:00 [DBG] ConsentUrl Url: /consent
2019-10-14 18:15:48.114 -04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-10-14 18:15:48.114 -04:00 [DBG] Error Url: /home/error
2019-10-14 18:15:48.114 -04:00 [DBG] Error Id Parameter: errorId
2019-10-14 18:15:48.142 -04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-10-14 18:15:48.145 -04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-10-14 18:15:48.145 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-10-14 18:15:48.149 -04:00 [DBG] Start key discovery request
2019-10-14 18:16:21.075 -04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-10-14 18:16:21.573 -04:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-10-14 18:16:21.573 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-10-14 18:16:21.573 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-10-14 18:16:21.573 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-10-14 18:16:21.573 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-10-14 18:16:21.573 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-10-14 18:16:22.266 -04:00 [DBG] Login Url: /Account/Login
2019-10-14 18:16:22.268 -04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-10-14 18:16:22.268 -04:00 [DBG] Logout Url: /Account/Logout
2019-10-14 18:16:22.269 -04:00 [DBG] ConsentUrl Url: /consent
2019-10-14 18:16:22.269 -04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-10-14 18:16:22.269 -04:00 [DBG] Error Url: /home/error
2019-10-14 18:16:22.269 -04:00 [DBG] Error Id Parameter: errorId
2019-10-14 18:16:22.301 -04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-10-14 18:16:22.304 -04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-10-14 18:16:22.304 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-10-14 18:16:22.308 -04:00 [DBG] Start discovery request
2019-10-14 18:16:22.621 -04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-10-14 18:16:22.622 -04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-10-14 18:16:22.622 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-10-14 18:16:22.627 -04:00 [DBG] Start key discovery request
2019-10-14 18:16:22.938 -04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-10-14 18:16:22.944 -04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-10-14 18:16:22.944 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-10-14 18:16:22.950 -04:00 [DBG] Start token request.
2019-10-14 18:16:22.957 -04:00 [DBG] Start client validation
2019-10-14 18:16:22.961 -04:00 [DBG] Start parsing Basic Authentication secret
2019-10-14 18:16:22.965 -04:00 [DBG] Start parsing for secret in post body
2019-10-14 18:16:22.982 -04:00 [DBG] Parser found secret: PostBodySecretParser
2019-10-14 18:16:22.983 -04:00 [DBG] Secret id found: client
2019-10-14 18:16:23.080 -04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-10-14 18:16:23.080 -04:00 [DBG] Client validation success
2019-10-14 18:16:23.090 -04:00 [DBG] Start token request validation
2019-10-14 18:16:23.099 -04:00 [DBG] Start client credentials token request validation
2019-10-14 18:16:23.193 -04:00 [DBG] client credentials token request validation success
2019-10-14 18:16:23.205 -04:00 [INF] Token request validation success
{"ClientId":"client","ClientName":null,"GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"scope":"api1","grant_type":"client_credentials","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-10-14 18:16:23.236 -04:00 [DBG] Getting claims for access token for client: client
2019-10-14 18:16:23.301 -04:00 [DBG] Token request success.
2019-10-14 18:16:23.569 -04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-10-14 18:16:23.569 -04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-10-14 18:16:23.569 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-10-14 18:16:23.569 -04:00 [DBG] Start discovery request
2019-10-14 18:16:23.785 -04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-10-14 18:16:23.786 -04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-10-14 18:16:23.786 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-10-14 18:16:23.786 -04:00 [DBG] Start key discovery request
2019-10-14 18:17:27.871 -04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-10-14 18:17:33.271 -04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-10-14 18:17:33.580 -04:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-10-14 18:17:33.580 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-10-14 18:17:33.580 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-10-14 18:17:33.580 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-10-14 18:17:33.581 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-10-14 18:17:33.581 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-10-14 18:17:34.176 -04:00 [DBG] Login Url: /Account/Login
2019-10-14 18:17:34.177 -04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-10-14 18:17:34.178 -04:00 [DBG] Logout Url: /Account/Logout
2019-10-14 18:17:34.178 -04:00 [DBG] ConsentUrl Url: /consent
2019-10-14 18:17:34.178 -04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-10-14 18:17:34.178 -04:00 [DBG] Error Url: /home/error
2019-10-14 18:17:34.178 -04:00 [DBG] Error Id Parameter: errorId
2019-10-14 18:17:43.200 -04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-10-14 18:17:43.814 -04:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-10-14 18:17:43.814 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-10-14 18:17:43.815 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-10-14 18:17:43.815 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-10-14 18:17:43.815 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-10-14 18:17:43.815 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-10-14 18:17:44.554 -04:00 [DBG] Login Url: /Account/Login
2019-10-14 18:17:44.557 -04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-10-14 18:17:44.557 -04:00 [DBG] Logout Url: /Account/Logout
2019-10-14 18:17:44.557 -04:00 [DBG] ConsentUrl Url: /consent
2019-10-14 18:17:44.557 -04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-10-14 18:17:44.557 -04:00 [DBG] Error Url: /home/error
2019-10-14 18:17:44.557 -04:00 [DBG] Error Id Parameter: errorId
2019-10-14 18:17:49.774 -04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-10-14 18:17:49.778 -04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-10-14 18:17:49.778 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-10-14 18:17:49.782 -04:00 [DBG] Start discovery request
2019-10-14 18:17:50.047 -04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-10-14 18:17:50.048 -04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-10-14 18:17:50.048 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-10-14 18:17:50.052 -04:00 [DBG] Start key discovery request
2019-10-14 18:17:50.126 -04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-10-14 18:17:50.129 -04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-10-14 18:17:50.129 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-10-14 18:17:50.133 -04:00 [DBG] Start authorize request
2019-10-14 18:17:50.142 -04:00 [DBG] No user present in authorize request
2019-10-14 18:17:50.147 -04:00 [DBG] Start authorize request protocol validation
2019-10-14 18:17:50.234 -04:00 [DBG] Checking for PKCE parameters
2019-10-14 18:17:50.236 -04:00 [DBG] No PKCE used.
2019-10-14 18:17:50.331 -04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-10-14 18:17:50.345 -04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8HEYsJy9qqlNnBmkeqP-XBro9aROfcFgqXe7oxDrDw0Vw2jbSZTBDgbTf-FNLlAo9rW0smPDVr_5nkpwoRjwya5MiOOxRH52g98ThF2SN_1Dy-D8JThHPtx6Qvz-mF2fb7Z5X1VAPs6CHRrCN9lM0Xl1XzBWM_Rsxh9s4Sf2J1TiLbBgDh7GNFV3zCRodHuGrfOSyEYuImI05silBEGBwLgt8HWH8Z_fGVD6E2clFE8vtgkEf9DRT_ocCV51gTT6kaoCtnkn1i3jb1sfAoafDbM_Pkk8uhuN-xJc7nYJUnWcwSY6yr5wfQQ8_RdKSp2yDVEKjZyNXieW05EsnpdMq4s","UiLocales":null,"Nonce":"637066882700928863.ZjE0ODRmN2MtZjZjNi00MWZmLWEyOGMtOTU3MzRmZGVjZmY2MWRlZTAxNmUtZmFkNy00YmI0LWE4NGEtODVkOTJkYmM2Y2Q0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637066882700928863.ZjE0ODRmN2MtZjZjNi00MWZmLWEyOGMtOTU3MzRmZGVjZmY2MWRlZTAxNmUtZmFkNy00YmI0LWE4NGEtODVkOTJkYmM2Y2Q0","state":"CfDJ8HEYsJy9qqlNnBmkeqP-XBro9aROfcFgqXe7oxDrDw0Vw2jbSZTBDgbTf-FNLlAo9rW0smPDVr_5nkpwoRjwya5MiOOxRH52g98ThF2SN_1Dy-D8JThHPtx6Qvz-mF2fb7Z5X1VAPs6CHRrCN9lM0Xl1XzBWM_Rsxh9s4Sf2J1TiLbBgDh7GNFV3zCRodHuGrfOSyEYuImI05silBEGBwLgt8HWH8Z_fGVD6E2clFE8vtgkEf9DRT_ocCV51gTT6kaoCtnkn1i3jb1sfAoafDbM_Pkk8uhuN-xJc7nYJUnWcwSY6yr5wfQQ8_RdKSp2yDVEKjZyNXieW05EsnpdMq4s","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-10-14 18:17:50.364 -04:00 [INF] Showing login: User is not authenticated
2019-10-14 18:17:50.440 -04:00 [DBG] Start authorize request protocol validation
2019-10-14 18:17:50.442 -04:00 [DBG] Checking for PKCE parameters
2019-10-14 18:17:50.443 -04:00 [DBG] No PKCE used.
2019-10-14 18:17:50.455 -04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-10-14 18:18:00.660 -04:00 [DBG] Start authorize request protocol validation
2019-10-14 18:18:00.662 -04:00 [DBG] Checking for PKCE parameters
2019-10-14 18:18:00.663 -04:00 [DBG] No PKCE used.
2019-10-14 18:18:00.679 -04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-10-14 18:18:00.700 -04:00 [DBG] Augmenting SignInContext
2019-10-14 18:18:00.702 -04:00 [DBG] Adding idp claim with value: local
2019-10-14 18:18:00.703 -04:00 [DBG] Adding amr claim with value: pwd
2019-10-14 18:18:00.718 -04:00 [INF] AuthenticationScheme: idsrv signed in.
2019-10-14 18:18:00.746 -04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-10-14 18:18:00.747 -04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-10-14 18:18:00.747 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-10-14 18:18:00.752 -04:00 [DBG] Start authorize callback request
2019-10-14 18:18:00.757 -04:00 [DBG] User in authorize request: 2
2019-10-14 18:18:00.757 -04:00 [DBG] Start authorize request protocol validation
2019-10-14 18:18:00.760 -04:00 [DBG] Checking for PKCE parameters
2019-10-14 18:18:00.760 -04:00 [DBG] No PKCE used.
2019-10-14 18:18:00.773 -04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-10-14 18:18:00.773 -04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8HEYsJy9qqlNnBmkeqP-XBro9aROfcFgqXe7oxDrDw0Vw2jbSZTBDgbTf-FNLlAo9rW0smPDVr_5nkpwoRjwya5MiOOxRH52g98ThF2SN_1Dy-D8JThHPtx6Qvz-mF2fb7Z5X1VAPs6CHRrCN9lM0Xl1XzBWM_Rsxh9s4Sf2J1TiLbBgDh7GNFV3zCRodHuGrfOSyEYuImI05silBEGBwLgt8HWH8Z_fGVD6E2clFE8vtgkEf9DRT_ocCV51gTT6kaoCtnkn1i3jb1sfAoafDbM_Pkk8uhuN-xJc7nYJUnWcwSY6yr5wfQQ8_RdKSp2yDVEKjZyNXieW05EsnpdMq4s","UiLocales":null,"Nonce":"637066882700928863.ZjE0ODRmN2MtZjZjNi00MWZmLWEyOGMtOTU3MzRmZGVjZmY2MWRlZTAxNmUtZmFkNy00YmI0LWE4NGEtODVkOTJkYmM2Y2Q0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"4ec8c2dbaaf53fa74c7f3363617e6a54","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637066882700928863.ZjE0ODRmN2MtZjZjNi00MWZmLWEyOGMtOTU3MzRmZGVjZmY2MWRlZTAxNmUtZmFkNy00YmI0LWE4NGEtODVkOTJkYmM2Y2Q0","state":"CfDJ8HEYsJy9qqlNnBmkeqP-XBro9aROfcFgqXe7oxDrDw0Vw2jbSZTBDgbTf-FNLlAo9rW0smPDVr_5nkpwoRjwya5MiOOxRH52g98ThF2SN_1Dy-D8JThHPtx6Qvz-mF2fb7Z5X1VAPs6CHRrCN9lM0Xl1XzBWM_Rsxh9s4Sf2J1TiLbBgDh7GNFV3zCRodHuGrfOSyEYuImI05silBEGBwLgt8HWH8Z_fGVD6E2clFE8vtgkEf9DRT_ocCV51gTT6kaoCtnkn1i3jb1sfAoafDbM_Pkk8uhuN-xJc7nYJUnWcwSY6yr5wfQQ8_RdKSp2yDVEKjZyNXieW05EsnpdMq4s","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-10-14 18:18:00.774 -04:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-10-14 18:18:00.783 -04:00 [DBG] Scopes contains offline_access, consent is required
2019-10-14 18:18:00.783 -04:00 [INF] Showing consent: User has not yet consented
2019-10-14 18:18:00.831 -04:00 [DBG] Start authorize request protocol validation
2019-10-14 18:18:00.833 -04:00 [DBG] Checking for PKCE parameters
2019-10-14 18:18:00.834 -04:00 [DBG] No PKCE used.
2019-10-14 18:18:00.849 -04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-10-14 18:18:04.067 -04:00 [DBG] Start authorize request protocol validation
2019-10-14 18:18:04.069 -04:00 [DBG] Checking for PKCE parameters
2019-10-14 18:18:04.069 -04:00 [DBG] No PKCE used.
2019-10-14 18:18:04.081 -04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-10-14 18:18:04.110 -04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-10-14 18:18:04.111 -04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-10-14 18:18:04.111 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-10-14 18:18:04.111 -04:00 [DBG] Start authorize callback request
2019-10-14 18:18:04.115 -04:00 [DBG] User in authorize request: 2
2019-10-14 18:18:04.115 -04:00 [DBG] Start authorize request protocol validation
2019-10-14 18:18:04.117 -04:00 [DBG] Checking for PKCE parameters
2019-10-14 18:18:04.117 -04:00 [DBG] No PKCE used.
2019-10-14 18:18:04.130 -04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-10-14 18:18:04.130 -04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8HEYsJy9qqlNnBmkeqP-XBro9aROfcFgqXe7oxDrDw0Vw2jbSZTBDgbTf-FNLlAo9rW0smPDVr_5nkpwoRjwya5MiOOxRH52g98ThF2SN_1Dy-D8JThHPtx6Qvz-mF2fb7Z5X1VAPs6CHRrCN9lM0Xl1XzBWM_Rsxh9s4Sf2J1TiLbBgDh7GNFV3zCRodHuGrfOSyEYuImI05silBEGBwLgt8HWH8Z_fGVD6E2clFE8vtgkEf9DRT_ocCV51gTT6kaoCtnkn1i3jb1sfAoafDbM_Pkk8uhuN-xJc7nYJUnWcwSY6yr5wfQQ8_RdKSp2yDVEKjZyNXieW05EsnpdMq4s","UiLocales":null,"Nonce":"637066882700928863.ZjE0ODRmN2MtZjZjNi00MWZmLWEyOGMtOTU3MzRmZGVjZmY2MWRlZTAxNmUtZmFkNy00YmI0LWE4NGEtODVkOTJkYmM2Y2Q0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"4ec8c2dbaaf53fa74c7f3363617e6a54","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637066882700928863.ZjE0ODRmN2MtZjZjNi00MWZmLWEyOGMtOTU3MzRmZGVjZmY2MWRlZTAxNmUtZmFkNy00YmI0LWE4NGEtODVkOTJkYmM2Y2Q0","state":"CfDJ8HEYsJy9qqlNnBmkeqP-XBro9aROfcFgqXe7oxDrDw0Vw2jbSZTBDgbTf-FNLlAo9rW0smPDVr_5nkpwoRjwya5MiOOxRH52g98ThF2SN_1Dy-D8JThHPtx6Qvz-mF2fb7Z5X1VAPs6CHRrCN9lM0Xl1XzBWM_Rsxh9s4Sf2J1TiLbBgDh7GNFV3zCRodHuGrfOSyEYuImI05silBEGBwLgt8HWH8Z_fGVD6E2clFE8vtgkEf9DRT_ocCV51gTT6kaoCtnkn1i3jb1sfAoafDbM_Pkk8uhuN-xJc7nYJUnWcwSY6yr5wfQQ8_RdKSp2yDVEKjZyNXieW05EsnpdMq4s","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-10-14 18:18:04.130 -04:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-10-14 18:18:04.130 -04:00 [DBG] Scopes contains offline_access, consent is required
2019-10-14 18:18:04.135 -04:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2019-10-14 18:18:04.137 -04:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2019-10-14 18:18:04.140 -04:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 2
2019-10-14 18:18:04.247 -04:00 [DBG] Creating Hybrid Flow response.
2019-10-14 18:18:04.269 -04:00 [DBG] Creating Implicit Flow response.
2019-10-14 18:18:04.279 -04:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2019-10-14 18:18:04.282 -04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-10-14 18:18:04.348 -04:00 [INF] Authorize endpoint response
{"SubjectId":"2","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEYsJy9qqlNnBmkeqP-XBro9aROfcFgqXe7oxDrDw0Vw2jbSZTBDgbTf-FNLlAo9rW0smPDVr_5nkpwoRjwya5MiOOxRH52g98ThF2SN_1Dy-D8JThHPtx6Qvz-mF2fb7Z5X1VAPs6CHRrCN9lM0Xl1XzBWM_Rsxh9s4Sf2J1TiLbBgDh7GNFV3zCRodHuGrfOSyEYuImI05silBEGBwLgt8HWH8Z_fGVD6E2clFE8vtgkEf9DRT_ocCV51gTT6kaoCtnkn1i3jb1sfAoafDbM_Pkk8uhuN-xJc7nYJUnWcwSY6yr5wfQQ8_RdKSp2yDVEKjZyNXieW05EsnpdMq4s","Scope":"openid profile api1 offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-10-14 18:18:04.364 -04:00 [DBG] Augmenting SignInContext
2019-10-14 18:18:04.364 -04:00 [INF] AuthenticationScheme: idsrv signed in.
2019-10-14 18:18:04.555 -04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-10-14 18:18:04.560 -04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-10-14 18:18:04.560 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-10-14 18:18:04.567 -04:00 [DBG] Start token request.
2019-10-14 18:18:04.572 -04:00 [DBG] Start client validation
2019-10-14 18:18:04.577 -04:00 [DBG] Start parsing Basic Authentication secret
2019-10-14 18:18:04.581 -04:00 [DBG] Start parsing for secret in post body
2019-10-14 18:18:04.581 -04:00 [DBG] Parser found secret: PostBodySecretParser
2019-10-14 18:18:04.581 -04:00 [DBG] Secret id found: mvc
2019-10-14 18:18:04.592 -04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-10-14 18:18:04.592 -04:00 [DBG] Client validation success
2019-10-14 18:18:04.597 -04:00 [DBG] Start token request validation
2019-10-14 18:18:04.606 -04:00 [DBG] Start validation of authorization code token request
2019-10-14 18:18:04.640 -04:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-10-14 18:18:04.641 -04:00 [DBG] Validation of authorization code token request success
2019-10-14 18:18:04.643 -04:00 [INF] Token request validation success
{"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"d3cac23e6e074f51c6022eddada203dd1fcf6f58c7ba5002f7dca81a3ec6d52c","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"d3cac23e6e074f51c6022eddada203dd1fcf6f58c7ba5002f7dca81a3ec6d52c","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-10-14 18:18:04.672 -04:00 [DBG] Getting claims for access token for client: mvc
2019-10-14 18:18:04.673 -04:00 [DBG] Getting claims for access token for subject: 2
2019-10-14 18:18:04.675 -04:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types [] via ClaimsProviderAccessToken
2019-10-14 18:18:04.676 -04:00 [DBG] Issued claims: []
2019-10-14 18:18:04.683 -04:00 [DBG] Creating refresh token
2019-10-14 18:18:04.683 -04:00 [DBG] Setting an absolute lifetime: 2592000
2019-10-14 18:18:04.702 -04:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2019-10-14 18:18:04.702 -04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-10-14 18:18:04.709 -04:00 [DBG] Token request success.
2019-10-14 18:18:04.724 -04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-10-14 18:18:04.725 -04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-10-14 18:18:04.725 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-10-14 18:18:04.732 -04:00 [DBG] Start userinfo request
2019-10-14 18:18:04.735 -04:00 [DBG] Bearer token found in header
2019-10-14 18:18:04.792 -04:00 [DBG] IsActive called from: AccessTokenValidation
2019-10-14 18:18:04.793 -04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-10-14 18:18:04.794 -04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1571091484,"exp":1571095084,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvc","sub":"2","auth_time":1571091480,"idp":"local","scope":["openid","profile","api1","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-10-14 18:18:04.795 -04:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-10-14 18:18:04.800 -04:00 [DBG] Creating userinfo response
2019-10-14 18:18:04.803 -04:00 [DBG] Scopes in access token: openid profile api1 offline_access
2019-10-14 18:18:04.806 -04:00 [DBG] Scopes in access token: openid profile api1 offline_access
2019-10-14 18:18:04.810 -04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-10-14 18:18:04.810 -04:00 [DBG] Scopes in access token: openid profile api1 offline_access
2019-10-14 18:18:04.812 -04:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2019-10-14 18:18:04.813 -04:00 [DBG] Issued claims: ["name","website"]
2019-10-14 18:18:04.813 -04:00 [INF] Profile service returned the following claim types: name website
2019-10-14 18:18:04.813 -04:00 [DBG] End userinfo request
2019-10-14 18:18:14.390 -04:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-10-14 18:18:14.391 -04:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-10-14 18:18:14.392 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-10-14 18:18:14.396 -04:00 [DBG] Processing signout request for 2
2019-10-14 18:18:14.401 -04:00 [DBG] Start end session request validation
2019-10-14 18:18:14.407 -04:00 [DBG] Start identity token validation
2019-10-14 18:18:14.410 -04:00 [DBG] Client found: mvc / MVC Client
2019-10-14 18:18:14.413 -04:00 [DBG] IsActive called from: IdentityTokenValidation
2019-10-14 18:18:14.413 -04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-10-14 18:18:14.413 -04:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1571091484,"exp":1571091784,"iss":"http://localhost:5000","aud":"mvc","nonce":"637066882700928863.ZjE0ODRmN2MtZjZjNi00MWZmLWEyOGMtOTU3MzRmZGVjZmY2MWRlZTAxNmUtZmFkNy00YmI0LWE4NGEtODVkOTJkYmM2Y2Q0","iat":1571091484,"at_hash":"MJr_Vf7fSTz_LvJLhiiK2w","sid":"4ec8c2dbaaf53fa74c7f3363617e6a54","sub":"2","auth_time":1571091480,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-10-14 18:18:14.416 -04:00 [INF] End session request validation failure: Invalid post logout URI
{"ClientId":"mvc","ClientName":"MVC Client","SubjectId":"2","PostLogOutUri":null,"State":null,"Raw":{"post_logout_redirect_uri":"http://localhost:5002/signout-callback-oidc","id_token_hint":"eyJhbGciOiJSUzI1NiIsImtpZCI6IjRlMTNiY2NjNWEyOTExNzY3NTRiZDRhZjE3ZWRkYWNkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1NzEwOTE0ODQsImV4cCI6MTU3MTA5MTc4NCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzcwNjY4ODI3MDA5Mjg4NjMuWmpFME9EUm1OMk10Wmpaak5pMDBNV1ptTFdFeU9HTXRPVFUzTXpSbVpHVmpabVkyTVdSbFpUQXhObVV0Wm1Ga055MDBZbUkwTFdFNE5HRXRPRFZrT1RKa1ltTTJZMlEwIiwiaWF0IjoxNTcxMDkxNDg0LCJhdF9oYXNoIjoiTUpyX1ZmN2ZTVHpfTHZKTGhpaUsydyIsInNpZCI6IjRlYzhjMmRiYWFmNTNmYTc0YzdmMzM2MzYxN2U2YTU0Iiwic3ViIjoiMiIsImF1dGhfdGltZSI6MTU3MTA5MTQ4MCwiaWRwIjoibG9jYWwiLCJhbXIiOlsicHdkIl19.YPgCNy-RPIs2mpZkOARR9XzZH3n1JkP8aefXHqyTZaquwiZVfXz7atsj5akMby_47x-XlF_t6rtydplP7AnivFL98bg1Tw0mzh_alUkIRCWAPV8Al2Hg0HQPKl2n_QrAhhMPXRZAgVgNCSjUhny-hpT0qdgTq51FCKUTAz1sTw1ahCXVOJ8Ca80BNfwob9qfEmg-EfHp8u1oftCY2OfcA_Lr_e2GGdlPsd9REpwsRXlR7ivV1xtj3GQRvmnR6B0mQaE1dRDRfdkqzpoUfV7w_EPBbkvGsmmz1UJwuFV1BRziCR4DzhKcPUcarPJFEnUnzYcZjrvNUFWDm1R-pQXBMA","state":"CfDJ8HEYsJy9qqlNnBmkeqP-XBrCqK5CFYPr5-SwoobcgRJSGhaA5G8HscfwsO2O6aMsB39lY5JkpPR03Mi-_NIpaWCNy-phasJZH8bFz2-yavHxN5ncixzdirb58cpYAOUteyKibKIdW3vlWhFN9Ab1NkR0zJgDJTprRnSgQDU8VI5C","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"EndSessionRequestValidationLog"}
2019-10-14 18:18:14.416 -04:00 [ERR] Error processing end session request Invalid request
2019-10-14 18:18:16.498 -04:00 [INF] AuthenticationScheme: idsrv signed out.
2019-10-14 18:18:16.588 -04:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-10-14 18:18:16.590 -04:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-10-14 18:18:16.590 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-10-14 18:18:16.595 -04:00 [DBG] Processing signout callback request
2019-10-14 18:18:16.615 -04:00 [DBG] No client front-channel logout URLs
2019-10-14 18:18:16.616 -04:00 [DBG] No client back-channel logout URLs
2019-10-14 18:18:16.616 -04:00 [INF] Successful signout callback.
2019-10-14 18:18:16.616 -04:00 [DBG] No client front-channel iframe urls
2019-10-14 18:18:16.616 -04:00 [DBG] No client back-channel iframe urls
2019-10-14 18:18:31.290 -04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-10-14 18:18:31.291 -04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-10-14 18:18:31.291 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-10-14 18:18:31.291 -04:00 [DBG] Start authorize request
2019-10-14 18:18:31.291 -04:00 [DBG] No user present in authorize request
2019-10-14 18:18:31.291 -04:00 [DBG] Start authorize request protocol validation
2019-10-14 18:18:31.295 -04:00 [DBG] Checking for PKCE parameters
2019-10-14 18:18:31.295 -04:00 [DBG] No PKCE used.
2019-10-14 18:18:31.314 -04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-10-14 18:18:31.314 -04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8HEYsJy9qqlNnBmkeqP-XBpQHtTGe7F-haoo3Uik-Q6VKrmPltpDIynzLdZ74REsPWeeevhz2AqU9dpgDkKM39M671PnhRxavqDRHj-hG54cbOYdwB1haYFyZ4DsA0TYXcwSvprN5SYAjRiC1gR_xMbGCzlYK1WHV6iWdQXw_P-PdGzL1Ry-qxT_Y1DZMK4SPK8pbBf8I7sAHc_PhtOkFkksP63E7TC8AvgMSHWlvdGuR892jzBBp0Bh4UJXOHA6hRI4AW57-xg0uPw__qRxv_6UUlgbO1kIERO6C-tJNbpjWbRDSJ6OAZasaVd8reV_fXBfnpptxixUWUhNpkH-xcQ","UiLocales":null,"Nonce":"637066883112637249.MDRmYzViMjQtMTdjOC00Yzg1LTk1NmEtODk5ZTUyYjA2M2NkNWZjYzdhOGQtYTgwNC00NzZlLTk2Y2ItY2M0NzYwZTM0NGNk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637066883112637249.MDRmYzViMjQtMTdjOC00Yzg1LTk1NmEtODk5ZTUyYjA2M2NkNWZjYzdhOGQtYTgwNC00NzZlLTk2Y2ItY2M0NzYwZTM0NGNk","state":"CfDJ8HEYsJy9qqlNnBmkeqP-XBpQHtTGe7F-haoo3Uik-Q6VKrmPltpDIynzLdZ74REsPWeeevhz2AqU9dpgDkKM39M671PnhRxavqDRHj-hG54cbOYdwB1haYFyZ4DsA0TYXcwSvprN5SYAjRiC1gR_xMbGCzlYK1WHV6iWdQXw_P-PdGzL1Ry-qxT_Y1DZMK4SPK8pbBf8I7sAHc_PhtOkFkksP63E7TC8AvgMSHWlvdGuR892jzBBp0Bh4UJXOHA6hRI4AW57-xg0uPw__qRxv_6UUlgbO1kIERO6C-tJNbpjWbRDSJ6OAZasaVd8reV_fXBfnpptxixUWUhNpkH-xcQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-10-14 18:18:31.314 -04:00 [INF] Showing login: User is not authenticated
2019-10-14 18:18:31.334 -04:00 [DBG] Start authorize request protocol validation
2019-10-14 18:18:31.336 -04:00 [DBG] Checking for PKCE parameters
2019-10-14 18:18:31.336 -04:00 [DBG] No PKCE used.
2019-10-14 18:18:31.349 -04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-10-14 18:18:33.665 -04:00 [INF] AuthenticationScheme: Google was challenged.
2019-10-14 18:19:09.985 -04:00 [INF] AuthenticationScheme: idsrv.external signed in.
2019-10-14 18:19:10.023 -04:00 [DBG] Augmenting SignInContext
2019-10-14 18:19:10.023 -04:00 [DBG] Adding amr claim with value: external
2019-10-14 18:19:10.023 -04:00 [INF] AuthenticationScheme: idsrv signed in.
2019-10-14 18:19:10.023 -04:00 [INF] AuthenticationScheme: idsrv.external signed out.
2019-10-14 18:19:10.023 -04:00 [DBG] Start authorize request protocol validation
2019-10-14 18:19:10.025 -04:00 [DBG] Checking for PKCE parameters
2019-10-14 18:19:10.026 -04:00 [DBG] No PKCE used.
2019-10-14 18:19:10.038 -04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-10-14 18:19:10.056 -04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-10-14 18:19:10.056 -04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-10-14 18:19:10.056 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-10-14 18:19:10.056 -04:00 [DBG] Start authorize callback request
2019-10-14 18:19:10.056 -04:00 [DBG] User in authorize request: 1a8c0c13ddf3ada39e8a0a28d7569601f023b44b186a553f3a7a57d49e375b2a
2019-10-14 18:19:10.056 -04:00 [DBG] Start authorize request protocol validation
2019-10-14 18:19:10.059 -04:00 [DBG] Checking for PKCE parameters
2019-10-14 18:19:10.059 -04:00 [DBG] No PKCE used.
2019-10-14 18:19:10.072 -04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-10-14 18:19:10.072 -04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1a8c0c13ddf3ada39e8a0a28d7569601f023b44b186a553f3a7a57d49e375b2a","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8HEYsJy9qqlNnBmkeqP-XBpQHtTGe7F-haoo3Uik-Q6VKrmPltpDIynzLdZ74REsPWeeevhz2AqU9dpgDkKM39M671PnhRxavqDRHj-hG54cbOYdwB1haYFyZ4DsA0TYXcwSvprN5SYAjRiC1gR_xMbGCzlYK1WHV6iWdQXw_P-PdGzL1Ry-qxT_Y1DZMK4SPK8pbBf8I7sAHc_PhtOkFkksP63E7TC8AvgMSHWlvdGuR892jzBBp0Bh4UJXOHA6hRI4AW57-xg0uPw__qRxv_6UUlgbO1kIERO6C-tJNbpjWbRDSJ6OAZasaVd8reV_fXBfnpptxixUWUhNpkH-xcQ","UiLocales":null,"Nonce":"637066883112637249.MDRmYzViMjQtMTdjOC00Yzg1LTk1NmEtODk5ZTUyYjA2M2NkNWZjYzdhOGQtYTgwNC00NzZlLTk2Y2ItY2M0NzYwZTM0NGNk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"c57b9f6081a071fbf176c3160ec9b98d","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637066883112637249.MDRmYzViMjQtMTdjOC00Yzg1LTk1NmEtODk5ZTUyYjA2M2NkNWZjYzdhOGQtYTgwNC00NzZlLTk2Y2ItY2M0NzYwZTM0NGNk","state":"CfDJ8HEYsJy9qqlNnBmkeqP-XBpQHtTGe7F-haoo3Uik-Q6VKrmPltpDIynzLdZ74REsPWeeevhz2AqU9dpgDkKM39M671PnhRxavqDRHj-hG54cbOYdwB1haYFyZ4DsA0TYXcwSvprN5SYAjRiC1gR_xMbGCzlYK1WHV6iWdQXw_P-PdGzL1Ry-qxT_Y1DZMK4SPK8pbBf8I7sAHc_PhtOkFkksP63E7TC8AvgMSHWlvdGuR892jzBBp0Bh4UJXOHA6hRI4AW57-xg0uPw__qRxv_6UUlgbO1kIERO6C-tJNbpjWbRDSJ6OAZasaVd8reV_fXBfnpptxixUWUhNpkH-xcQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-10-14 18:19:10.072 -04:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-10-14 18:19:10.072 -04:00 [DBG] Scopes contains offline_access, consent is required
2019-10-14 18:19:10.072 -04:00 [INF] Showing consent: User has not yet consented
2019-10-14 18:19:10.085 -04:00 [DBG] Start authorize request protocol validation
2019-10-14 18:19:10.087 -04:00 [DBG] Checking for PKCE parameters
2019-10-14 18:19:10.087 -04:00 [DBG] No PKCE used.
2019-10-14 18:19:10.101 -04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-10-14 18:19:12.301 -04:00 [DBG] Start authorize request protocol validation
2019-10-14 18:19:12.304 -04:00 [DBG] Checking for PKCE parameters
2019-10-14 18:19:12.304 -04:00 [DBG] No PKCE used.
2019-10-14 18:19:12.316 -04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-10-14 18:19:12.342 -04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-10-14 18:19:12.343 -04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-10-14 18:19:12.343 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-10-14 18:19:12.343 -04:00 [DBG] Start authorize callback request
2019-10-14 18:19:12.343 -04:00 [DBG] User in authorize request: 1a8c0c13ddf3ada39e8a0a28d7569601f023b44b186a553f3a7a57d49e375b2a
2019-10-14 18:19:12.343 -04:00 [DBG] Start authorize request protocol validation
2019-10-14 18:19:12.346 -04:00 [DBG] Checking for PKCE parameters
2019-10-14 18:19:12.346 -04:00 [DBG] No PKCE used.
2019-10-14 18:19:12.358 -04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-10-14 18:19:12.358 -04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"1a8c0c13ddf3ada39e8a0a28d7569601f023b44b186a553f3a7a57d49e375b2a","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8HEYsJy9qqlNnBmkeqP-XBpQHtTGe7F-haoo3Uik-Q6VKrmPltpDIynzLdZ74REsPWeeevhz2AqU9dpgDkKM39M671PnhRxavqDRHj-hG54cbOYdwB1haYFyZ4DsA0TYXcwSvprN5SYAjRiC1gR_xMbGCzlYK1WHV6iWdQXw_P-PdGzL1Ry-qxT_Y1DZMK4SPK8pbBf8I7sAHc_PhtOkFkksP63E7TC8AvgMSHWlvdGuR892jzBBp0Bh4UJXOHA6hRI4AW57-xg0uPw__qRxv_6UUlgbO1kIERO6C-tJNbpjWbRDSJ6OAZasaVd8reV_fXBfnpptxixUWUhNpkH-xcQ","UiLocales":null,"Nonce":"637066883112637249.MDRmYzViMjQtMTdjOC00Yzg1LTk1NmEtODk5ZTUyYjA2M2NkNWZjYzdhOGQtYTgwNC00NzZlLTk2Y2ItY2M0NzYwZTM0NGNk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"c57b9f6081a071fbf176c3160ec9b98d","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637066883112637249.MDRmYzViMjQtMTdjOC00Yzg1LTk1NmEtODk5ZTUyYjA2M2NkNWZjYzdhOGQtYTgwNC00NzZlLTk2Y2ItY2M0NzYwZTM0NGNk","state":"CfDJ8HEYsJy9qqlNnBmkeqP-XBpQHtTGe7F-haoo3Uik-Q6VKrmPltpDIynzLdZ74REsPWeeevhz2AqU9dpgDkKM39M671PnhRxavqDRHj-hG54cbOYdwB1haYFyZ4DsA0TYXcwSvprN5SYAjRiC1gR_xMbGCzlYK1WHV6iWdQXw_P-PdGzL1Ry-qxT_Y1DZMK4SPK8pbBf8I7sAHc_PhtOkFkksP63E7TC8AvgMSHWlvdGuR892jzBBp0Bh4UJXOHA6hRI4AW57-xg0uPw__qRxv_6UUlgbO1kIERO6C-tJNbpjWbRDSJ6OAZasaVd8reV_fXBfnpptxixUWUhNpkH-xcQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-10-14 18:19:12.358 -04:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-10-14 18:19:12.358 -04:00 [DBG] Scopes contains offline_access, consent is required
2019-10-14 18:19:12.358 -04:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2019-10-14 18:19:12.358 -04:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2019-10-14 18:19:12.359 -04:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 1a8c0c13ddf3ada39e8a0a28d7569601f023b44b186a553f3a7a57d49e375b2a
2019-10-14 18:19:12.360 -04:00 [DBG] Creating Hybrid Flow response.
2019-10-14 18:19:12.361 -04:00 [DBG] Creating Implicit Flow response.
2019-10-14 18:19:12.361 -04:00 [DBG] Getting claims for identity token for subject: 1a8c0c13ddf3ada39e8a0a28d7569601f023b44b186a553f3a7a57d49e375b2a and client: mvc
2019-10-14 18:19:12.361 -04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-10-14 18:19:12.365 -04:00 [INF] Authorize endpoint response
{"SubjectId":"1a8c0c13ddf3ada39e8a0a28d7569601f023b44b186a553f3a7a57d49e375b2a","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEYsJy9qqlNnBmkeqP-XBpQHtTGe7F-haoo3Uik-Q6VKrmPltpDIynzLdZ74REsPWeeevhz2AqU9dpgDkKM39M671PnhRxavqDRHj-hG54cbOYdwB1haYFyZ4DsA0TYXcwSvprN5SYAjRiC1gR_xMbGCzlYK1WHV6iWdQXw_P-PdGzL1Ry-qxT_Y1DZMK4SPK8pbBf8I7sAHc_PhtOkFkksP63E7TC8AvgMSHWlvdGuR892jzBBp0Bh4UJXOHA6hRI4AW57-xg0uPw__qRxv_6UUlgbO1kIERO6C-tJNbpjWbRDSJ6OAZasaVd8reV_fXBfnpptxixUWUhNpkH-xcQ","Scope":"openid profile api1 offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-10-14 18:19:12.366 -04:00 [DBG] Augmenting SignInContext
2019-10-14 18:19:12.366 -04:00 [INF] AuthenticationScheme: idsrv signed in.
2019-10-14 18:19:12.729 -04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-10-14 18:19:12.731 -04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-10-14 18:19:12.731 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-10-14 18:19:12.731 -04:00 [DBG] Start token request.
2019-10-14 18:19:12.731 -04:00 [DBG] Start client validation
2019-10-14 18:19:12.731 -04:00 [DBG] Start parsing Basic Authentication secret
2019-10-14 18:19:12.731 -04:00 [DBG] Start parsing for secret in post body
2019-10-14 18:19:12.732 -04:00 [DBG] Parser found secret: PostBodySecretParser
2019-10-14 18:19:12.732 -04:00 [DBG] Secret id found: mvc
2019-10-14 18:19:12.736 -04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-10-14 18:19:12.736 -04:00 [DBG] Client validation success
2019-10-14 18:19:12.736 -04:00 [DBG] Start token request validation
2019-10-14 18:19:12.736 -04:00 [DBG] Start validation of authorization code token request
2019-10-14 18:19:12.740 -04:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-10-14 18:19:12.740 -04:00 [DBG] Validation of authorization code token request success
2019-10-14 18:19:12.741 -04:00 [INF] Token request validation success
{"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"0506ad140c9f703b9483f6d21f8741cc4c82d8eaef7bba0faedda35430640fde","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"0506ad140c9f703b9483f6d21f8741cc4c82d8eaef7bba0faedda35430640fde","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-10-14 18:19:12.751 -04:00 [DBG] Getting claims for access token for client: mvc
2019-10-14 18:19:12.751 -04:00 [DBG] Getting claims for access token for subject: 1a8c0c13ddf3ada39e8a0a28d7569601f023b44b186a553f3a7a57d49e375b2a
2019-10-14 18:19:12.751 -04:00 [DBG] Get profile called for subject 1a8c0c13ddf3ada39e8a0a28d7569601f023b44b186a553f3a7a57d49e375b2a from client MVC Client with claim types [] via ClaimsProviderAccessToken
2019-10-14 18:19:12.751 -04:00 [DBG] Issued claims: []
2019-10-14 18:19:12.756 -04:00 [DBG] Creating refresh token
2019-10-14 18:19:12.756 -04:00 [DBG] Setting an absolute lifetime: 2592000
2019-10-14 18:19:12.764 -04:00 [DBG] Getting claims for identity token for subject: 1a8c0c13ddf3ada39e8a0a28d7569601f023b44b186a553f3a7a57d49e375b2a and client: mvc
2019-10-14 18:19:12.764 -04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-10-14 18:19:12.769 -04:00 [DBG] Token request success.
2019-10-14 18:19:12.774 -04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-10-14 18:19:12.774 -04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-10-14 18:19:12.775 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-10-14 18:19:12.775 -04:00 [DBG] Start userinfo request
2019-10-14 18:19:12.775 -04:00 [DBG] Bearer token found in header
2019-10-14 18:19:12.782 -04:00 [DBG] IsActive called from: AccessTokenValidation
2019-10-14 18:19:12.782 -04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-10-14 18:19:12.782 -04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1571091552,"exp":1571095152,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvc","sub":"1a8c0c13ddf3ada39e8a0a28d7569601f023b44b186a553f3a7a57d49e375b2a","auth_time":1571091550,"idp":"Google","scope":["openid","profile","api1","offline_access"],"amr":"external"},"$type":"TokenValidationLog"}
2019-10-14 18:19:12.782 -04:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-10-14 18:19:12.782 -04:00 [DBG] Creating userinfo response
2019-10-14 18:19:12.782 -04:00 [DBG] Scopes in access token: openid profile api1 offline_access
2019-10-14 18:19:12.782 -04:00 [DBG] Scopes in access token: openid profile api1 offline_access
2019-10-14 18:19:12.785 -04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-10-14 18:19:12.785 -04:00 [DBG] Scopes in access token: openid profile api1 offline_access
2019-10-14 18:19:12.788 -04:00 [DBG] Get profile called for subject 1a8c0c13ddf3ada39e8a0a28d7569601f023b44b186a553f3a7a57d49e375b2a from client MVC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2019-10-14 18:19:12.788 -04:00 [DBG] Issued claims: ["name","given_name","family_name"]
2019-10-14 18:19:12.788 -04:00 [INF] Profile service returned the following claim types: name given_name family_name
2019-10-14 18:19:12.788 -04:00 [DBG] End userinfo request
2019-10-14 18:19:19.091 -04:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-10-14 18:19:19.092 -04:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-10-14 18:19:19.092 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-10-14 18:19:19.092 -04:00 [DBG] Processing signout request for 1a8c0c13ddf3ada39e8a0a28d7569601f023b44b186a553f3a7a57d49e375b2a
2019-10-14 18:19:19.092 -04:00 [DBG] Start end session request validation
2019-10-14 18:19:19.092 -04:00 [DBG] Start identity token validation
2019-10-14 18:19:19.095 -04:00 [DBG] Client found: mvc / MVC Client
2019-10-14 18:19:19.098 -04:00 [DBG] IsActive called from: IdentityTokenValidation
2019-10-14 18:19:19.098 -04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-10-14 18:19:19.098 -04:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1571091552,"exp":1571091852,"iss":"http://localhost:5000","aud":"mvc","nonce":"637066883112637249.MDRmYzViMjQtMTdjOC00Yzg1LTk1NmEtODk5ZTUyYjA2M2NkNWZjYzdhOGQtYTgwNC00NzZlLTk2Y2ItY2M0NzYwZTM0NGNk","iat":1571091552,"at_hash":"nilskgk3A1Au0j5BsM--Sg","sid":"c57b9f6081a071fbf176c3160ec9b98d","sub":"1a8c0c13ddf3ada39e8a0a28d7569601f023b44b186a553f3a7a57d49e375b2a","auth_time":1571091550,"idp":"Google","amr":"external"},"$type":"TokenValidationLog"}
2019-10-14 18:19:19.098 -04:00 [INF] End session request validation failure: Invalid post logout URI
{"ClientId":"mvc","ClientName":"MVC Client","SubjectId":"1a8c0c13ddf3ada39e8a0a28d7569601f023b44b186a553f3a7a57d49e375b2a","PostLogOutUri":null,"State":null,"Raw":{"post_logout_redirect_uri":"http://localhost:5002/signout-callback-oidc","id_token_hint":"eyJhbGciOiJSUzI1NiIsImtpZCI6IjRlMTNiY2NjNWEyOTExNzY3NTRiZDRhZjE3ZWRkYWNkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1NzEwOTE1NTIsImV4cCI6MTU3MTA5MTg1MiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzcwNjY4ODMxMTI2MzcyNDkuTURSbVl6VmlNalF0TVRkak9DMDBZemcxTFRrMU5tRXRPRGs1WlRVeVlqQTJNMk5rTldaall6ZGhPR1F0WVRnd05DMDBOelpsTFRrMlkySXRZMk0wTnpZd1pUTTBOR05rIiwiaWF0IjoxNTcxMDkxNTUyLCJhdF9oYXNoIjoibmlsc2tnazNBMUF1MGo1QnNNLS1TZyIsInNpZCI6ImM1N2I5ZjYwODFhMDcxZmJmMTc2YzMxNjBlYzliOThkIiwic3ViIjoiMWE4YzBjMTNkZGYzYWRhMzllOGEwYTI4ZDc1Njk2MDFmMDIzYjQ0YjE4NmE1NTNmM2E3YTU3ZDQ5ZTM3NWIyYSIsImF1dGhfdGltZSI6MTU3MTA5MTU1MCwiaWRwIjoiR29vZ2xlIiwiYW1yIjpbImV4dGVybmFsIl19.x_xjMSRNTZNXkJDsHXNBBur_SsiAWNzmWKtlWt_WUKudE08SYumB-VfB4CggDgu7YTpPBQ6NuKAUMJZhqP1YhJfJX-l3B6PUXfLbmnf2gM8mY9aBJVjeMCeT1xz_-h1ufP-2om7_jio7r57A4gQUX3Yh2yAX7sfBgb0_tyKM5kC1gIvDaKbkJunV8xikaNqhBq7xvXl3OR2nRDogGLJdAZb1gs4Vlr40k4D99FmCT_2IgyvgmAn5hoGrI195G-1NTPr-F-3wssvHqf1zIWYF1WXYm4bTpLuUlWHJuH_N104yK-xw7zUQg8jUi-JwNlevmgFxworpcro8EQnzIPYzMg","state":"CfDJ8HEYsJy9qqlNnBmkeqP-XBogNoCZMUqodS6lhxbpFlu6H4V-jhbOEjMTelrZRNRjsxLG-SORtXUesp27JIdkIG6uQI7wbZQ_OFtRTY2HWJg9oZW99jndiTWGzFHcpKQoK7t6zl2fhChsquQlNwmsZ73cdFx38mFScc_qvkjUm19T","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"EndSessionRequestValidationLog"}
2019-10-14 18:19:19.098 -04:00 [ERR] Error processing end session request Invalid request
2019-10-14 18:19:20.454 -04:00 [INF] AuthenticationScheme: idsrv signed out.
2019-10-14 18:19:20.510 -04:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-10-14 18:19:20.511 -04:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-10-14 18:19:20.511 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-10-14 18:19:20.511 -04:00 [DBG] Processing signout callback request
2019-10-14 18:19:20.514 -04:00 [DBG] No client front-channel logout URLs
2019-10-14 18:19:20.514 -04:00 [DBG] No client back-channel logout URLs
2019-10-14 18:19:20.514 -04:00 [INF] Successful signout callback.
2019-10-14 18:19:20.514 -04:00 [DBG] No client front-channel iframe urls
2019-10-14 18:19:20.514 -04:00 [DBG] No client back-channel iframe urls
2019-10-14 18:19:24.525 -04:00 [INF] AuthenticationScheme: idsrv was challenged.
2019-10-14 18:22:58.771 -04:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-10-14 18:22:59.355 -04:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-10-14 18:22:59.355 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-10-14 18:22:59.355 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-10-14 18:22:59.356 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-10-14 18:22:59.356 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-10-14 18:22:59.356 -04:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-10-14 18:23:00.186 -04:00 [DBG] Login Url: /Account/Login
2019-10-14 18:23:00.190 -04:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-10-14 18:23:00.190 -04:00 [DBG] Logout Url: /Account/Logout
2019-10-14 18:23:00.190 -04:00 [DBG] ConsentUrl Url: /consent
2019-10-14 18:23:00.190 -04:00 [DBG] Consent Return Url Parameter: returnUrl
2019-10-14 18:23:00.190 -04:00 [DBG] Error Url: /home/error
2019-10-14 18:23:00.190 -04:00 [DBG] Error Id Parameter: errorId
2019-10-14 18:23:02.264 -04:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-10-14 18:23:02.268 -04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-10-14 18:23:02.269 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-10-14 18:23:02.272 -04:00 [DBG] Start discovery request
2019-10-14 18:23:02.573 -04:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-10-14 18:23:02.573 -04:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-10-14 18:23:02.574 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-10-14 18:23:02.577 -04:00 [DBG] Start key discovery request
2019-10-14 18:23:02.645 -04:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-10-14 18:23:02.648 -04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-10-14 18:23:02.648 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-10-14 18:23:02.652 -04:00 [DBG] Start authorize request
2019-10-14 18:23:02.660 -04:00 [DBG] No user present in authorize request
2019-10-14 18:23:02.665 -04:00 [DBG] Start authorize request protocol validation
2019-10-14 18:23:02.762 -04:00 [DBG] Checking for PKCE parameters
2019-10-14 18:23:02.764 -04:00 [DBG] No PKCE used.
2019-10-14 18:23:02.862 -04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-10-14 18:23:02.877 -04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8HEYsJy9qqlNnBmkeqP-XBo8lv_vkN3R74kCUtJNTuT6bPZyabjsSq9hHSfYYZp3ourGbcibiux-ZciGkG93iTxqT-BPd-LwI7sSYDCck5i9ciCSsnfrItutIvFhKhtPKSuR0q43wrrXKojIL1d0vFKz5Q-0_ppJlFvELYfJv1XcPEX-sQ4U2ixvo3YTmzyvm0Ab7JW4aBj9HDbwW46Iqoq0NdKlOxmo1EN8-buh_4ZeaQG6khroWTaAo0dXx-5VndEVFXr8QkKn_PZbgc8okVmR9P3PuaK7jAw5Egk5sg3KAWOYmvM3ld8-ZkA5hFNxeOYDr-GX6C6vympE5d6SXvA","UiLocales":null,"Nonce":"637066885826125187.ZGM0ZTFmMzktMmNmYy00NDkzLWJlNDAtMGIxZjljNGVlNmM0OTVkZjQ2MmYtZTBhYi00ZmU0LWE0ZjktNTg1YWY1YmUwYzM4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637066885826125187.ZGM0ZTFmMzktMmNmYy00NDkzLWJlNDAtMGIxZjljNGVlNmM0OTVkZjQ2MmYtZTBhYi00ZmU0LWE0ZjktNTg1YWY1YmUwYzM4","state":"CfDJ8HEYsJy9qqlNnBmkeqP-XBo8lv_vkN3R74kCUtJNTuT6bPZyabjsSq9hHSfYYZp3ourGbcibiux-ZciGkG93iTxqT-BPd-LwI7sSYDCck5i9ciCSsnfrItutIvFhKhtPKSuR0q43wrrXKojIL1d0vFKz5Q-0_ppJlFvELYfJv1XcPEX-sQ4U2ixvo3YTmzyvm0Ab7JW4aBj9HDbwW46Iqoq0NdKlOxmo1EN8-buh_4ZeaQG6khroWTaAo0dXx-5VndEVFXr8QkKn_PZbgc8okVmR9P3PuaK7jAw5Egk5sg3KAWOYmvM3ld8-ZkA5hFNxeOYDr-GX6C6vympE5d6SXvA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-10-14 18:23:02.897 -04:00 [INF] Showing login: User is not authenticated
2019-10-14 18:23:02.971 -04:00 [DBG] Start authorize request protocol validation
2019-10-14 18:23:02.974 -04:00 [DBG] Checking for PKCE parameters
2019-10-14 18:23:02.974 -04:00 [DBG] No PKCE used.
2019-10-14 18:23:02.990 -04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-10-14 18:23:14.805 -04:00 [DBG] Start authorize request protocol validation
2019-10-14 18:23:14.807 -04:00 [DBG] Checking for PKCE parameters
2019-10-14 18:23:14.808 -04:00 [DBG] No PKCE used.
2019-10-14 18:23:14.822 -04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-10-14 18:23:14.826 -04:00 [DBG] Start authorize request protocol validation
2019-10-14 18:23:14.829 -04:00 [DBG] Checking for PKCE parameters
2019-10-14 18:23:14.829 -04:00 [DBG] No PKCE used.
2019-10-14 18:23:14.842 -04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-10-14 18:23:22.949 -04:00 [DBG] Start authorize request protocol validation
2019-10-14 18:23:22.953 -04:00 [DBG] Checking for PKCE parameters
2019-10-14 18:23:22.953 -04:00 [DBG] No PKCE used.
2019-10-14 18:23:22.965 -04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-10-14 18:23:22.965 -04:00 [DBG] Start authorize request protocol validation
2019-10-14 18:23:22.968 -04:00 [DBG] Checking for PKCE parameters
2019-10-14 18:23:22.969 -04:00 [DBG] No PKCE used.
2019-10-14 18:23:22.981 -04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-10-14 18:23:29.835 -04:00 [DBG] Start authorize request protocol validation
2019-10-14 18:23:29.839 -04:00 [DBG] Checking for PKCE parameters
2019-10-14 18:23:29.839 -04:00 [DBG] No PKCE used.
2019-10-14 18:23:29.854 -04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-10-14 18:23:29.870 -04:00 [DBG] Augmenting SignInContext
2019-10-14 18:23:29.872 -04:00 [DBG] Adding idp claim with value: local
2019-10-14 18:23:29.872 -04:00 [DBG] Adding amr claim with value: pwd
2019-10-14 18:23:29.887 -04:00 [INF] AuthenticationScheme: idsrv signed in.
2019-10-14 18:23:29.908 -04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-10-14 18:23:29.909 -04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-10-14 18:23:29.909 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-10-14 18:23:29.914 -04:00 [DBG] Start authorize callback request
2019-10-14 18:23:29.919 -04:00 [DBG] User in authorize request: 2
2019-10-14 18:23:29.920 -04:00 [DBG] Start authorize request protocol validation
2019-10-14 18:23:29.922 -04:00 [DBG] Checking for PKCE parameters
2019-10-14 18:23:29.922 -04:00 [DBG] No PKCE used.
2019-10-14 18:23:29.934 -04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-10-14 18:23:29.934 -04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8HEYsJy9qqlNnBmkeqP-XBo8lv_vkN3R74kCUtJNTuT6bPZyabjsSq9hHSfYYZp3ourGbcibiux-ZciGkG93iTxqT-BPd-LwI7sSYDCck5i9ciCSsnfrItutIvFhKhtPKSuR0q43wrrXKojIL1d0vFKz5Q-0_ppJlFvELYfJv1XcPEX-sQ4U2ixvo3YTmzyvm0Ab7JW4aBj9HDbwW46Iqoq0NdKlOxmo1EN8-buh_4ZeaQG6khroWTaAo0dXx-5VndEVFXr8QkKn_PZbgc8okVmR9P3PuaK7jAw5Egk5sg3KAWOYmvM3ld8-ZkA5hFNxeOYDr-GX6C6vympE5d6SXvA","UiLocales":null,"Nonce":"637066885826125187.ZGM0ZTFmMzktMmNmYy00NDkzLWJlNDAtMGIxZjljNGVlNmM0OTVkZjQ2MmYtZTBhYi00ZmU0LWE0ZjktNTg1YWY1YmUwYzM4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"da71afa7a51d99f67bd58fc100c67d55","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637066885826125187.ZGM0ZTFmMzktMmNmYy00NDkzLWJlNDAtMGIxZjljNGVlNmM0OTVkZjQ2MmYtZTBhYi00ZmU0LWE0ZjktNTg1YWY1YmUwYzM4","state":"CfDJ8HEYsJy9qqlNnBmkeqP-XBo8lv_vkN3R74kCUtJNTuT6bPZyabjsSq9hHSfYYZp3ourGbcibiux-ZciGkG93iTxqT-BPd-LwI7sSYDCck5i9ciCSsnfrItutIvFhKhtPKSuR0q43wrrXKojIL1d0vFKz5Q-0_ppJlFvELYfJv1XcPEX-sQ4U2ixvo3YTmzyvm0Ab7JW4aBj9HDbwW46Iqoq0NdKlOxmo1EN8-buh_4ZeaQG6khroWTaAo0dXx-5VndEVFXr8QkKn_PZbgc8okVmR9P3PuaK7jAw5Egk5sg3KAWOYmvM3ld8-ZkA5hFNxeOYDr-GX6C6vympE5d6SXvA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-10-14 18:23:29.936 -04:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-10-14 18:23:29.945 -04:00 [DBG] Scopes contains offline_access, consent is required
2019-10-14 18:23:29.945 -04:00 [INF] Showing consent: User has not yet consented
2019-10-14 18:23:29.976 -04:00 [DBG] Start authorize request protocol validation
2019-10-14 18:23:29.978 -04:00 [DBG] Checking for PKCE parameters
2019-10-14 18:23:29.978 -04:00 [DBG] No PKCE used.
2019-10-14 18:23:29.993 -04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-10-14 18:23:33.447 -04:00 [DBG] Start authorize request protocol validation
2019-10-14 18:23:33.449 -04:00 [DBG] Checking for PKCE parameters
2019-10-14 18:23:33.449 -04:00 [DBG] No PKCE used.
2019-10-14 18:23:33.462 -04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-10-14 18:23:33.496 -04:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-10-14 18:23:33.496 -04:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-10-14 18:23:33.497 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-10-14 18:23:33.497 -04:00 [DBG] Start authorize callback request
2019-10-14 18:23:33.503 -04:00 [DBG] User in authorize request: 2
2019-10-14 18:23:33.503 -04:00 [DBG] Start authorize request protocol validation
2019-10-14 18:23:33.506 -04:00 [DBG] Checking for PKCE parameters
2019-10-14 18:23:33.506 -04:00 [DBG] No PKCE used.
2019-10-14 18:23:33.520 -04:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-10-14 18:23:33.521 -04:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8HEYsJy9qqlNnBmkeqP-XBo8lv_vkN3R74kCUtJNTuT6bPZyabjsSq9hHSfYYZp3ourGbcibiux-ZciGkG93iTxqT-BPd-LwI7sSYDCck5i9ciCSsnfrItutIvFhKhtPKSuR0q43wrrXKojIL1d0vFKz5Q-0_ppJlFvELYfJv1XcPEX-sQ4U2ixvo3YTmzyvm0Ab7JW4aBj9HDbwW46Iqoq0NdKlOxmo1EN8-buh_4ZeaQG6khroWTaAo0dXx-5VndEVFXr8QkKn_PZbgc8okVmR9P3PuaK7jAw5Egk5sg3KAWOYmvM3ld8-ZkA5hFNxeOYDr-GX6C6vympE5d6SXvA","UiLocales":null,"Nonce":"637066885826125187.ZGM0ZTFmMzktMmNmYy00NDkzLWJlNDAtMGIxZjljNGVlNmM0OTVkZjQ2MmYtZTBhYi00ZmU0LWE0ZjktNTg1YWY1YmUwYzM4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"da71afa7a51d99f67bd58fc100c67d55","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637066885826125187.ZGM0ZTFmMzktMmNmYy00NDkzLWJlNDAtMGIxZjljNGVlNmM0OTVkZjQ2MmYtZTBhYi00ZmU0LWE0ZjktNTg1YWY1YmUwYzM4","state":"CfDJ8HEYsJy9qqlNnBmkeqP-XBo8lv_vkN3R74kCUtJNTuT6bPZyabjsSq9hHSfYYZp3ourGbcibiux-ZciGkG93iTxqT-BPd-LwI7sSYDCck5i9ciCSsnfrItutIvFhKhtPKSuR0q43wrrXKojIL1d0vFKz5Q-0_ppJlFvELYfJv1XcPEX-sQ4U2ixvo3YTmzyvm0Ab7JW4aBj9HDbwW46Iqoq0NdKlOxmo1EN8-buh_4ZeaQG6khroWTaAo0dXx-5VndEVFXr8QkKn_PZbgc8okVmR9P3PuaK7jAw5Egk5sg3KAWOYmvM3ld8-ZkA5hFNxeOYDr-GX6C6vympE5d6SXvA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-10-14 18:23:33.521 -04:00 [DBG] IsActive called from: AuthorizeEndpoint
2019-10-14 18:23:33.521 -04:00 [DBG] Scopes contains offline_access, consent is required
2019-10-14 18:23:33.527 -04:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2019-10-14 18:23:33.528 -04:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2019-10-14 18:23:33.532 -04:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 2
2019-10-14 18:23:33.624 -04:00 [DBG] Creating Hybrid Flow response.
2019-10-14 18:23:33.647 -04:00 [DBG] Creating Implicit Flow response.
2019-10-14 18:23:33.656 -04:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2019-10-14 18:23:33.658 -04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-10-14 18:23:33.719 -04:00 [INF] Authorize endpoint response
{"SubjectId":"2","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8HEYsJy9qqlNnBmkeqP-XBo8lv_vkN3R74kCUtJNTuT6bPZyabjsSq9hHSfYYZp3ourGbcibiux-ZciGkG93iTxqT-BPd-LwI7sSYDCck5i9ciCSsnfrItutIvFhKhtPKSuR0q43wrrXKojIL1d0vFKz5Q-0_ppJlFvELYfJv1XcPEX-sQ4U2ixvo3YTmzyvm0Ab7JW4aBj9HDbwW46Iqoq0NdKlOxmo1EN8-buh_4ZeaQG6khroWTaAo0dXx-5VndEVFXr8QkKn_PZbgc8okVmR9P3PuaK7jAw5Egk5sg3KAWOYmvM3ld8-ZkA5hFNxeOYDr-GX6C6vympE5d6SXvA","Scope":"openid profile api1 offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-10-14 18:23:33.740 -04:00 [DBG] Augmenting SignInContext
2019-10-14 18:23:33.740 -04:00 [INF] AuthenticationScheme: idsrv signed in.
2019-10-14 18:23:33.914 -04:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-10-14 18:23:33.920 -04:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-10-14 18:23:33.920 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-10-14 18:23:33.928 -04:00 [DBG] Start token request.
2019-10-14 18:23:33.934 -04:00 [DBG] Start client validation
2019-10-14 18:23:33.940 -04:00 [DBG] Start parsing Basic Authentication secret
2019-10-14 18:23:33.944 -04:00 [DBG] Start parsing for secret in post body
2019-10-14 18:23:33.944 -04:00 [DBG] Parser found secret: PostBodySecretParser
2019-10-14 18:23:33.944 -04:00 [DBG] Secret id found: mvc
2019-10-14 18:23:33.956 -04:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-10-14 18:23:33.956 -04:00 [DBG] Client validation success
2019-10-14 18:23:33.962 -04:00 [DBG] Start token request validation
2019-10-14 18:23:33.972 -04:00 [DBG] Start validation of authorization code token request
2019-10-14 18:23:34.005 -04:00 [DBG] IsActive called from: AuthorizationCodeValidation
2019-10-14 18:23:34.005 -04:00 [DBG] Validation of authorization code token request success
2019-10-14 18:23:34.007 -04:00 [INF] Token request validation success
{"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"f0766d3c4bd83370e7eb52a60f22f1f65641fcaa241b9aeecc27357acea1dd3c","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"f0766d3c4bd83370e7eb52a60f22f1f65641fcaa241b9aeecc27357acea1dd3c","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-10-14 18:23:34.037 -04:00 [DBG] Getting claims for access token for client: mvc
2019-10-14 18:23:34.038 -04:00 [DBG] Getting claims for access token for subject: 2
2019-10-14 18:23:34.040 -04:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types [] via ClaimsProviderAccessToken
2019-10-14 18:23:34.040 -04:00 [DBG] Issued claims: []
2019-10-14 18:23:34.048 -04:00 [DBG] Creating refresh token
2019-10-14 18:23:34.048 -04:00 [DBG] Setting an absolute lifetime: 2592000
2019-10-14 18:23:34.067 -04:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2019-10-14 18:23:34.067 -04:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-10-14 18:23:34.073 -04:00 [DBG] Token request success.
2019-10-14 18:23:34.088 -04:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-10-14 18:23:34.089 -04:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-10-14 18:23:34.089 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-10-14 18:23:34.096 -04:00 [DBG] Start userinfo request
2019-10-14 18:23:34.099 -04:00 [DBG] Bearer token found in header
2019-10-14 18:23:34.130 -04:00 [DBG] IsActive called from: AccessTokenValidation
2019-10-14 18:23:34.130 -04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-10-14 18:23:34.132 -04:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1571091814,"exp":1571095414,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvc","sub":"2","auth_time":1571091809,"idp":"local","scope":["openid","profile","api1","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-10-14 18:23:34.133 -04:00 [DBG] IsActive called from: UserInfoRequestValidation
2019-10-14 18:23:34.139 -04:00 [DBG] Creating userinfo response
2019-10-14 18:23:34.146 -04:00 [DBG] Scopes in access token: openid profile api1 offline_access
2019-10-14 18:23:34.150 -04:00 [DBG] Scopes in access token: openid profile api1 offline_access
2019-10-14 18:23:34.156 -04:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-10-14 18:23:34.156 -04:00 [DBG] Scopes in access token: openid profile api1 offline_access
2019-10-14 18:23:34.158 -04:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2019-10-14 18:23:34.160 -04:00 [DBG] Issued claims: ["name","website"]
2019-10-14 18:23:34.160 -04:00 [INF] Profile service returned the following claim types: name website
2019-10-14 18:23:34.160 -04:00 [DBG] End userinfo request
2019-10-14 18:23:40.760 -04:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-10-14 18:23:40.761 -04:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-10-14 18:23:40.761 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-10-14 18:23:40.765 -04:00 [DBG] Processing signout request for 2
2019-10-14 18:23:40.771 -04:00 [DBG] Start end session request validation
2019-10-14 18:23:40.777 -04:00 [DBG] Start identity token validation
2019-10-14 18:23:40.779 -04:00 [DBG] Client found: mvc / MVC Client
2019-10-14 18:23:40.782 -04:00 [DBG] IsActive called from: IdentityTokenValidation
2019-10-14 18:23:40.782 -04:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-10-14 18:23:40.783 -04:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1571091814,"exp":1571092114,"iss":"http://localhost:5000","aud":"mvc","nonce":"637066885826125187.ZGM0ZTFmMzktMmNmYy00NDkzLWJlNDAtMGIxZjljNGVlNmM0OTVkZjQ2MmYtZTBhYi00ZmU0LWE0ZjktNTg1YWY1YmUwYzM4","iat":1571091814,"at_hash":"9qLHAsbJPm7OpNstN1rMJQ","sid":"da71afa7a51d99f67bd58fc100c67d55","sub":"2","auth_time":1571091809,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-10-14 18:23:40.787 -04:00 [INF] End session request validation failure: Invalid post logout URI
{"ClientId":"mvc","ClientName":"MVC Client","SubjectId":"2","PostLogOutUri":null,"State":null,"Raw":{"post_logout_redirect_uri":"http://localhost:5002/signout-callback-oidc","id_token_hint":"eyJhbGciOiJSUzI1NiIsImtpZCI6IjRlMTNiY2NjNWEyOTExNzY3NTRiZDRhZjE3ZWRkYWNkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1NzEwOTE4MTQsImV4cCI6MTU3MTA5MjExNCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzcwNjY4ODU4MjYxMjUxODcuWkdNMFpURm1Nemt0TW1ObVl5MDBORGt6TFdKbE5EQXRNR0l4Wmpsak5HVmxObU0wT1RWa1pqUTJNbVl0WlRCaFlpMDBabVUwTFdFMFpqa3ROVGcxWVdZMVltVXdZek00IiwiaWF0IjoxNTcxMDkxODE0LCJhdF9oYXNoIjoiOXFMSEFzYkpQbTdPcE5zdE4xck1KUSIsInNpZCI6ImRhNzFhZmE3YTUxZDk5ZjY3YmQ1OGZjMTAwYzY3ZDU1Iiwic3ViIjoiMiIsImF1dGhfdGltZSI6MTU3MTA5MTgwOSwiaWRwIjoibG9jYWwiLCJhbXIiOlsicHdkIl19.XM-pPxVpvJ_WKzsGqKSUdEEkgRlGeoSeTJFD7SXf7VKF_DuWvl8UmDhmPEnEH0EsdXEvBgVjIRAwtv1vC1rFiwAXe15AbKikf_8Np2P7yQ8rF1oXXW2_R5BsvPSye8AUjQ2QI5jEl4WUlcbf7JGk6LqTzaxM1InJuln7eFRz_bom4TcXurBGWWDXs8ePUR3FnsV_zurIssyKOWPGz-CAvA9GCHA10meaB8ix45JCYB7cfgzqr3quM7sezXUI6BdEmXDFGGdv3u3nK4QwvmSVmEVfcs6Eppbg7b9SUQMMGL1VG1TlvH7frCCjX-eCXjwXUK6oqcXkRbydRTvMV8fy7A","state":"CfDJ8HEYsJy9qqlNnBmkeqP-XBrVmlIguvcmCS0WIhfZA2ZBkd22dxF-IPDems_XoFp872vbUbFZlxgVaFAEAR73rl2UW0HLIVKiCJU_4Cm5E89z2Sika4xJiFRyHZzwcwXJLIAj_qjXhJfS3iJs2z11-FQNvOERfUClACVVEBC1mUTe","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"EndSessionRequestValidationLog"}
2019-10-14 18:23:40.787 -04:00 [ERR] Error processing end session request Invalid request
2019-10-14 18:23:42.935 -04:00 [INF] AuthenticationScheme: idsrv signed out.
2019-10-14 18:23:43.015 -04:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-10-14 18:23:43.017 -04:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-10-14 18:23:43.017 -04:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-10-14 18:23:43.023 -04:00 [DBG] Processing signout callback request
2019-10-14 18:23:43.034 -04:00 [DBG] No client front-channel logout URLs
2019-10-14 18:23:43.035 -04:00 [DBG] No client back-channel logout URLs
2019-10-14 18:23:43.035 -04:00 [INF] Successful signout callback.
2019-10-14 18:23:43.035 -04:00 [DBG] No client front-channel iframe urls
2019-10-14 18:23:43.035 -04:00 [DBG] No client back-channel iframe urls
2020-05-02 09:18:47.774 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 09:18:48.337 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 09:18:48.337 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 09:18:48.337 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 09:18:48.337 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 09:18:48.337 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 09:18:48.337 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 09:19:22.715 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 09:19:23.075 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 09:19:23.075 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 09:19:23.075 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 09:19:23.075 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 09:19:23.075 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 09:19:23.075 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 09:19:23.785 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 09:19:23.787 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 09:19:23.787 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 09:19:23.787 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 09:19:23.787 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 09:19:23.787 +01:00 [DBG] Error Url: /home/error
2020-05-02 09:19:23.787 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 09:19:23.815 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 09:19:23.818 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 09:19:23.819 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 09:19:23.821 +01:00 [DBG] Start discovery request
2020-05-02 09:19:24.072 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 09:19:24.073 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 09:19:24.073 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 09:19:24.076 +01:00 [DBG] Start key discovery request
2020-05-02 09:19:24.286 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 09:19:24.291 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 09:19:24.291 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 09:19:24.296 +01:00 [DBG] Start token request.
2020-05-02 09:19:24.300 +01:00 [DBG] Start client validation
2020-05-02 09:19:24.304 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 09:19:24.306 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 09:19:24.318 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 09:19:24.318 +01:00 [DBG] Secret id found: ro.client
2020-05-02 09:19:24.393 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 09:19:24.393 +01:00 [DBG] Client validation success
2020-05-02 09:19:24.399 +01:00 [DBG] Start token request validation
2020-05-02 09:19:24.407 +01:00 [DBG] Start resource owner password token request validation
2020-05-02 09:19:24.488 +01:00 [DBG] IsActive called from: ResourceOwnerValidation
2020-05-02 09:19:24.489 +01:00 [DBG] Resource owner password token request validation success.
2020-05-02 09:19:24.497 +01:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"username":"alice","password":"***REDACTED***","scope":"api1","grant_type":"password","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-05-02 09:19:24.520 +01:00 [DBG] Getting claims for access token for client: ro.client
2020-05-02 09:19:24.520 +01:00 [DBG] Getting claims for access token for subject: 1
2020-05-02 09:19:24.524 +01:00 [DBG] Get profile called for subject 1 from client ro.client with claim types [] via ClaimsProviderAccessToken
2020-05-02 09:19:24.526 +01:00 [DBG] Issued claims: []
2020-05-02 09:19:24.581 +01:00 [DBG] Token request success.
2020-05-02 09:19:24.776 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 09:19:24.777 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 09:19:24.777 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 09:19:24.777 +01:00 [DBG] Start discovery request
2020-05-02 09:19:24.873 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 09:19:24.874 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 09:19:24.874 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 09:19:24.874 +01:00 [DBG] Start key discovery request
2020-05-02 09:19:50.487 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 09:19:50.487 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 09:19:50.487 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 09:19:50.487 +01:00 [DBG] Start discovery request
2020-05-02 09:19:50.570 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 09:19:50.570 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 09:19:50.570 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 09:19:50.570 +01:00 [DBG] Start key discovery request
2020-05-02 09:19:50.603 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-05-02 09:19:50.605 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-05-02 09:19:50.605 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-05-02 09:19:50.607 +01:00 [DBG] Start authorize request
2020-05-02 09:19:50.613 +01:00 [DBG] No user present in authorize request
2020-05-02 09:19:50.616 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 09:19:50.625 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 09:19:50.626 +01:00 [DBG] No PKCE used.
2020-05-02 09:19:50.653 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 09:19:50.655 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeK3E8Zt1lqRA1AGyZ1AOvaZ9BXgKeu4jAO3w3PZ9KyPnqo8T_5zDxymq5pN1XqbDfMzSlWcGasx7MloIkQI3FhpQRGXTf0fBEFXMmobvgzf-r7rDPIJTusKnLFEiqbRoMEyQSE1tyCpDv9ZvWqO2_zfuEron99nCsw0i4jU93WBpVaosVfNiAVwcxtiagzgYx8l35K3P9PBLI9142waMUl5Q6Js7WA4iIAYezsiCStWRYLX3tfFQG5GuFq_X4xl5b4PI6319U-yB6VD9w9cVee50_JQvsKCukKOvxT1Kb1SWs9DibZrMMzXI4wffc49TZo","UiLocales":null,"Nonce":"637240043905844994.OGUyOWM0MGQtOGUyZC00ZThiLTgwZDktMDlkNmQyOWY3YzgzOTUyNTJkYmUtYTgwNi00ZDRhLTkwMTYtOTU1Y2JjYTVlMDBj","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240043905844994.OGUyOWM0MGQtOGUyZC00ZThiLTgwZDktMDlkNmQyOWY3YzgzOTUyNTJkYmUtYTgwNi00ZDRhLTkwMTYtOTU1Y2JjYTVlMDBj","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeK3E8Zt1lqRA1AGyZ1AOvaZ9BXgKeu4jAO3w3PZ9KyPnqo8T_5zDxymq5pN1XqbDfMzSlWcGasx7MloIkQI3FhpQRGXTf0fBEFXMmobvgzf-r7rDPIJTusKnLFEiqbRoMEyQSE1tyCpDv9ZvWqO2_zfuEron99nCsw0i4jU93WBpVaosVfNiAVwcxtiagzgYx8l35K3P9PBLI9142waMUl5Q6Js7WA4iIAYezsiCStWRYLX3tfFQG5GuFq_X4xl5b4PI6319U-yB6VD9w9cVee50_JQvsKCukKOvxT1Kb1SWs9DibZrMMzXI4wffc49TZo","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 09:19:50.661 +01:00 [INF] Showing login: User is not authenticated
2020-05-02 09:19:50.703 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 09:19:50.705 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 09:19:50.706 +01:00 [DBG] No PKCE used.
2020-05-02 09:19:50.719 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 09:23:08.640 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 09:23:09.076 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 09:23:09.076 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 09:23:09.076 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 09:23:09.076 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 09:23:09.076 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 09:23:09.076 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 09:23:09.814 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 09:23:09.815 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 09:23:09.815 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 09:23:09.815 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 09:23:09.815 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 09:23:09.815 +01:00 [DBG] Error Url: /home/error
2020-05-02 09:23:09.815 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 09:23:09.844 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 09:23:09.847 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 09:23:09.847 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 09:23:09.850 +01:00 [DBG] Start discovery request
2020-05-02 09:23:10.119 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 09:23:10.120 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 09:23:10.120 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 09:23:10.122 +01:00 [DBG] Start key discovery request
2020-05-02 09:23:10.324 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 09:23:10.328 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 09:23:10.328 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 09:23:10.335 +01:00 [DBG] Start token request.
2020-05-02 09:23:10.340 +01:00 [DBG] Start client validation
2020-05-02 09:23:10.344 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 09:23:10.346 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 09:23:10.358 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 09:23:10.358 +01:00 [DBG] Secret id found: ro.client
2020-05-02 09:23:10.434 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 09:23:10.434 +01:00 [DBG] Client validation success
2020-05-02 09:23:10.441 +01:00 [DBG] Start token request validation
2020-05-02 09:23:10.449 +01:00 [DBG] Start resource owner password token request validation
2020-05-02 09:23:10.528 +01:00 [DBG] IsActive called from: ResourceOwnerValidation
2020-05-02 09:23:10.529 +01:00 [DBG] Resource owner password token request validation success.
2020-05-02 09:23:10.538 +01:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"username":"alice","password":"***REDACTED***","scope":"api1","grant_type":"password","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-05-02 09:23:10.561 +01:00 [DBG] Getting claims for access token for client: ro.client
2020-05-02 09:23:10.562 +01:00 [DBG] Getting claims for access token for subject: 1
2020-05-02 09:23:10.566 +01:00 [DBG] Get profile called for subject 1 from client ro.client with claim types [] via ClaimsProviderAccessToken
2020-05-02 09:23:10.568 +01:00 [DBG] Issued claims: []
2020-05-02 09:23:10.618 +01:00 [DBG] Token request success.
2020-05-02 09:23:10.791 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 09:23:10.791 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 09:23:10.791 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 09:23:10.791 +01:00 [DBG] Start discovery request
2020-05-02 09:23:10.888 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 09:23:10.889 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 09:23:10.889 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 09:23:10.889 +01:00 [DBG] Start key discovery request
2020-05-02 09:23:14.882 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 09:23:14.884 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 09:23:14.884 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 09:23:14.884 +01:00 [DBG] Start discovery request
2020-05-02 09:23:14.968 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 09:23:14.968 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 09:23:14.968 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 09:23:14.968 +01:00 [DBG] Start key discovery request
2020-05-02 09:23:15.005 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-05-02 09:23:15.006 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-05-02 09:23:15.007 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-05-02 09:23:15.009 +01:00 [DBG] Start authorize request
2020-05-02 09:23:15.014 +01:00 [DBG] No user present in authorize request
2020-05-02 09:23:15.017 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 09:23:15.026 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 09:23:15.027 +01:00 [DBG] No PKCE used.
2020-05-02 09:23:15.051 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 09:23:15.053 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeL9lKEL4BWIAFL8FMGWvitAyTWNB2bu6D-S7UgKFBriOAX8f1Xd6EKD3k87AP29HYZ4qVNZ6Odw--u81D9mjzyydUGcf7LQZGD3l-Z7z2MV6KW_pvl91p-9BXPoaXwlITUJxZEmBOJ_UuiWIP2mplz4IIo2D_UVYSLfGtUAQpTmp-HWY-Pvqg6FfWEsi0K46SdALuGlBlzzL_CLePWDOTeqt0XVlGO6kMc9rUTAahLcFk-o05cgvaQqdHGArpEUXk8XN2tf6Z5DquEXaJSXA-BeqBpO_QwexSoRFJGidl8M3b6ELCf7n3iD5LuRTQGX_no","UiLocales":null,"Nonce":"637240045949843518.YWM5OTZiZmMtYjc3Ny00NGU0LWFlN2EtYzhiZjE4NjQ2ZDFiOTVlNzQzYjMtZjI3MS00NTAxLTk1MmQtYjY0ODBjNjY1MmU2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240045949843518.YWM5OTZiZmMtYjc3Ny00NGU0LWFlN2EtYzhiZjE4NjQ2ZDFiOTVlNzQzYjMtZjI3MS00NTAxLTk1MmQtYjY0ODBjNjY1MmU2","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeL9lKEL4BWIAFL8FMGWvitAyTWNB2bu6D-S7UgKFBriOAX8f1Xd6EKD3k87AP29HYZ4qVNZ6Odw--u81D9mjzyydUGcf7LQZGD3l-Z7z2MV6KW_pvl91p-9BXPoaXwlITUJxZEmBOJ_UuiWIP2mplz4IIo2D_UVYSLfGtUAQpTmp-HWY-Pvqg6FfWEsi0K46SdALuGlBlzzL_CLePWDOTeqt0XVlGO6kMc9rUTAahLcFk-o05cgvaQqdHGArpEUXk8XN2tf6Z5DquEXaJSXA-BeqBpO_QwexSoRFJGidl8M3b6ELCf7n3iD5LuRTQGX_no","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 09:23:15.059 +01:00 [INF] Showing login: User is not authenticated
2020-05-02 09:23:15.100 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 09:23:15.103 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 09:23:15.103 +01:00 [DBG] No PKCE used.
2020-05-02 09:23:15.121 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 09:23:24.915 +01:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-05-02 09:23:24.935 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 09:23:24.938 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 09:23:24.938 +01:00 [DBG] No PKCE used.
2020-05-02 09:23:24.953 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 09:23:24.964 +01:00 [DBG] Augmenting SignInContext
2020-05-02 09:23:24.965 +01:00 [DBG] Adding idp claim with value: local
2020-05-02 09:23:24.966 +01:00 [DBG] Adding amr claim with value: pwd
2020-05-02 09:23:24.974 +01:00 [INF] AuthenticationScheme: idsrv signed in.
2020-05-02 09:23:24.984 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-05-02 09:23:24.984 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-05-02 09:23:24.984 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-05-02 09:23:24.988 +01:00 [DBG] Start authorize callback request
2020-05-02 09:23:24.990 +01:00 [DBG] User in authorize request: 2
2020-05-02 09:23:24.990 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 09:23:24.993 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 09:23:24.993 +01:00 [DBG] No PKCE used.
2020-05-02 09:23:25.006 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 09:23:25.006 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeL9lKEL4BWIAFL8FMGWvitAyTWNB2bu6D-S7UgKFBriOAX8f1Xd6EKD3k87AP29HYZ4qVNZ6Odw--u81D9mjzyydUGcf7LQZGD3l-Z7z2MV6KW_pvl91p-9BXPoaXwlITUJxZEmBOJ_UuiWIP2mplz4IIo2D_UVYSLfGtUAQpTmp-HWY-Pvqg6FfWEsi0K46SdALuGlBlzzL_CLePWDOTeqt0XVlGO6kMc9rUTAahLcFk-o05cgvaQqdHGArpEUXk8XN2tf6Z5DquEXaJSXA-BeqBpO_QwexSoRFJGidl8M3b6ELCf7n3iD5LuRTQGX_no","UiLocales":null,"Nonce":"637240045949843518.YWM5OTZiZmMtYjc3Ny00NGU0LWFlN2EtYzhiZjE4NjQ2ZDFiOTVlNzQzYjMtZjI3MS00NTAxLTk1MmQtYjY0ODBjNjY1MmU2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"07e93812b006de16ad442614336b959a","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240045949843518.YWM5OTZiZmMtYjc3Ny00NGU0LWFlN2EtYzhiZjE4NjQ2ZDFiOTVlNzQzYjMtZjI3MS00NTAxLTk1MmQtYjY0ODBjNjY1MmU2","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeL9lKEL4BWIAFL8FMGWvitAyTWNB2bu6D-S7UgKFBriOAX8f1Xd6EKD3k87AP29HYZ4qVNZ6Odw--u81D9mjzyydUGcf7LQZGD3l-Z7z2MV6KW_pvl91p-9BXPoaXwlITUJxZEmBOJ_UuiWIP2mplz4IIo2D_UVYSLfGtUAQpTmp-HWY-Pvqg6FfWEsi0K46SdALuGlBlzzL_CLePWDOTeqt0XVlGO6kMc9rUTAahLcFk-o05cgvaQqdHGArpEUXk8XN2tf6Z5DquEXaJSXA-BeqBpO_QwexSoRFJGidl8M3b6ELCf7n3iD5LuRTQGX_no","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 09:23:25.006 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2020-05-02 09:23:25.013 +01:00 [DBG] Scopes contains offline_access, consent is required
2020-05-02 09:23:25.013 +01:00 [INF] Showing consent: User has not yet consented
2020-05-02 09:23:25.029 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 09:23:25.032 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 09:23:25.032 +01:00 [DBG] No PKCE used.
2020-05-02 09:23:25.048 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 09:23:31.430 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-05-02 09:23:31.443 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 09:23:31.446 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 09:23:31.446 +01:00 [DBG] No PKCE used.
2020-05-02 09:23:31.460 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 09:23:31.476 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-05-02 09:23:31.477 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-05-02 09:23:31.477 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-05-02 09:23:31.477 +01:00 [DBG] Start authorize callback request
2020-05-02 09:23:31.480 +01:00 [DBG] User in authorize request: 2
2020-05-02 09:23:31.480 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 09:23:31.482 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 09:23:31.482 +01:00 [DBG] No PKCE used.
2020-05-02 09:23:31.498 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 09:23:31.498 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeL9lKEL4BWIAFL8FMGWvitAyTWNB2bu6D-S7UgKFBriOAX8f1Xd6EKD3k87AP29HYZ4qVNZ6Odw--u81D9mjzyydUGcf7LQZGD3l-Z7z2MV6KW_pvl91p-9BXPoaXwlITUJxZEmBOJ_UuiWIP2mplz4IIo2D_UVYSLfGtUAQpTmp-HWY-Pvqg6FfWEsi0K46SdALuGlBlzzL_CLePWDOTeqt0XVlGO6kMc9rUTAahLcFk-o05cgvaQqdHGArpEUXk8XN2tf6Z5DquEXaJSXA-BeqBpO_QwexSoRFJGidl8M3b6ELCf7n3iD5LuRTQGX_no","UiLocales":null,"Nonce":"637240045949843518.YWM5OTZiZmMtYjc3Ny00NGU0LWFlN2EtYzhiZjE4NjQ2ZDFiOTVlNzQzYjMtZjI3MS00NTAxLTk1MmQtYjY0ODBjNjY1MmU2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"07e93812b006de16ad442614336b959a","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240045949843518.YWM5OTZiZmMtYjc3Ny00NGU0LWFlN2EtYzhiZjE4NjQ2ZDFiOTVlNzQzYjMtZjI3MS00NTAxLTk1MmQtYjY0ODBjNjY1MmU2","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeL9lKEL4BWIAFL8FMGWvitAyTWNB2bu6D-S7UgKFBriOAX8f1Xd6EKD3k87AP29HYZ4qVNZ6Odw--u81D9mjzyydUGcf7LQZGD3l-Z7z2MV6KW_pvl91p-9BXPoaXwlITUJxZEmBOJ_UuiWIP2mplz4IIo2D_UVYSLfGtUAQpTmp-HWY-Pvqg6FfWEsi0K46SdALuGlBlzzL_CLePWDOTeqt0XVlGO6kMc9rUTAahLcFk-o05cgvaQqdHGArpEUXk8XN2tf6Z5DquEXaJSXA-BeqBpO_QwexSoRFJGidl8M3b6ELCf7n3iD5LuRTQGX_no","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 09:23:31.498 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2020-05-02 09:23:31.498 +01:00 [DBG] Scopes contains offline_access, consent is required
2020-05-02 09:23:31.502 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2020-05-02 09:23:31.502 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2020-05-02 09:23:31.505 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 2
2020-05-02 09:23:31.579 +01:00 [DBG] Creating Hybrid Flow response.
2020-05-02 09:23:31.597 +01:00 [DBG] Creating Implicit Flow response.
2020-05-02 09:23:31.603 +01:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2020-05-02 09:23:31.603 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2020-05-02 09:23:31.609 +01:00 [INF] Authorize endpoint response
{"SubjectId":"2","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeL9lKEL4BWIAFL8FMGWvitAyTWNB2bu6D-S7UgKFBriOAX8f1Xd6EKD3k87AP29HYZ4qVNZ6Odw--u81D9mjzyydUGcf7LQZGD3l-Z7z2MV6KW_pvl91p-9BXPoaXwlITUJxZEmBOJ_UuiWIP2mplz4IIo2D_UVYSLfGtUAQpTmp-HWY-Pvqg6FfWEsi0K46SdALuGlBlzzL_CLePWDOTeqt0XVlGO6kMc9rUTAahLcFk-o05cgvaQqdHGArpEUXk8XN2tf6Z5DquEXaJSXA-BeqBpO_QwexSoRFJGidl8M3b6ELCf7n3iD5LuRTQGX_no","Scope":"openid profile api1 offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-05-02 09:23:31.622 +01:00 [DBG] Augmenting SignInContext
2020-05-02 09:23:31.622 +01:00 [INF] AuthenticationScheme: idsrv signed in.
2020-05-02 09:23:31.722 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 09:23:31.722 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 09:23:31.722 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 09:23:31.723 +01:00 [DBG] Start token request.
2020-05-02 09:23:31.723 +01:00 [DBG] Start client validation
2020-05-02 09:23:31.723 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 09:23:31.723 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 09:23:31.723 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 09:23:31.723 +01:00 [DBG] Secret id found: mvc
2020-05-02 09:23:31.726 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 09:23:31.726 +01:00 [DBG] Client validation success
2020-05-02 09:23:31.726 +01:00 [DBG] Start token request validation
2020-05-02 09:23:31.731 +01:00 [DBG] Start validation of authorization code token request
2020-05-02 09:23:31.760 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2020-05-02 09:23:31.760 +01:00 [DBG] Validation of authorization code token request success
2020-05-02 09:23:31.760 +01:00 [INF] Token request validation success
{"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"8ab3c3aa9cccebd2a20e53f7fe2536e8ab92aed01a1d8f293a9c5a7c7a9d0d96","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"8ab3c3aa9cccebd2a20e53f7fe2536e8ab92aed01a1d8f293a9c5a7c7a9d0d96","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2020-05-02 09:23:31.774 +01:00 [DBG] Getting claims for access token for client: mvc
2020-05-02 09:23:31.774 +01:00 [DBG] Getting claims for access token for subject: 2
2020-05-02 09:23:31.774 +01:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types [] via ClaimsProviderAccessToken
2020-05-02 09:23:31.774 +01:00 [DBG] Issued claims: []
2020-05-02 09:23:31.779 +01:00 [DBG] Creating refresh token
2020-05-02 09:23:31.779 +01:00 [DBG] Setting an absolute lifetime: 2592000
2020-05-02 09:23:31.797 +01:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2020-05-02 09:23:31.797 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2020-05-02 09:23:31.799 +01:00 [DBG] Token request success.
2020-05-02 09:23:31.810 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-05-02 09:23:31.811 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-05-02 09:23:31.811 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-05-02 09:23:31.815 +01:00 [DBG] Start userinfo request
2020-05-02 09:23:31.817 +01:00 [DBG] Bearer token found in header
2020-05-02 09:23:31.841 +01:00 [DBG] IsActive called from: AccessTokenValidation
2020-05-02 09:23:31.842 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-05-02 09:23:31.843 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1588407811,"exp":1588411411,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvc","sub":"2","auth_time":1588407804,"idp":"local","scope":["openid","profile","api1","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-05-02 09:23:31.844 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2020-05-02 09:23:31.847 +01:00 [DBG] Creating userinfo response
2020-05-02 09:23:31.850 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 09:23:31.852 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 09:23:31.856 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2020-05-02 09:23:31.856 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 09:23:31.858 +01:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2020-05-02 09:23:31.859 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 09:23:31.859 +01:00 [INF] Profile service returned the following claim types: name website
2020-05-02 09:23:31.859 +01:00 [DBG] End userinfo request
2020-05-02 09:40:26.668 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 09:40:27.100 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 09:40:27.100 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 09:40:27.100 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 09:40:27.100 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 09:40:27.100 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 09:40:27.101 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 09:40:27.637 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 09:40:27.638 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 09:40:27.638 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 09:40:27.639 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 09:40:27.639 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 09:40:27.639 +01:00 [DBG] Error Url: /home/error
2020-05-02 09:40:27.639 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 09:40:27.668 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 09:40:27.671 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 09:40:27.671 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 09:40:27.674 +01:00 [DBG] Start discovery request
2020-05-02 09:40:27.914 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 09:40:27.915 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 09:40:27.915 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 09:40:27.918 +01:00 [DBG] Start key discovery request
2020-05-02 09:40:28.125 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 09:40:28.130 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 09:40:28.130 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 09:40:28.135 +01:00 [DBG] Start token request.
2020-05-02 09:40:28.139 +01:00 [DBG] Start client validation
2020-05-02 09:40:28.143 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 09:40:28.146 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 09:40:28.158 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 09:40:28.158 +01:00 [DBG] Secret id found: ro.client
2020-05-02 09:40:28.231 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 09:40:28.231 +01:00 [DBG] Client validation success
2020-05-02 09:40:28.238 +01:00 [DBG] Start token request validation
2020-05-02 09:40:28.247 +01:00 [DBG] Start resource owner password token request validation
2020-05-02 09:40:28.328 +01:00 [DBG] IsActive called from: ResourceOwnerValidation
2020-05-02 09:40:28.328 +01:00 [DBG] Resource owner password token request validation success.
2020-05-02 09:40:28.338 +01:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"username":"alice","password":"***REDACTED***","scope":"api1","grant_type":"password","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-05-02 09:40:28.362 +01:00 [DBG] Getting claims for access token for client: ro.client
2020-05-02 09:40:28.363 +01:00 [DBG] Getting claims for access token for subject: 1
2020-05-02 09:40:28.368 +01:00 [DBG] Get profile called for subject 1 from client ro.client with claim types [] via ClaimsProviderAccessToken
2020-05-02 09:40:28.370 +01:00 [DBG] Issued claims: []
2020-05-02 09:40:28.421 +01:00 [DBG] Token request success.
2020-05-02 09:40:28.600 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 09:40:28.600 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 09:40:28.600 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 09:40:28.600 +01:00 [DBG] Start discovery request
2020-05-02 09:40:28.697 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 09:40:28.697 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 09:40:28.697 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 09:40:28.698 +01:00 [DBG] Start key discovery request
2020-05-02 09:42:49.328 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 09:42:49.721 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 09:42:49.722 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 09:42:49.722 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 09:42:49.722 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 09:42:49.722 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 09:42:49.722 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 09:42:50.218 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 09:42:50.220 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 09:42:50.220 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 09:42:50.220 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 09:42:50.220 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 09:42:50.220 +01:00 [DBG] Error Url: /home/error
2020-05-02 09:42:50.220 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 09:42:50.243 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 09:42:50.246 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 09:42:50.246 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 09:42:50.250 +01:00 [DBG] Start discovery request
2020-05-02 09:42:50.504 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 09:42:50.504 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 09:42:50.504 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 09:42:50.508 +01:00 [DBG] Start key discovery request
2020-05-02 09:42:50.728 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 09:42:50.732 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 09:42:50.732 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 09:42:50.738 +01:00 [DBG] Start token request.
2020-05-02 09:42:50.742 +01:00 [DBG] Start client validation
2020-05-02 09:42:50.746 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 09:42:50.749 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 09:42:50.761 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 09:42:50.761 +01:00 [DBG] Secret id found: ro.client
2020-05-02 09:42:50.833 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 09:42:50.833 +01:00 [DBG] Client validation success
2020-05-02 09:42:50.840 +01:00 [DBG] Start token request validation
2020-05-02 09:42:50.849 +01:00 [DBG] Start resource owner password token request validation
2020-05-02 09:42:50.938 +01:00 [DBG] IsActive called from: ResourceOwnerValidation
2020-05-02 09:42:50.939 +01:00 [DBG] Resource owner password token request validation success.
2020-05-02 09:42:50.947 +01:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"username":"alice","password":"***REDACTED***","scope":"api1","grant_type":"password","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-05-02 09:42:50.972 +01:00 [DBG] Getting claims for access token for client: ro.client
2020-05-02 09:42:50.972 +01:00 [DBG] Getting claims for access token for subject: 1
2020-05-02 09:42:50.977 +01:00 [DBG] Get profile called for subject 1 from client ro.client with claim types [] via ClaimsProviderAccessToken
2020-05-02 09:42:50.978 +01:00 [DBG] Issued claims: []
2020-05-02 09:42:51.022 +01:00 [DBG] Token request success.
2020-05-02 09:42:51.191 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 09:42:51.191 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 09:42:51.191 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 09:42:51.191 +01:00 [DBG] Start discovery request
2020-05-02 09:42:51.284 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 09:42:51.284 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 09:42:51.284 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 09:42:51.284 +01:00 [DBG] Start key discovery request
2020-05-02 09:51:04.887 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 09:51:05.301 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 09:51:05.301 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 09:51:05.301 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 09:51:05.301 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 09:51:05.302 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 09:51:05.302 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 09:51:06.002 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 09:51:06.003 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 09:51:06.003 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 09:51:06.003 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 09:51:06.003 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 09:51:06.003 +01:00 [DBG] Error Url: /home/error
2020-05-02 09:51:06.003 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 09:51:06.028 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 09:51:06.031 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 09:51:06.031 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 09:51:06.033 +01:00 [DBG] Start discovery request
2020-05-02 09:51:06.275 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 09:51:06.276 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 09:51:06.276 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 09:51:06.279 +01:00 [DBG] Start key discovery request
2020-05-02 09:51:06.495 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 09:51:06.499 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 09:51:06.499 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 09:51:06.505 +01:00 [DBG] Start token request.
2020-05-02 09:51:06.509 +01:00 [DBG] Start client validation
2020-05-02 09:51:06.513 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 09:51:06.516 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 09:51:06.528 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 09:51:06.528 +01:00 [DBG] Secret id found: ro.client
2020-05-02 09:51:06.602 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 09:51:06.602 +01:00 [DBG] Client validation success
2020-05-02 09:51:06.608 +01:00 [DBG] Start token request validation
2020-05-02 09:51:06.617 +01:00 [DBG] Start resource owner password token request validation
2020-05-02 09:51:06.702 +01:00 [DBG] IsActive called from: ResourceOwnerValidation
2020-05-02 09:51:06.702 +01:00 [DBG] Resource owner password token request validation success.
2020-05-02 09:51:06.711 +01:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"username":"alice","password":"***REDACTED***","scope":"api1","grant_type":"password","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-05-02 09:51:06.736 +01:00 [DBG] Getting claims for access token for client: ro.client
2020-05-02 09:51:06.736 +01:00 [DBG] Getting claims for access token for subject: 1
2020-05-02 09:51:06.741 +01:00 [DBG] Get profile called for subject 1 from client ro.client with claim types [] via ClaimsProviderAccessToken
2020-05-02 09:51:06.743 +01:00 [DBG] Issued claims: []
2020-05-02 09:51:06.792 +01:00 [DBG] Token request success.
2020-05-02 09:51:06.965 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 09:51:06.965 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 09:51:06.965 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 09:51:06.965 +01:00 [DBG] Start discovery request
2020-05-02 09:51:07.061 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 09:51:07.062 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 09:51:07.062 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 09:51:07.062 +01:00 [DBG] Start key discovery request
2020-05-02 09:51:07.187 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 09:51:07.187 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 09:51:07.187 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 09:51:07.187 +01:00 [DBG] Start discovery request
2020-05-02 09:51:07.278 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 09:51:07.278 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 09:51:07.278 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 09:51:07.278 +01:00 [DBG] Start key discovery request
2020-05-02 09:51:07.318 +01:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2020-05-02 09:51:07.320 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2020-05-02 09:51:07.320 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2020-05-02 09:51:07.331 +01:00 [DBG] Processing signout request for 2
2020-05-02 09:51:07.337 +01:00 [DBG] Start end session request validation
2020-05-02 09:51:07.343 +01:00 [DBG] Start identity token validation
2020-05-02 09:51:07.351 +01:00 [DBG] Client found: mvc / MVC Client
2020-05-02 09:51:07.358 +01:00 [DBG] IsActive called from: IdentityTokenValidation
2020-05-02 09:51:07.358 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-05-02 09:51:07.359 +01:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1588407811,"exp":1588408111,"iss":"http://localhost:5000","aud":"mvc","nonce":"637240045949843518.YWM5OTZiZmMtYjc3Ny00NGU0LWFlN2EtYzhiZjE4NjQ2ZDFiOTVlNzQzYjMtZjI3MS00NTAxLTk1MmQtYjY0ODBjNjY1MmU2","iat":1588407811,"at_hash":"05rkiAOU4rEdhjncKxKkJg","sid":"07e93812b006de16ad442614336b959a","sub":"2","auth_time":1588407804,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2020-05-02 09:51:07.365 +01:00 [INF] End session request validation failure: Invalid post logout URI
{"ClientId":"mvc","ClientName":"MVC Client","SubjectId":"2","PostLogOutUri":null,"State":null,"Raw":{"post_logout_redirect_uri":"http://localhost:5002/signout-callback-oidc","id_token_hint":"eyJhbGciOiJSUzI1NiIsImtpZCI6IjRlMTNiY2NjNWEyOTExNzY3NTRiZDRhZjE3ZWRkYWNkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1ODg0MDc4MTEsImV4cCI6MTU4ODQwODExMSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzcyNDAwNDU5NDk4NDM1MTguWVdNNU9UWmlabU10WWpjM055MDBOR1UwTFdGbE4yRXRZemhpWmpFNE5qUTJaREZpT1RWbE56UXpZak10WmpJM01TMDBOVEF4TFRrMU1tUXRZalkwT0RCak5qWTFNbVUyIiwiaWF0IjoxNTg4NDA3ODExLCJhdF9oYXNoIjoiMDVya2lBT1U0ckVkaGpuY0t4S2tKZyIsInNpZCI6IjA3ZTkzODEyYjAwNmRlMTZhZDQ0MjYxNDMzNmI5NTlhIiwic3ViIjoiMiIsImF1dGhfdGltZSI6MTU4ODQwNzgwNCwiaWRwIjoibG9jYWwiLCJhbXIiOlsicHdkIl19.pTlqj2-rmxuUlPcrynxsEhnnSrSjqy7SxS3RLwICIFBRILGxdq6HjvFfpdohMEmDhe37W1LTv79UYX9-aDRCbOBKax6fsZlGRiDC2Tcc9vnNis6M3yV_RBQCGAE5wGrb3tPuOnYqocMr_DwKkFK1VtQKLwCQvqeIyJS9zrXmpcgGFuUIVjJJIcQ2m2ErrutTLdtRys8CHUNSlabj4NOrtugxPm9m6aMJV0ffbpRc3heGZw-CHpIBb0VV61vqwNSfPPDG3trDPJjoFLms8f_uqhxf3HWr7959BaUAIFbnZfP21d24vMHTiQYq2GPDFeVhLf67hDPfbgMcEzAfo9GfuQ","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeKt7yRVFpgg_uFsOPqxt91R-ODGJV92q6sE7E9D9WJUppAFkOmyYj2RUWoYIOcQ6fV1N0wEfB7PfPQWU0aBc-iqUiOFizD8StISdfKEb2RLFsEd3NjBsp24j25vtcxce-ZoCi0kw70nnNlUCNmsx4A5","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"EndSessionRequestValidationLog"}
2020-05-02 09:51:07.365 +01:00 [ERR] Error processing end session request Invalid request
2020-05-02 09:51:08.995 +01:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-05-02 09:51:09.029 +01:00 [INF] AuthenticationScheme: idsrv signed out.
2020-05-02 09:51:09.065 +01:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2020-05-02 09:51:09.066 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2020-05-02 09:51:09.066 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2020-05-02 09:51:09.069 +01:00 [DBG] Processing signout callback request
2020-05-02 09:51:09.081 +01:00 [DBG] No client front-channel logout URLs
2020-05-02 09:51:09.081 +01:00 [DBG] No client back-channel logout URLs
2020-05-02 09:51:09.081 +01:00 [INF] Successful signout callback.
2020-05-02 09:51:09.081 +01:00 [DBG] No client front-channel iframe urls
2020-05-02 09:51:09.081 +01:00 [DBG] No client back-channel iframe urls
2020-05-02 09:51:17.221 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-05-02 09:51:17.223 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-05-02 09:51:17.223 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-05-02 09:51:17.225 +01:00 [DBG] Start authorize request
2020-05-02 09:51:17.229 +01:00 [DBG] No user present in authorize request
2020-05-02 09:51:17.233 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 09:51:17.241 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 09:51:17.242 +01:00 [DBG] No PKCE used.
2020-05-02 09:51:17.267 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 09:51:17.269 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeJ-iewJrqx4wPx09z0bQUr2_TokmEbwapbSkDjY03Z-nNEuJnh0PG0LiJENuv3G_0PH96tAEU9T3uu6irUMH4UIbbRWPRp_wEOwTPw7qOiqKI9UxRgP_pwIV4Tk3ABsVTewda9Emr-e7aTpimAfTFJQPMUBcYcrF9cJQFEQf8HHlrXskQDMVZjOaplfe7NClRbUJc4-onjPl6FGJxC_xyokK-oTk7pfiYGYfp2gfpEc8Too3Pt0szOvwuSxk0Ie8gAWyoxFjjFePx53a6VOnSLD-2mgjRYXfAWCGqdey1RpvoNcQmAqa8o3C3NqmLrs7vM","UiLocales":null,"Nonce":"637240062772114273.YTRiNjQzZjYtNzllOC00MzU5LWI4OGMtZTJjOWRiMWFhMjdlYTQyZjMxZWQtZmM0OS00Mjg5LWE3MWUtOWYzMDUxOTY4NWE4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240062772114273.YTRiNjQzZjYtNzllOC00MzU5LWI4OGMtZTJjOWRiMWFhMjdlYTQyZjMxZWQtZmM0OS00Mjg5LWE3MWUtOWYzMDUxOTY4NWE4","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeJ-iewJrqx4wPx09z0bQUr2_TokmEbwapbSkDjY03Z-nNEuJnh0PG0LiJENuv3G_0PH96tAEU9T3uu6irUMH4UIbbRWPRp_wEOwTPw7qOiqKI9UxRgP_pwIV4Tk3ABsVTewda9Emr-e7aTpimAfTFJQPMUBcYcrF9cJQFEQf8HHlrXskQDMVZjOaplfe7NClRbUJc4-onjPl6FGJxC_xyokK-oTk7pfiYGYfp2gfpEc8Too3Pt0szOvwuSxk0Ie8gAWyoxFjjFePx53a6VOnSLD-2mgjRYXfAWCGqdey1RpvoNcQmAqa8o3C3NqmLrs7vM","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 09:51:17.276 +01:00 [INF] Showing login: User is not authenticated
2020-05-02 09:51:17.296 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 09:51:17.298 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 09:51:17.298 +01:00 [DBG] No PKCE used.
2020-05-02 09:51:17.314 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 09:51:23.109 +01:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-05-02 09:51:23.120 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 09:51:23.124 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 09:51:23.124 +01:00 [DBG] No PKCE used.
2020-05-02 09:51:23.141 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 09:51:23.150 +01:00 [DBG] Augmenting SignInContext
2020-05-02 09:51:23.152 +01:00 [DBG] Adding idp claim with value: local
2020-05-02 09:51:23.152 +01:00 [DBG] Adding amr claim with value: pwd
2020-05-02 09:51:23.157 +01:00 [INF] AuthenticationScheme: idsrv signed in.
2020-05-02 09:51:23.166 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-05-02 09:51:23.166 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-05-02 09:51:23.166 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-05-02 09:51:23.170 +01:00 [DBG] Start authorize callback request
2020-05-02 09:51:23.172 +01:00 [DBG] User in authorize request: 2
2020-05-02 09:51:23.172 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 09:51:23.175 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 09:51:23.175 +01:00 [DBG] No PKCE used.
2020-05-02 09:51:23.189 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 09:51:23.190 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeJ-iewJrqx4wPx09z0bQUr2_TokmEbwapbSkDjY03Z-nNEuJnh0PG0LiJENuv3G_0PH96tAEU9T3uu6irUMH4UIbbRWPRp_wEOwTPw7qOiqKI9UxRgP_pwIV4Tk3ABsVTewda9Emr-e7aTpimAfTFJQPMUBcYcrF9cJQFEQf8HHlrXskQDMVZjOaplfe7NClRbUJc4-onjPl6FGJxC_xyokK-oTk7pfiYGYfp2gfpEc8Too3Pt0szOvwuSxk0Ie8gAWyoxFjjFePx53a6VOnSLD-2mgjRYXfAWCGqdey1RpvoNcQmAqa8o3C3NqmLrs7vM","UiLocales":null,"Nonce":"637240062772114273.YTRiNjQzZjYtNzllOC00MzU5LWI4OGMtZTJjOWRiMWFhMjdlYTQyZjMxZWQtZmM0OS00Mjg5LWE3MWUtOWYzMDUxOTY4NWE4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"41c516f5f25c979d2c944f282d1637e2","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240062772114273.YTRiNjQzZjYtNzllOC00MzU5LWI4OGMtZTJjOWRiMWFhMjdlYTQyZjMxZWQtZmM0OS00Mjg5LWE3MWUtOWYzMDUxOTY4NWE4","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeJ-iewJrqx4wPx09z0bQUr2_TokmEbwapbSkDjY03Z-nNEuJnh0PG0LiJENuv3G_0PH96tAEU9T3uu6irUMH4UIbbRWPRp_wEOwTPw7qOiqKI9UxRgP_pwIV4Tk3ABsVTewda9Emr-e7aTpimAfTFJQPMUBcYcrF9cJQFEQf8HHlrXskQDMVZjOaplfe7NClRbUJc4-onjPl6FGJxC_xyokK-oTk7pfiYGYfp2gfpEc8Too3Pt0szOvwuSxk0Ie8gAWyoxFjjFePx53a6VOnSLD-2mgjRYXfAWCGqdey1RpvoNcQmAqa8o3C3NqmLrs7vM","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 09:51:23.190 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2020-05-02 09:51:23.196 +01:00 [DBG] Scopes contains offline_access, consent is required
2020-05-02 09:51:23.196 +01:00 [INF] Showing consent: User has not yet consented
2020-05-02 09:51:23.213 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 09:51:23.216 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 09:51:23.216 +01:00 [DBG] No PKCE used.
2020-05-02 09:51:23.231 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 09:51:24.581 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-05-02 09:51:24.592 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 09:51:24.595 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 09:51:24.595 +01:00 [DBG] No PKCE used.
2020-05-02 09:51:24.611 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 09:51:24.627 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-05-02 09:51:24.628 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-05-02 09:51:24.628 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-05-02 09:51:24.628 +01:00 [DBG] Start authorize callback request
2020-05-02 09:51:24.630 +01:00 [DBG] User in authorize request: 2
2020-05-02 09:51:24.630 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 09:51:24.633 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 09:51:24.633 +01:00 [DBG] No PKCE used.
2020-05-02 09:51:24.648 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 09:51:24.648 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeJ-iewJrqx4wPx09z0bQUr2_TokmEbwapbSkDjY03Z-nNEuJnh0PG0LiJENuv3G_0PH96tAEU9T3uu6irUMH4UIbbRWPRp_wEOwTPw7qOiqKI9UxRgP_pwIV4Tk3ABsVTewda9Emr-e7aTpimAfTFJQPMUBcYcrF9cJQFEQf8HHlrXskQDMVZjOaplfe7NClRbUJc4-onjPl6FGJxC_xyokK-oTk7pfiYGYfp2gfpEc8Too3Pt0szOvwuSxk0Ie8gAWyoxFjjFePx53a6VOnSLD-2mgjRYXfAWCGqdey1RpvoNcQmAqa8o3C3NqmLrs7vM","UiLocales":null,"Nonce":"637240062772114273.YTRiNjQzZjYtNzllOC00MzU5LWI4OGMtZTJjOWRiMWFhMjdlYTQyZjMxZWQtZmM0OS00Mjg5LWE3MWUtOWYzMDUxOTY4NWE4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"41c516f5f25c979d2c944f282d1637e2","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240062772114273.YTRiNjQzZjYtNzllOC00MzU5LWI4OGMtZTJjOWRiMWFhMjdlYTQyZjMxZWQtZmM0OS00Mjg5LWE3MWUtOWYzMDUxOTY4NWE4","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeJ-iewJrqx4wPx09z0bQUr2_TokmEbwapbSkDjY03Z-nNEuJnh0PG0LiJENuv3G_0PH96tAEU9T3uu6irUMH4UIbbRWPRp_wEOwTPw7qOiqKI9UxRgP_pwIV4Tk3ABsVTewda9Emr-e7aTpimAfTFJQPMUBcYcrF9cJQFEQf8HHlrXskQDMVZjOaplfe7NClRbUJc4-onjPl6FGJxC_xyokK-oTk7pfiYGYfp2gfpEc8Too3Pt0szOvwuSxk0Ie8gAWyoxFjjFePx53a6VOnSLD-2mgjRYXfAWCGqdey1RpvoNcQmAqa8o3C3NqmLrs7vM","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 09:51:24.648 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2020-05-02 09:51:24.648 +01:00 [DBG] Scopes contains offline_access, consent is required
2020-05-02 09:51:24.652 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2020-05-02 09:51:24.652 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2020-05-02 09:51:24.654 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 2
2020-05-02 09:51:24.722 +01:00 [DBG] Creating Hybrid Flow response.
2020-05-02 09:51:24.739 +01:00 [DBG] Creating Implicit Flow response.
2020-05-02 09:51:24.746 +01:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2020-05-02 09:51:24.746 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2020-05-02 09:51:24.752 +01:00 [INF] Authorize endpoint response
{"SubjectId":"2","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeJ-iewJrqx4wPx09z0bQUr2_TokmEbwapbSkDjY03Z-nNEuJnh0PG0LiJENuv3G_0PH96tAEU9T3uu6irUMH4UIbbRWPRp_wEOwTPw7qOiqKI9UxRgP_pwIV4Tk3ABsVTewda9Emr-e7aTpimAfTFJQPMUBcYcrF9cJQFEQf8HHlrXskQDMVZjOaplfe7NClRbUJc4-onjPl6FGJxC_xyokK-oTk7pfiYGYfp2gfpEc8Too3Pt0szOvwuSxk0Ie8gAWyoxFjjFePx53a6VOnSLD-2mgjRYXfAWCGqdey1RpvoNcQmAqa8o3C3NqmLrs7vM","Scope":"openid profile api1 offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-05-02 09:51:24.761 +01:00 [DBG] Augmenting SignInContext
2020-05-02 09:51:24.761 +01:00 [INF] AuthenticationScheme: idsrv signed in.
2020-05-02 09:51:24.863 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 09:51:24.864 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 09:51:24.864 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 09:51:24.864 +01:00 [DBG] Start token request.
2020-05-02 09:51:24.864 +01:00 [DBG] Start client validation
2020-05-02 09:51:24.864 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 09:51:24.864 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 09:51:24.864 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 09:51:24.865 +01:00 [DBG] Secret id found: mvc
2020-05-02 09:51:24.867 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 09:51:24.867 +01:00 [DBG] Client validation success
2020-05-02 09:51:24.867 +01:00 [DBG] Start token request validation
2020-05-02 09:51:24.874 +01:00 [DBG] Start validation of authorization code token request
2020-05-02 09:51:24.901 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2020-05-02 09:51:24.901 +01:00 [DBG] Validation of authorization code token request success
2020-05-02 09:51:24.901 +01:00 [INF] Token request validation success
{"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"ef498a435bdf90c4198791bb616802a020d1eb2a78cef18398eb7f83448cfed9","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"ef498a435bdf90c4198791bb616802a020d1eb2a78cef18398eb7f83448cfed9","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2020-05-02 09:51:24.915 +01:00 [DBG] Getting claims for access token for client: mvc
2020-05-02 09:51:24.915 +01:00 [DBG] Getting claims for access token for subject: 2
2020-05-02 09:51:24.915 +01:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types [] via ClaimsProviderAccessToken
2020-05-02 09:51:24.916 +01:00 [DBG] Issued claims: []
2020-05-02 09:51:24.920 +01:00 [DBG] Creating refresh token
2020-05-02 09:51:24.920 +01:00 [DBG] Setting an absolute lifetime: 2592000
2020-05-02 09:51:24.940 +01:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2020-05-02 09:51:24.940 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2020-05-02 09:51:24.942 +01:00 [DBG] Token request success.
2020-05-02 09:51:24.953 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-05-02 09:51:24.955 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-05-02 09:51:24.955 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-05-02 09:51:24.959 +01:00 [DBG] Start userinfo request
2020-05-02 09:51:24.962 +01:00 [DBG] Bearer token found in header
2020-05-02 09:51:24.977 +01:00 [DBG] IsActive called from: AccessTokenValidation
2020-05-02 09:51:24.977 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-05-02 09:51:24.978 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1588409484,"exp":1588413084,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvc","sub":"2","auth_time":1588409483,"idp":"local","scope":["openid","profile","api1","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-05-02 09:51:24.979 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2020-05-02 09:51:24.982 +01:00 [DBG] Creating userinfo response
2020-05-02 09:51:24.985 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 09:51:24.987 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 09:51:24.991 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2020-05-02 09:51:24.991 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 09:51:24.993 +01:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2020-05-02 09:51:24.994 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 09:51:24.994 +01:00 [INF] Profile service returned the following claim types: name website
2020-05-02 09:51:24.994 +01:00 [DBG] End userinfo request
2020-05-02 09:52:00.988 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 09:52:01.385 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 09:52:01.385 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 09:52:01.385 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 09:52:01.385 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 09:52:01.385 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 09:52:01.385 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 09:52:02.118 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 09:52:02.120 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 09:52:02.120 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 09:52:02.120 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 09:52:02.120 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 09:52:02.120 +01:00 [DBG] Error Url: /home/error
2020-05-02 09:52:02.120 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 09:52:02.143 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 09:52:02.147 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 09:52:02.147 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 09:52:02.151 +01:00 [DBG] Start discovery request
2020-05-02 09:52:02.400 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 09:52:02.401 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 09:52:02.401 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 09:52:02.403 +01:00 [DBG] Start key discovery request
2020-05-02 09:52:02.602 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 09:52:02.607 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 09:52:02.607 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 09:52:02.613 +01:00 [DBG] Start token request.
2020-05-02 09:52:02.619 +01:00 [DBG] Start client validation
2020-05-02 09:52:02.623 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 09:52:02.625 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 09:52:02.637 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 09:52:02.637 +01:00 [DBG] Secret id found: ro.client
2020-05-02 09:52:02.708 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 09:52:02.708 +01:00 [DBG] Client validation success
2020-05-02 09:52:02.715 +01:00 [DBG] Start token request validation
2020-05-02 09:52:02.724 +01:00 [DBG] Start resource owner password token request validation
2020-05-02 09:52:02.806 +01:00 [DBG] IsActive called from: ResourceOwnerValidation
2020-05-02 09:52:02.806 +01:00 [DBG] Resource owner password token request validation success.
2020-05-02 09:52:02.815 +01:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"username":"alice","password":"***REDACTED***","scope":"api1","grant_type":"password","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-05-02 09:52:02.838 +01:00 [DBG] Getting claims for access token for client: ro.client
2020-05-02 09:52:02.838 +01:00 [DBG] Getting claims for access token for subject: 1
2020-05-02 09:52:02.842 +01:00 [DBG] Get profile called for subject 1 from client ro.client with claim types [] via ClaimsProviderAccessToken
2020-05-02 09:52:02.844 +01:00 [DBG] Issued claims: []
2020-05-02 09:52:02.890 +01:00 [DBG] Token request success.
2020-05-02 09:52:03.058 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 09:52:03.058 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 09:52:03.058 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 09:52:03.058 +01:00 [DBG] Start discovery request
2020-05-02 09:52:03.154 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 09:52:03.154 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 09:52:03.154 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 09:52:03.154 +01:00 [DBG] Start key discovery request
2020-05-02 09:52:59.577 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 09:52:59.948 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 09:52:59.948 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 09:52:59.949 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 09:52:59.949 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 09:52:59.949 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 09:52:59.949 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 09:53:02.949 +01:00 [FTL] Application startup exception
System.Exception: Mongo Repository created/populated! Please restart you website, so Mongo driver will be configured  to ignore Extra Elements - e.g. IdentityServer "_id" 
   at IdentityServer.Startup.InitializeDatabase(IApplicationBuilder app) in C:\othersrc\IdentityServer4.Samples.Mongo\IdentityServer4-Samples\7_EntityFrameworkStorage-mongo\src\IdentityServer\Startup.cs:line 161
   at IdentityServer.Startup.Configure(IApplicationBuilder app, IHostingEnvironment env) in C:\othersrc\IdentityServer4.Samples.Mongo\IdentityServer4-Samples\7_EntityFrameworkStorage-mongo\src\IdentityServer\Startup.cs:line 114
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)
   at Microsoft.AspNetCore.Mvc.Internal.MiddlewareFilterBuilderStartupFilter.<>c__DisplayClass0_0.<Configure>g__MiddlewareFilterBuilder|0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Server.IISIntegration.IISSetupFilter.<>c__DisplayClass4_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()
2020-05-02 09:53:03.135 +01:00 [ERR] Connection id "0HLVEEOSK2RFA", Request id "0HLVEEOSK2RFA:00000001": An unhandled exception was thrown by the application.
System.OverflowException: Arithmetic operation resulted in an overflow.
   at System.IO.StreamWriter.Write(String value)
   at Microsoft.AspNetCore.Hosting.Views.ErrorPage.ExecuteAsync()
   at Microsoft.Extensions.RazorViews.BaseView.ExecuteAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2020-05-02 09:53:03.135 +01:00 [ERR] Connection id "0HLVEEOSK2RFB", Request id "0HLVEEOSK2RFB:00000001": An unhandled exception was thrown by the application.
System.OverflowException: Arithmetic operation resulted in an overflow.
   at System.IO.StreamWriter.Write(String value)
   at Microsoft.AspNetCore.Hosting.Views.ErrorPage.ExecuteAsync()
   at Microsoft.Extensions.RazorViews.BaseView.ExecuteAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2020-05-02 09:53:03.135 +01:00 [ERR] Connection id "0HLVEEOSK2RFC", Request id "0HLVEEOSK2RFC:00000001": An unhandled exception was thrown by the application.
System.OverflowException: Arithmetic operation resulted in an overflow.
   at System.IO.StreamWriter.Write(String value)
   at Microsoft.AspNetCore.Hosting.Views.ErrorPage.ExecuteAsync()
   at Microsoft.Extensions.RazorViews.BaseView.ExecuteAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2020-05-02 09:53:09.734 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 09:53:10.174 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 09:53:10.174 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 09:53:10.174 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 09:53:10.174 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 09:53:10.174 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 09:53:10.174 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 09:53:10.866 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 09:53:10.867 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 09:53:10.867 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 09:53:10.867 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 09:53:10.867 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 09:53:10.867 +01:00 [DBG] Error Url: /home/error
2020-05-02 09:53:10.867 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 09:53:10.892 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 09:53:10.895 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 09:53:10.896 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 09:53:10.898 +01:00 [DBG] Start discovery request
2020-05-02 09:53:11.151 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 09:53:11.151 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 09:53:11.151 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 09:53:11.154 +01:00 [DBG] Start key discovery request
2020-05-02 09:53:11.360 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 09:53:11.365 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 09:53:11.365 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 09:53:11.371 +01:00 [DBG] Start token request.
2020-05-02 09:53:11.375 +01:00 [DBG] Start client validation
2020-05-02 09:53:11.378 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 09:53:11.381 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 09:53:11.394 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 09:53:11.394 +01:00 [DBG] Secret id found: ro.client
2020-05-02 09:53:11.466 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 09:53:11.466 +01:00 [DBG] Client validation success
2020-05-02 09:53:11.473 +01:00 [DBG] Start token request validation
2020-05-02 09:53:11.482 +01:00 [DBG] Start resource owner password token request validation
2020-05-02 09:53:11.560 +01:00 [DBG] IsActive called from: ResourceOwnerValidation
2020-05-02 09:53:11.561 +01:00 [DBG] Resource owner password token request validation success.
2020-05-02 09:53:11.570 +01:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"username":"alice","password":"***REDACTED***","scope":"api1","grant_type":"password","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-05-02 09:53:11.593 +01:00 [DBG] Getting claims for access token for client: ro.client
2020-05-02 09:53:11.594 +01:00 [DBG] Getting claims for access token for subject: 1
2020-05-02 09:53:11.599 +01:00 [DBG] Get profile called for subject 1 from client ro.client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 09:53:11.601 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 09:53:11.647 +01:00 [DBG] Token request success.
2020-05-02 09:53:11.815 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 09:53:11.816 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 09:53:11.816 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 09:53:11.816 +01:00 [DBG] Start discovery request
2020-05-02 09:53:11.946 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 09:53:11.946 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 09:53:11.946 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 09:53:11.946 +01:00 [DBG] Start key discovery request
2020-05-02 09:53:12.892 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 09:53:12.892 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 09:53:12.892 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 09:53:12.892 +01:00 [DBG] Start discovery request
2020-05-02 09:53:12.974 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 09:53:12.974 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 09:53:12.974 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 09:53:12.974 +01:00 [DBG] Start key discovery request
2020-05-02 09:53:13.007 +01:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2020-05-02 09:53:13.007 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2020-05-02 09:53:13.007 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2020-05-02 09:53:13.012 +01:00 [DBG] Processing signout request for 2
2020-05-02 09:53:13.016 +01:00 [DBG] Start end session request validation
2020-05-02 09:53:13.021 +01:00 [DBG] Start identity token validation
2020-05-02 09:53:13.028 +01:00 [DBG] Client found: mvc / MVC Client
2020-05-02 09:53:13.036 +01:00 [DBG] IsActive called from: IdentityTokenValidation
2020-05-02 09:53:13.036 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-05-02 09:53:13.037 +01:00 [DBG] Token validation success
{"ClientId":"mvc","ClientName":"MVC Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1588409484,"exp":1588409784,"iss":"http://localhost:5000","aud":"mvc","nonce":"637240062772114273.YTRiNjQzZjYtNzllOC00MzU5LWI4OGMtZTJjOWRiMWFhMjdlYTQyZjMxZWQtZmM0OS00Mjg5LWE3MWUtOWYzMDUxOTY4NWE4","iat":1588409484,"at_hash":"LgG2iMJxeOpH-_Ev7J7VOQ","sid":"41c516f5f25c979d2c944f282d1637e2","sub":"2","auth_time":1588409483,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2020-05-02 09:53:13.045 +01:00 [INF] End session request validation failure: Invalid post logout URI
{"ClientId":"mvc","ClientName":"MVC Client","SubjectId":"2","PostLogOutUri":null,"State":null,"Raw":{"post_logout_redirect_uri":"http://localhost:5002/signout-callback-oidc","id_token_hint":"eyJhbGciOiJSUzI1NiIsImtpZCI6IjRlMTNiY2NjNWEyOTExNzY3NTRiZDRhZjE3ZWRkYWNkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1ODg0MDk0ODQsImV4cCI6MTU4ODQwOTc4NCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzcyNDAwNjI3NzIxMTQyNzMuWVRSaU5qUXpaall0TnpsbE9DMDBNelU1TFdJNE9HTXRaVEpqT1dSaU1XRmhNamRsWVRReVpqTXhaV1F0Wm1NME9TMDBNamc1TFdFM01XVXRPV1l6TURVeE9UWTROV0U0IiwiaWF0IjoxNTg4NDA5NDg0LCJhdF9oYXNoIjoiTGdHMmlNSnhlT3BILV9FdjdKN1ZPUSIsInNpZCI6IjQxYzUxNmY1ZjI1Yzk3OWQyYzk0NGYyODJkMTYzN2UyIiwic3ViIjoiMiIsImF1dGhfdGltZSI6MTU4ODQwOTQ4MywiaWRwIjoibG9jYWwiLCJhbXIiOlsicHdkIl19.psnV_IQPtZhvBV3QtIkC5uJTaHAPbrA6OA5mVMM62DQJgrCk-LE0rrJTcze8_DxwEasoD4NpCbqWb4UcopggHpbW7KvKBIr64ajcvxjP_zVckns_DILpaWr8J7NwQd8n1WkEvHcWEYtTsw1afyFHuxRgtM8fyX6z9KNDUL7c1psN8n7TdI1RYb-0Xv9M74AP7pr5E_bHb-S5TfNTiS2cFg9AJ2dT4atzMvqkswo76TbDLdjmZC_rKCU8Uxz6B82MSXnROwyzjYs1XQ8Aht2cQcsAx91SlatNl5gaX_BV2Y5atsx-LS4DfG6dThv4C9GyKmMOK3FLu7Wx4OZ56MXCkg","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeIfK7jmZ_o1eCTJwSd3rX7bjbv3Eg7_vtprppBLDt010hLXldOGzd2AbZfTXht2xypyiuhau7KlGpfr4NaDD7bhhS66N8n7smO9eRbiq_ADZuiakvshIAaNYf1QzmmJ_NLkXjmS_XMqfhoEOfYwBVIG","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"EndSessionRequestValidationLog"}
2020-05-02 09:53:13.045 +01:00 [ERR] Error processing end session request Invalid request
2020-05-02 09:53:14.777 +01:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-05-02 09:53:14.809 +01:00 [INF] AuthenticationScheme: idsrv signed out.
2020-05-02 09:53:14.838 +01:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2020-05-02 09:53:14.840 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2020-05-02 09:53:14.840 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2020-05-02 09:53:14.843 +01:00 [DBG] Processing signout callback request
2020-05-02 09:53:14.854 +01:00 [DBG] No client front-channel logout URLs
2020-05-02 09:53:14.854 +01:00 [DBG] No client back-channel logout URLs
2020-05-02 09:53:14.854 +01:00 [INF] Successful signout callback.
2020-05-02 09:53:14.854 +01:00 [DBG] No client front-channel iframe urls
2020-05-02 09:53:14.854 +01:00 [DBG] No client back-channel iframe urls
2020-05-02 09:53:18.015 +01:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2020-05-02 09:53:18.016 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2020-05-02 09:53:18.016 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2020-05-02 09:53:18.016 +01:00 [DBG] Processing signout callback request
2020-05-02 09:53:18.021 +01:00 [DBG] No client front-channel logout URLs
2020-05-02 09:53:18.021 +01:00 [DBG] No client back-channel logout URLs
2020-05-02 09:53:18.021 +01:00 [INF] Successful signout callback.
2020-05-02 09:53:18.021 +01:00 [DBG] No client front-channel iframe urls
2020-05-02 09:53:18.021 +01:00 [DBG] No client back-channel iframe urls
2020-05-02 09:53:23.391 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-05-02 09:53:23.393 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-05-02 09:53:23.393 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-05-02 09:53:23.397 +01:00 [DBG] Start authorize request
2020-05-02 09:53:23.401 +01:00 [DBG] No user present in authorize request
2020-05-02 09:53:23.405 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 09:53:23.415 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 09:53:23.417 +01:00 [DBG] No PKCE used.
2020-05-02 09:53:23.442 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 09:53:23.444 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeJYXoL2Dvy2Tcvny-wT5qLJVMmHiyB3SpUo-t3GKYcsWRBzopHTwMoBpShRX2LJ9vfPIPjW63HUDAv_aAdg_Nz567tYJv5fPVbUGy0NnuXP0gPZqS2xZ0p4jcGNhyTeVdIlkApAjmBK04vmWd6OuvxynsTGCBmdyMeVCQmjpkd-DOUYr3n7-rFdLNzW_2bCc7WSeYZ2jBOTf7Bnr21vD4CymQd7F3eAp2rY96Y0COekgBNjOcpOlAhTEmk8TgruYdNa4el_9f9cdQ7rJPloLZAFtSSKM7qIdk-a6zYP1whX_Z4zVJaB9N11CFFpLkdCkGE","UiLocales":null,"Nonce":"637240064033801768.MGM0Yjk5YTEtZDlkYS00ZjBmLWE0ODAtNjhlZDk5MDkwNDlhYmNiMmNhNTctOGNiNy00M2NhLWE0MGYtYjQxYjc4MDY2OTAz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240064033801768.MGM0Yjk5YTEtZDlkYS00ZjBmLWE0ODAtNjhlZDk5MDkwNDlhYmNiMmNhNTctOGNiNy00M2NhLWE0MGYtYjQxYjc4MDY2OTAz","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeJYXoL2Dvy2Tcvny-wT5qLJVMmHiyB3SpUo-t3GKYcsWRBzopHTwMoBpShRX2LJ9vfPIPjW63HUDAv_aAdg_Nz567tYJv5fPVbUGy0NnuXP0gPZqS2xZ0p4jcGNhyTeVdIlkApAjmBK04vmWd6OuvxynsTGCBmdyMeVCQmjpkd-DOUYr3n7-rFdLNzW_2bCc7WSeYZ2jBOTf7Bnr21vD4CymQd7F3eAp2rY96Y0COekgBNjOcpOlAhTEmk8TgruYdNa4el_9f9cdQ7rJPloLZAFtSSKM7qIdk-a6zYP1whX_Z4zVJaB9N11CFFpLkdCkGE","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 09:53:23.450 +01:00 [INF] Showing login: User is not authenticated
2020-05-02 09:53:23.469 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 09:53:23.471 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 09:53:23.471 +01:00 [DBG] No PKCE used.
2020-05-02 09:53:23.485 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 09:53:29.190 +01:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-05-02 09:53:29.203 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 09:53:29.206 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 09:53:29.206 +01:00 [DBG] No PKCE used.
2020-05-02 09:53:29.222 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 09:53:29.233 +01:00 [DBG] Augmenting SignInContext
2020-05-02 09:53:29.235 +01:00 [DBG] Adding idp claim with value: local
2020-05-02 09:53:29.235 +01:00 [DBG] Adding amr claim with value: pwd
2020-05-02 09:53:29.240 +01:00 [INF] AuthenticationScheme: idsrv signed in.
2020-05-02 09:53:29.248 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-05-02 09:53:29.249 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-05-02 09:53:29.249 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-05-02 09:53:29.253 +01:00 [DBG] Start authorize callback request
2020-05-02 09:53:29.255 +01:00 [DBG] User in authorize request: 2
2020-05-02 09:53:29.255 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 09:53:29.258 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 09:53:29.258 +01:00 [DBG] No PKCE used.
2020-05-02 09:53:29.273 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 09:53:29.273 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeJYXoL2Dvy2Tcvny-wT5qLJVMmHiyB3SpUo-t3GKYcsWRBzopHTwMoBpShRX2LJ9vfPIPjW63HUDAv_aAdg_Nz567tYJv5fPVbUGy0NnuXP0gPZqS2xZ0p4jcGNhyTeVdIlkApAjmBK04vmWd6OuvxynsTGCBmdyMeVCQmjpkd-DOUYr3n7-rFdLNzW_2bCc7WSeYZ2jBOTf7Bnr21vD4CymQd7F3eAp2rY96Y0COekgBNjOcpOlAhTEmk8TgruYdNa4el_9f9cdQ7rJPloLZAFtSSKM7qIdk-a6zYP1whX_Z4zVJaB9N11CFFpLkdCkGE","UiLocales":null,"Nonce":"637240064033801768.MGM0Yjk5YTEtZDlkYS00ZjBmLWE0ODAtNjhlZDk5MDkwNDlhYmNiMmNhNTctOGNiNy00M2NhLWE0MGYtYjQxYjc4MDY2OTAz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"f224fc7e0526c20d7c4f2bdc81344930","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240064033801768.MGM0Yjk5YTEtZDlkYS00ZjBmLWE0ODAtNjhlZDk5MDkwNDlhYmNiMmNhNTctOGNiNy00M2NhLWE0MGYtYjQxYjc4MDY2OTAz","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeJYXoL2Dvy2Tcvny-wT5qLJVMmHiyB3SpUo-t3GKYcsWRBzopHTwMoBpShRX2LJ9vfPIPjW63HUDAv_aAdg_Nz567tYJv5fPVbUGy0NnuXP0gPZqS2xZ0p4jcGNhyTeVdIlkApAjmBK04vmWd6OuvxynsTGCBmdyMeVCQmjpkd-DOUYr3n7-rFdLNzW_2bCc7WSeYZ2jBOTf7Bnr21vD4CymQd7F3eAp2rY96Y0COekgBNjOcpOlAhTEmk8TgruYdNa4el_9f9cdQ7rJPloLZAFtSSKM7qIdk-a6zYP1whX_Z4zVJaB9N11CFFpLkdCkGE","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 09:53:29.273 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2020-05-02 09:53:29.280 +01:00 [DBG] Scopes contains offline_access, consent is required
2020-05-02 09:53:29.280 +01:00 [INF] Showing consent: User has not yet consented
2020-05-02 09:53:29.296 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 09:53:29.298 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 09:53:29.298 +01:00 [DBG] No PKCE used.
2020-05-02 09:53:29.312 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 09:53:30.573 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-05-02 09:53:30.587 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 09:53:30.591 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 09:53:30.591 +01:00 [DBG] No PKCE used.
2020-05-02 09:53:30.607 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 09:53:30.634 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-05-02 09:53:30.634 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-05-02 09:53:30.634 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-05-02 09:53:30.634 +01:00 [DBG] Start authorize callback request
2020-05-02 09:53:30.636 +01:00 [DBG] User in authorize request: 2
2020-05-02 09:53:30.636 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 09:53:30.638 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 09:53:30.638 +01:00 [DBG] No PKCE used.
2020-05-02 09:53:30.653 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 09:53:30.653 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeJYXoL2Dvy2Tcvny-wT5qLJVMmHiyB3SpUo-t3GKYcsWRBzopHTwMoBpShRX2LJ9vfPIPjW63HUDAv_aAdg_Nz567tYJv5fPVbUGy0NnuXP0gPZqS2xZ0p4jcGNhyTeVdIlkApAjmBK04vmWd6OuvxynsTGCBmdyMeVCQmjpkd-DOUYr3n7-rFdLNzW_2bCc7WSeYZ2jBOTf7Bnr21vD4CymQd7F3eAp2rY96Y0COekgBNjOcpOlAhTEmk8TgruYdNa4el_9f9cdQ7rJPloLZAFtSSKM7qIdk-a6zYP1whX_Z4zVJaB9N11CFFpLkdCkGE","UiLocales":null,"Nonce":"637240064033801768.MGM0Yjk5YTEtZDlkYS00ZjBmLWE0ODAtNjhlZDk5MDkwNDlhYmNiMmNhNTctOGNiNy00M2NhLWE0MGYtYjQxYjc4MDY2OTAz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"f224fc7e0526c20d7c4f2bdc81344930","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240064033801768.MGM0Yjk5YTEtZDlkYS00ZjBmLWE0ODAtNjhlZDk5MDkwNDlhYmNiMmNhNTctOGNiNy00M2NhLWE0MGYtYjQxYjc4MDY2OTAz","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeJYXoL2Dvy2Tcvny-wT5qLJVMmHiyB3SpUo-t3GKYcsWRBzopHTwMoBpShRX2LJ9vfPIPjW63HUDAv_aAdg_Nz567tYJv5fPVbUGy0NnuXP0gPZqS2xZ0p4jcGNhyTeVdIlkApAjmBK04vmWd6OuvxynsTGCBmdyMeVCQmjpkd-DOUYr3n7-rFdLNzW_2bCc7WSeYZ2jBOTf7Bnr21vD4CymQd7F3eAp2rY96Y0COekgBNjOcpOlAhTEmk8TgruYdNa4el_9f9cdQ7rJPloLZAFtSSKM7qIdk-a6zYP1whX_Z4zVJaB9N11CFFpLkdCkGE","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 09:53:30.653 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2020-05-02 09:53:30.653 +01:00 [DBG] Scopes contains offline_access, consent is required
2020-05-02 09:53:30.657 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2020-05-02 09:53:30.657 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2020-05-02 09:53:30.660 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 2
2020-05-02 09:53:30.734 +01:00 [DBG] Creating Hybrid Flow response.
2020-05-02 09:53:30.751 +01:00 [DBG] Creating Implicit Flow response.
2020-05-02 09:53:30.757 +01:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2020-05-02 09:53:30.757 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2020-05-02 09:53:30.763 +01:00 [INF] Authorize endpoint response
{"SubjectId":"2","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeJYXoL2Dvy2Tcvny-wT5qLJVMmHiyB3SpUo-t3GKYcsWRBzopHTwMoBpShRX2LJ9vfPIPjW63HUDAv_aAdg_Nz567tYJv5fPVbUGy0NnuXP0gPZqS2xZ0p4jcGNhyTeVdIlkApAjmBK04vmWd6OuvxynsTGCBmdyMeVCQmjpkd-DOUYr3n7-rFdLNzW_2bCc7WSeYZ2jBOTf7Bnr21vD4CymQd7F3eAp2rY96Y0COekgBNjOcpOlAhTEmk8TgruYdNa4el_9f9cdQ7rJPloLZAFtSSKM7qIdk-a6zYP1whX_Z4zVJaB9N11CFFpLkdCkGE","Scope":"openid profile api1 offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-05-02 09:53:30.772 +01:00 [DBG] Augmenting SignInContext
2020-05-02 09:53:30.773 +01:00 [INF] AuthenticationScheme: idsrv signed in.
2020-05-02 09:53:30.871 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 09:53:30.871 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 09:53:30.871 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 09:53:30.871 +01:00 [DBG] Start token request.
2020-05-02 09:53:30.872 +01:00 [DBG] Start client validation
2020-05-02 09:53:30.872 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 09:53:30.872 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 09:53:30.872 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 09:53:30.872 +01:00 [DBG] Secret id found: mvc
2020-05-02 09:53:30.875 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 09:53:30.875 +01:00 [DBG] Client validation success
2020-05-02 09:53:30.875 +01:00 [DBG] Start token request validation
2020-05-02 09:53:30.881 +01:00 [DBG] Start validation of authorization code token request
2020-05-02 09:53:30.908 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2020-05-02 09:53:30.908 +01:00 [DBG] Validation of authorization code token request success
2020-05-02 09:53:30.908 +01:00 [INF] Token request validation success
{"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"565def8e2dc7c0c14284c0195bc24d3204d4416f69b3ea11ba4e9d6ae24ef4ea","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"565def8e2dc7c0c14284c0195bc24d3204d4416f69b3ea11ba4e9d6ae24ef4ea","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2020-05-02 09:53:30.921 +01:00 [DBG] Getting claims for access token for client: mvc
2020-05-02 09:53:30.921 +01:00 [DBG] Getting claims for access token for subject: 2
2020-05-02 09:53:30.921 +01:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 09:53:30.921 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 09:53:30.926 +01:00 [DBG] Creating refresh token
2020-05-02 09:53:30.926 +01:00 [DBG] Setting an absolute lifetime: 2592000
2020-05-02 09:53:30.950 +01:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2020-05-02 09:53:30.950 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2020-05-02 09:53:30.952 +01:00 [DBG] Token request success.
2020-05-02 09:53:30.959 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-05-02 09:53:30.960 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-05-02 09:53:30.960 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-05-02 09:53:30.965 +01:00 [DBG] Start userinfo request
2020-05-02 09:53:30.967 +01:00 [DBG] Bearer token found in header
2020-05-02 09:53:30.982 +01:00 [DBG] IsActive called from: AccessTokenValidation
2020-05-02 09:53:30.982 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-05-02 09:53:30.982 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1588409610,"exp":1588413210,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvc","sub":"2","auth_time":1588409609,"idp":"local","name":"Bob","website":"https://bob.com","scope":["openid","profile","api1","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-05-02 09:53:30.983 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2020-05-02 09:53:30.987 +01:00 [DBG] Creating userinfo response
2020-05-02 09:53:30.989 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 09:53:30.991 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 09:53:30.995 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2020-05-02 09:53:30.995 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 09:53:30.998 +01:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2020-05-02 09:53:30.998 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 09:53:30.998 +01:00 [INF] Profile service returned the following claim types: name website
2020-05-02 09:53:30.998 +01:00 [DBG] End userinfo request
2020-05-02 11:11:13.629 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 11:11:14.068 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 11:11:14.068 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 11:11:14.068 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 11:11:14.068 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 11:11:14.068 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 11:11:14.068 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 11:11:19.232 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 11:11:19.485 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 11:11:19.485 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 11:11:19.485 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 11:11:19.485 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 11:11:19.485 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 11:11:19.485 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 11:11:20.012 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 11:11:20.013 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 11:11:20.013 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 11:11:20.013 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 11:11:20.013 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 11:11:20.013 +01:00 [DBG] Error Url: /home/error
2020-05-02 11:11:20.013 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 11:11:20.033 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:11:20.037 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:11:20.037 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:11:20.040 +01:00 [DBG] Start discovery request
2020-05-02 11:11:39.318 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 11:11:39.654 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 11:11:39.654 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 11:11:39.655 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 11:11:39.655 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 11:11:39.655 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 11:11:39.655 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 11:11:40.247 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 11:11:40.248 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 11:11:40.248 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 11:11:40.248 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 11:11:40.248 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 11:11:40.248 +01:00 [DBG] Error Url: /home/error
2020-05-02 11:11:40.248 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 11:11:48.096 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:11:48.100 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:11:48.100 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:11:48.103 +01:00 [DBG] Start discovery request
2020-05-02 11:11:48.281 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:11:48.282 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:11:48.282 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:11:48.284 +01:00 [DBG] Start key discovery request
2020-05-02 11:13:00.923 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 11:13:01.381 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 11:13:01.381 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 11:13:01.381 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 11:13:01.381 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 11:13:01.381 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 11:13:01.382 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 11:13:02.203 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 11:13:02.205 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 11:13:02.205 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 11:13:02.205 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 11:13:02.205 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 11:13:02.205 +01:00 [DBG] Error Url: /home/error
2020-05-02 11:13:02.205 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 11:13:02.241 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:13:02.246 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:13:02.246 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:13:02.248 +01:00 [DBG] Start discovery request
2020-05-02 11:13:02.515 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:13:02.516 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:13:02.516 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:13:02.519 +01:00 [DBG] Start key discovery request
2020-05-02 11:13:02.731 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:13:02.735 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:13:02.735 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:13:02.740 +01:00 [DBG] Start token request.
2020-05-02 11:13:02.744 +01:00 [DBG] Start client validation
2020-05-02 11:13:02.748 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:13:02.751 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 11:13:02.762 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 11:13:02.762 +01:00 [DBG] Secret id found: ro.client
2020-05-02 11:13:02.836 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:13:02.836 +01:00 [DBG] Client validation success
2020-05-02 11:13:02.843 +01:00 [DBG] Start token request validation
2020-05-02 11:13:02.851 +01:00 [DBG] Start resource owner password token request validation
2020-05-02 11:13:02.927 +01:00 [DBG] IsActive called from: ResourceOwnerValidation
2020-05-02 11:13:02.928 +01:00 [DBG] Resource owner password token request validation success.
2020-05-02 11:13:02.937 +01:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"username":"alice","password":"***REDACTED***","scope":"api1","grant_type":"password","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:13:02.960 +01:00 [DBG] Getting claims for access token for client: ro.client
2020-05-02 11:13:02.960 +01:00 [DBG] Getting claims for access token for subject: 1
2020-05-02 11:13:02.965 +01:00 [DBG] Get profile called for subject 1 from client ro.client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:13:02.967 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:13:03.011 +01:00 [DBG] Token request success.
2020-05-02 11:13:03.182 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:13:03.182 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:13:03.182 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:13:03.182 +01:00 [DBG] Start discovery request
2020-05-02 11:13:03.275 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:13:03.276 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:13:03.276 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:13:03.276 +01:00 [DBG] Start key discovery request
2020-05-02 11:14:19.226 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 11:14:19.660 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 11:14:19.660 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 11:14:19.661 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 11:14:19.661 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 11:14:19.661 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 11:14:19.661 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 11:14:20.317 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 11:14:20.318 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 11:14:20.318 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 11:14:20.318 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 11:14:20.318 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 11:14:20.318 +01:00 [DBG] Error Url: /home/error
2020-05-02 11:14:20.318 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 11:14:20.350 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:14:20.356 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:14:20.356 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:14:20.359 +01:00 [DBG] Start discovery request
2020-05-02 11:14:20.601 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:14:20.602 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:14:20.602 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:14:20.604 +01:00 [DBG] Start key discovery request
2020-05-02 11:14:20.803 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:14:20.807 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:14:20.807 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:14:20.813 +01:00 [DBG] Start token request.
2020-05-02 11:14:20.817 +01:00 [DBG] Start client validation
2020-05-02 11:14:20.821 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:14:20.823 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 11:14:20.838 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 11:14:20.838 +01:00 [DBG] Secret id found: ro.client
2020-05-02 11:14:20.909 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:14:20.909 +01:00 [DBG] Client validation success
2020-05-02 11:14:20.916 +01:00 [DBG] Start token request validation
2020-05-02 11:14:20.925 +01:00 [DBG] Start resource owner password token request validation
2020-05-02 11:14:21.001 +01:00 [DBG] IsActive called from: ResourceOwnerValidation
2020-05-02 11:14:21.002 +01:00 [DBG] Resource owner password token request validation success.
2020-05-02 11:14:21.011 +01:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"username":"alice","password":"***REDACTED***","scope":"api1","grant_type":"password","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:14:21.034 +01:00 [DBG] Getting claims for access token for client: ro.client
2020-05-02 11:14:21.034 +01:00 [DBG] Getting claims for access token for subject: 1
2020-05-02 11:14:21.039 +01:00 [DBG] Get profile called for subject 1 from client ro.client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:14:21.042 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:14:21.087 +01:00 [DBG] Token request success.
2020-05-02 11:14:21.261 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:14:21.262 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:14:21.262 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:14:21.262 +01:00 [DBG] Start discovery request
2020-05-02 11:14:21.363 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:14:21.363 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:14:21.363 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:14:21.363 +01:00 [DBG] Start key discovery request
2020-05-02 11:15:48.741 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 11:15:49.127 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 11:15:49.127 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 11:15:49.128 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 11:15:49.128 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 11:15:49.128 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 11:15:49.128 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 11:15:49.870 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 11:15:49.872 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 11:15:49.872 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 11:15:49.872 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 11:15:49.872 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 11:15:49.872 +01:00 [DBG] Error Url: /home/error
2020-05-02 11:15:49.872 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 11:15:49.897 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:15:49.901 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:15:49.902 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:15:49.904 +01:00 [DBG] Start discovery request
2020-05-02 11:15:50.155 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:15:50.155 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:15:50.155 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:15:50.158 +01:00 [DBG] Start key discovery request
2020-05-02 11:15:50.354 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:15:50.358 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:15:50.358 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:15:50.363 +01:00 [DBG] Start token request.
2020-05-02 11:15:50.367 +01:00 [DBG] Start client validation
2020-05-02 11:15:50.371 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:15:50.374 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 11:15:50.385 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 11:15:50.385 +01:00 [DBG] Secret id found: ro.client
2020-05-02 11:15:50.456 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:15:50.456 +01:00 [DBG] Client validation success
2020-05-02 11:15:50.465 +01:00 [DBG] Start token request validation
2020-05-02 11:15:50.477 +01:00 [DBG] Start resource owner password token request validation
2020-05-02 11:15:50.561 +01:00 [DBG] IsActive called from: ResourceOwnerValidation
2020-05-02 11:15:50.561 +01:00 [DBG] Resource owner password token request validation success.
2020-05-02 11:15:50.571 +01:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"username":"alice","password":"***REDACTED***","scope":"api1","grant_type":"password","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:15:50.594 +01:00 [DBG] Getting claims for access token for client: ro.client
2020-05-02 11:15:50.594 +01:00 [DBG] Getting claims for access token for subject: 1
2020-05-02 11:15:50.599 +01:00 [DBG] Get profile called for subject 1 from client ro.client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:15:50.602 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:15:50.647 +01:00 [DBG] Token request success.
2020-05-02 11:15:50.820 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:15:50.820 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:15:50.821 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:15:50.821 +01:00 [DBG] Start discovery request
2020-05-02 11:15:50.917 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:15:50.918 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:15:50.918 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:15:50.918 +01:00 [DBG] Start key discovery request
2020-05-02 11:26:49.599 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 11:26:49.980 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 11:26:49.980 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 11:26:49.980 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 11:26:49.980 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 11:26:49.980 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 11:26:49.980 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 11:26:50.682 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 11:26:50.686 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 11:26:50.686 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 11:26:50.686 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 11:26:50.686 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 11:26:50.686 +01:00 [DBG] Error Url: /home/error
2020-05-02 11:26:50.686 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 11:26:50.711 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:26:50.717 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:26:50.717 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:26:50.720 +01:00 [DBG] Start discovery request
2020-05-02 11:26:50.953 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:26:50.953 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:26:50.953 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:26:50.956 +01:00 [DBG] Start key discovery request
2020-05-02 11:26:51.190 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:26:51.194 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:26:51.194 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:26:51.201 +01:00 [DBG] Start token request.
2020-05-02 11:26:51.205 +01:00 [DBG] Start client validation
2020-05-02 11:26:51.210 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:26:51.215 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 11:26:51.226 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 11:26:51.226 +01:00 [DBG] Secret id found: ro.client
2020-05-02 11:26:51.301 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:26:51.301 +01:00 [DBG] Client validation success
2020-05-02 11:26:51.308 +01:00 [DBG] Start token request validation
2020-05-02 11:26:51.317 +01:00 [DBG] Start resource owner password token request validation
2020-05-02 11:26:51.400 +01:00 [DBG] IsActive called from: ResourceOwnerValidation
2020-05-02 11:26:51.401 +01:00 [DBG] Resource owner password token request validation success.
2020-05-02 11:26:51.411 +01:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"username":"alice","password":"***REDACTED***","scope":"api1","grant_type":"password","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:26:51.443 +01:00 [DBG] Getting claims for access token for client: ro.client
2020-05-02 11:26:51.444 +01:00 [DBG] Getting claims for access token for subject: 1
2020-05-02 11:26:51.450 +01:00 [DBG] Get profile called for subject 1 from client ro.client with claim types [] via ClaimsProviderAccessToken
2020-05-02 11:26:51.452 +01:00 [DBG] Issued claims: []
2020-05-02 11:26:51.495 +01:00 [DBG] Token request success.
2020-05-02 11:27:03.145 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 11:27:03.514 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 11:27:03.514 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 11:27:03.514 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 11:27:03.514 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 11:27:03.514 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 11:27:03.514 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 11:27:04.206 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 11:27:04.207 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 11:27:04.207 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 11:27:04.207 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 11:27:04.207 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 11:27:04.208 +01:00 [DBG] Error Url: /home/error
2020-05-02 11:27:04.208 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 11:27:04.232 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:27:04.236 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:27:04.237 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:27:04.239 +01:00 [DBG] Start discovery request
2020-05-02 11:27:04.513 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:27:04.513 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:27:04.514 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:27:04.517 +01:00 [DBG] Start key discovery request
2020-05-02 11:27:04.725 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:27:04.729 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:27:04.729 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:27:04.735 +01:00 [DBG] Start token request.
2020-05-02 11:27:04.739 +01:00 [DBG] Start client validation
2020-05-02 11:27:04.743 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:27:04.747 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 11:27:04.758 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 11:27:04.758 +01:00 [DBG] Secret id found: ro.client
2020-05-02 11:27:04.831 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:27:04.832 +01:00 [DBG] Client validation success
2020-05-02 11:27:04.838 +01:00 [DBG] Start token request validation
2020-05-02 11:27:04.846 +01:00 [DBG] Start resource owner password token request validation
2020-05-02 11:27:04.926 +01:00 [DBG] IsActive called from: ResourceOwnerValidation
2020-05-02 11:27:04.926 +01:00 [DBG] Resource owner password token request validation success.
2020-05-02 11:27:04.935 +01:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"username":"alice","password":"***REDACTED***","scope":"api1","grant_type":"password","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:27:04.957 +01:00 [DBG] Getting claims for access token for client: ro.client
2020-05-02 11:27:04.958 +01:00 [DBG] Getting claims for access token for subject: 1
2020-05-02 11:27:04.962 +01:00 [DBG] Get profile called for subject 1 from client ro.client with claim types [] via ClaimsProviderAccessToken
2020-05-02 11:27:04.963 +01:00 [DBG] Issued claims: []
2020-05-02 11:27:05.009 +01:00 [DBG] Token request success.
2020-05-02 11:27:05.177 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:27:05.177 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:27:05.177 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:27:05.178 +01:00 [DBG] Start discovery request
2020-05-02 11:27:05.273 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:27:05.273 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:27:05.273 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:27:05.273 +01:00 [DBG] Start key discovery request
2020-05-02 11:27:10.496 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:27:10.497 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:27:10.497 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:27:10.497 +01:00 [DBG] Start discovery request
2020-05-02 11:27:10.581 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:27:10.581 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:27:10.581 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:27:10.581 +01:00 [DBG] Start key discovery request
2020-05-02 11:27:10.610 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-05-02 11:27:10.611 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-05-02 11:27:10.611 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-05-02 11:27:10.614 +01:00 [DBG] Start authorize request
2020-05-02 11:27:10.619 +01:00 [DBG] No user present in authorize request
2020-05-02 11:27:10.623 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:27:10.632 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:27:10.633 +01:00 [DBG] No PKCE used.
2020-05-02 11:27:10.657 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:27:10.659 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeLMcQ5lZfAvpAarCux2OAOlJh1dPsYOrlFxfO-VH56hsGuZ91OW2neqykbgoj69NQb7OXK5dtObMSu8ipaqQEFeQVOCRGXe1WTFoe9wxl_mwNbBnGYY8fQmJv0r0GnS5fwLYH8WRvOg4_9KUBMfxEDqCvJr2CI594FO3XmUb1GegIJGiAWjiM-sIH9zbLMOiCj-GzWdaiSQYEFXulWvLm9IzlhF6Cw4gneSreJWwKjKAuGMwWGGFCmMt7zz8guVqWsbqcDXjxOJeFcKYGXejKASttvfS4Z-wRqgiJw0kCgOFOqNXQyrhOM4c0ExEldulvI","UiLocales":null,"Nonce":"637240120305926228.NGRmMjU0OGItMmU4Ny00YzIzLTk5ZjQtNGEzYjQ2YzhjZWQzM2RlMTMyNzctZGI5Yy00NGNiLThjMGUtYWE3NzVjMjkwN2I3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240120305926228.NGRmMjU0OGItMmU4Ny00YzIzLTk5ZjQtNGEzYjQ2YzhjZWQzM2RlMTMyNzctZGI5Yy00NGNiLThjMGUtYWE3NzVjMjkwN2I3","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeLMcQ5lZfAvpAarCux2OAOlJh1dPsYOrlFxfO-VH56hsGuZ91OW2neqykbgoj69NQb7OXK5dtObMSu8ipaqQEFeQVOCRGXe1WTFoe9wxl_mwNbBnGYY8fQmJv0r0GnS5fwLYH8WRvOg4_9KUBMfxEDqCvJr2CI594FO3XmUb1GegIJGiAWjiM-sIH9zbLMOiCj-GzWdaiSQYEFXulWvLm9IzlhF6Cw4gneSreJWwKjKAuGMwWGGFCmMt7zz8guVqWsbqcDXjxOJeFcKYGXejKASttvfS4Z-wRqgiJw0kCgOFOqNXQyrhOM4c0ExEldulvI","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 11:27:10.665 +01:00 [INF] Showing login: User is not authenticated
2020-05-02 11:27:10.705 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:27:10.708 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:27:10.708 +01:00 [DBG] No PKCE used.
2020-05-02 11:27:10.722 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:27:20.025 +01:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-05-02 11:27:20.041 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:27:20.044 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:27:20.044 +01:00 [DBG] No PKCE used.
2020-05-02 11:27:20.060 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:27:20.071 +01:00 [DBG] Augmenting SignInContext
2020-05-02 11:27:20.073 +01:00 [DBG] Adding idp claim with value: local
2020-05-02 11:27:20.073 +01:00 [DBG] Adding amr claim with value: pwd
2020-05-02 11:27:20.082 +01:00 [INF] AuthenticationScheme: idsrv signed in.
2020-05-02 11:27:20.092 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-05-02 11:27:20.093 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-05-02 11:27:20.093 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-05-02 11:27:20.097 +01:00 [DBG] Start authorize callback request
2020-05-02 11:27:20.100 +01:00 [DBG] User in authorize request: 2
2020-05-02 11:27:20.100 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:27:20.103 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:27:20.103 +01:00 [DBG] No PKCE used.
2020-05-02 11:27:20.120 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:27:20.120 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeLMcQ5lZfAvpAarCux2OAOlJh1dPsYOrlFxfO-VH56hsGuZ91OW2neqykbgoj69NQb7OXK5dtObMSu8ipaqQEFeQVOCRGXe1WTFoe9wxl_mwNbBnGYY8fQmJv0r0GnS5fwLYH8WRvOg4_9KUBMfxEDqCvJr2CI594FO3XmUb1GegIJGiAWjiM-sIH9zbLMOiCj-GzWdaiSQYEFXulWvLm9IzlhF6Cw4gneSreJWwKjKAuGMwWGGFCmMt7zz8guVqWsbqcDXjxOJeFcKYGXejKASttvfS4Z-wRqgiJw0kCgOFOqNXQyrhOM4c0ExEldulvI","UiLocales":null,"Nonce":"637240120305926228.NGRmMjU0OGItMmU4Ny00YzIzLTk5ZjQtNGEzYjQ2YzhjZWQzM2RlMTMyNzctZGI5Yy00NGNiLThjMGUtYWE3NzVjMjkwN2I3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"96a556a1089674ccfcf58291d409acc8","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240120305926228.NGRmMjU0OGItMmU4Ny00YzIzLTk5ZjQtNGEzYjQ2YzhjZWQzM2RlMTMyNzctZGI5Yy00NGNiLThjMGUtYWE3NzVjMjkwN2I3","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeLMcQ5lZfAvpAarCux2OAOlJh1dPsYOrlFxfO-VH56hsGuZ91OW2neqykbgoj69NQb7OXK5dtObMSu8ipaqQEFeQVOCRGXe1WTFoe9wxl_mwNbBnGYY8fQmJv0r0GnS5fwLYH8WRvOg4_9KUBMfxEDqCvJr2CI594FO3XmUb1GegIJGiAWjiM-sIH9zbLMOiCj-GzWdaiSQYEFXulWvLm9IzlhF6Cw4gneSreJWwKjKAuGMwWGGFCmMt7zz8guVqWsbqcDXjxOJeFcKYGXejKASttvfS4Z-wRqgiJw0kCgOFOqNXQyrhOM4c0ExEldulvI","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 11:27:20.120 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2020-05-02 11:27:20.126 +01:00 [DBG] Scopes contains offline_access, consent is required
2020-05-02 11:27:20.126 +01:00 [INF] Showing consent: User has not yet consented
2020-05-02 11:27:20.143 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:27:20.145 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:27:20.145 +01:00 [DBG] No PKCE used.
2020-05-02 11:27:20.159 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:27:21.711 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-05-02 11:27:21.729 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:27:21.731 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:27:21.732 +01:00 [DBG] No PKCE used.
2020-05-02 11:27:21.747 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:27:21.763 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-05-02 11:27:21.763 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-05-02 11:27:21.763 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-05-02 11:27:21.763 +01:00 [DBG] Start authorize callback request
2020-05-02 11:27:21.767 +01:00 [DBG] User in authorize request: 2
2020-05-02 11:27:21.767 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:27:21.770 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:27:21.770 +01:00 [DBG] No PKCE used.
2020-05-02 11:27:21.785 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:27:21.785 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeLMcQ5lZfAvpAarCux2OAOlJh1dPsYOrlFxfO-VH56hsGuZ91OW2neqykbgoj69NQb7OXK5dtObMSu8ipaqQEFeQVOCRGXe1WTFoe9wxl_mwNbBnGYY8fQmJv0r0GnS5fwLYH8WRvOg4_9KUBMfxEDqCvJr2CI594FO3XmUb1GegIJGiAWjiM-sIH9zbLMOiCj-GzWdaiSQYEFXulWvLm9IzlhF6Cw4gneSreJWwKjKAuGMwWGGFCmMt7zz8guVqWsbqcDXjxOJeFcKYGXejKASttvfS4Z-wRqgiJw0kCgOFOqNXQyrhOM4c0ExEldulvI","UiLocales":null,"Nonce":"637240120305926228.NGRmMjU0OGItMmU4Ny00YzIzLTk5ZjQtNGEzYjQ2YzhjZWQzM2RlMTMyNzctZGI5Yy00NGNiLThjMGUtYWE3NzVjMjkwN2I3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"96a556a1089674ccfcf58291d409acc8","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240120305926228.NGRmMjU0OGItMmU4Ny00YzIzLTk5ZjQtNGEzYjQ2YzhjZWQzM2RlMTMyNzctZGI5Yy00NGNiLThjMGUtYWE3NzVjMjkwN2I3","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeLMcQ5lZfAvpAarCux2OAOlJh1dPsYOrlFxfO-VH56hsGuZ91OW2neqykbgoj69NQb7OXK5dtObMSu8ipaqQEFeQVOCRGXe1WTFoe9wxl_mwNbBnGYY8fQmJv0r0GnS5fwLYH8WRvOg4_9KUBMfxEDqCvJr2CI594FO3XmUb1GegIJGiAWjiM-sIH9zbLMOiCj-GzWdaiSQYEFXulWvLm9IzlhF6Cw4gneSreJWwKjKAuGMwWGGFCmMt7zz8guVqWsbqcDXjxOJeFcKYGXejKASttvfS4Z-wRqgiJw0kCgOFOqNXQyrhOM4c0ExEldulvI","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 11:27:21.785 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2020-05-02 11:27:21.785 +01:00 [DBG] Scopes contains offline_access, consent is required
2020-05-02 11:27:21.789 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2020-05-02 11:27:21.790 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2020-05-02 11:27:21.792 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 2
2020-05-02 11:27:21.859 +01:00 [DBG] Creating Hybrid Flow response.
2020-05-02 11:27:21.876 +01:00 [DBG] Creating Implicit Flow response.
2020-05-02 11:27:21.883 +01:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2020-05-02 11:27:21.883 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2020-05-02 11:27:21.889 +01:00 [INF] Authorize endpoint response
{"SubjectId":"2","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeLMcQ5lZfAvpAarCux2OAOlJh1dPsYOrlFxfO-VH56hsGuZ91OW2neqykbgoj69NQb7OXK5dtObMSu8ipaqQEFeQVOCRGXe1WTFoe9wxl_mwNbBnGYY8fQmJv0r0GnS5fwLYH8WRvOg4_9KUBMfxEDqCvJr2CI594FO3XmUb1GegIJGiAWjiM-sIH9zbLMOiCj-GzWdaiSQYEFXulWvLm9IzlhF6Cw4gneSreJWwKjKAuGMwWGGFCmMt7zz8guVqWsbqcDXjxOJeFcKYGXejKASttvfS4Z-wRqgiJw0kCgOFOqNXQyrhOM4c0ExEldulvI","Scope":"openid profile api1 offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-05-02 11:27:21.902 +01:00 [DBG] Augmenting SignInContext
2020-05-02 11:27:21.902 +01:00 [INF] AuthenticationScheme: idsrv signed in.
2020-05-02 11:27:22.004 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:27:22.005 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:27:22.005 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:27:22.005 +01:00 [DBG] Start token request.
2020-05-02 11:27:22.005 +01:00 [DBG] Start client validation
2020-05-02 11:27:22.005 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:27:22.005 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 11:27:22.005 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 11:27:22.005 +01:00 [DBG] Secret id found: mvc
2020-05-02 11:27:22.008 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:27:22.008 +01:00 [DBG] Client validation success
2020-05-02 11:27:22.008 +01:00 [DBG] Start token request validation
2020-05-02 11:27:22.014 +01:00 [DBG] Start validation of authorization code token request
2020-05-02 11:27:22.041 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2020-05-02 11:27:22.041 +01:00 [DBG] Validation of authorization code token request success
2020-05-02 11:27:22.041 +01:00 [INF] Token request validation success
{"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"22c0a0a4c15808b26fac9159de9b3f36b0107d593c279ea9f6b8aace98c2cbd7","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"22c0a0a4c15808b26fac9159de9b3f36b0107d593c279ea9f6b8aace98c2cbd7","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:27:22.054 +01:00 [DBG] Getting claims for access token for client: mvc
2020-05-02 11:27:22.054 +01:00 [DBG] Getting claims for access token for subject: 2
2020-05-02 11:27:22.054 +01:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types [] via ClaimsProviderAccessToken
2020-05-02 11:27:22.054 +01:00 [DBG] Issued claims: []
2020-05-02 11:27:22.059 +01:00 [DBG] Creating refresh token
2020-05-02 11:27:22.059 +01:00 [DBG] Setting an absolute lifetime: 2592000
2020-05-02 11:27:22.079 +01:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2020-05-02 11:27:22.080 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2020-05-02 11:27:22.082 +01:00 [DBG] Token request success.
2020-05-02 11:27:22.093 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-05-02 11:27:22.094 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-05-02 11:27:22.094 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-05-02 11:27:22.098 +01:00 [DBG] Start userinfo request
2020-05-02 11:27:22.100 +01:00 [DBG] Bearer token found in header
2020-05-02 11:27:22.124 +01:00 [DBG] IsActive called from: AccessTokenValidation
2020-05-02 11:27:22.124 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-05-02 11:27:22.125 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1588415242,"exp":1588418842,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvc","sub":"2","auth_time":1588415240,"idp":"local","scope":["openid","profile","api1","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-05-02 11:27:22.126 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2020-05-02 11:27:22.130 +01:00 [DBG] Creating userinfo response
2020-05-02 11:27:22.133 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:27:22.134 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:27:22.138 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2020-05-02 11:27:22.138 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:27:22.141 +01:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2020-05-02 11:27:22.142 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:27:22.142 +01:00 [INF] Profile service returned the following claim types: name website
2020-05-02 11:27:22.142 +01:00 [DBG] End userinfo request
2020-05-02 11:29:21.560 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 11:29:21.950 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 11:29:21.950 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 11:29:21.950 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 11:29:21.950 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 11:29:21.950 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 11:29:21.950 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 11:29:22.509 +01:00 [FTL] Application startup exception
System.Exception: Mongo Repository created/populated! Please restart you website, so Mongo driver will be configured  to ignore Extra Elements - e.g. IdentityServer "_id" 
   at IdentityServer.Startup.InitializeDatabase(IApplicationBuilder app) in C:\othersrc\IdentityServer4.Samples.Mongo\IdentityServer4-Samples\7_EntityFrameworkStorage-mongo\src\IdentityServer\Startup.cs:line 165
   at IdentityServer.Startup.Configure(IApplicationBuilder app, IHostingEnvironment env) in C:\othersrc\IdentityServer4.Samples.Mongo\IdentityServer4-Samples\7_EntityFrameworkStorage-mongo\src\IdentityServer\Startup.cs:line 118
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)
   at Microsoft.AspNetCore.Mvc.Internal.MiddlewareFilterBuilderStartupFilter.<>c__DisplayClass0_0.<Configure>g__MiddlewareFilterBuilder|0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Server.IISIntegration.IISSetupFilter.<>c__DisplayClass4_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()
2020-05-02 11:29:22.829 +01:00 [ERR] Connection id "0HLVEGEN3N828", Request id "0HLVEGEN3N828:00000001": An unhandled exception was thrown by the application.
System.ArgumentOutOfRangeException: Index and count must refer to a location within the buffer.
Parameter name: chars
   at System.Text.EncoderNLS.GetBytes(Char[] chars, Int32 charIndex, Int32 charCount, Byte[] bytes, Int32 byteIndex, Boolean flush)
   at System.IO.StreamWriter.Flush(Boolean flushStream, Boolean flushEncoder)
   at System.IO.StreamWriter.Write(String value)
   at Microsoft.Extensions.RazorViews.BaseView.EndWriteAttribute()
   at Microsoft.AspNetCore.Hosting.Views.ErrorPage.ExecuteAsync()
   at Microsoft.Extensions.RazorViews.BaseView.ExecuteAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2020-05-02 11:29:32.826 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 11:29:33.192 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 11:29:33.192 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 11:29:33.192 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 11:29:33.192 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 11:29:33.192 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 11:29:33.192 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 11:29:33.829 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 11:29:33.830 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 11:29:33.830 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 11:29:33.830 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 11:29:33.830 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 11:29:33.830 +01:00 [DBG] Error Url: /home/error
2020-05-02 11:29:33.830 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 11:29:33.856 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:29:33.861 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:29:33.861 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:29:33.863 +01:00 [DBG] Start discovery request
2020-05-02 11:29:34.113 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:29:34.114 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:29:34.114 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:29:34.117 +01:00 [DBG] Start key discovery request
2020-05-02 11:29:34.317 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:29:34.323 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:29:34.323 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:29:34.329 +01:00 [DBG] Start token request.
2020-05-02 11:29:34.333 +01:00 [DBG] Start client validation
2020-05-02 11:29:34.338 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:29:34.341 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 11:29:34.353 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 11:29:34.353 +01:00 [DBG] Secret id found: ro.client
2020-05-02 11:29:34.424 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:29:34.424 +01:00 [DBG] Client validation success
2020-05-02 11:29:34.430 +01:00 [DBG] Start token request validation
2020-05-02 11:29:34.438 +01:00 [DBG] Start resource owner password token request validation
2020-05-02 11:29:34.512 +01:00 [DBG] IsActive called from: ResourceOwnerValidation
2020-05-02 11:29:34.512 +01:00 [DBG] Resource owner password token request validation success.
2020-05-02 11:29:34.521 +01:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"username":"alice","password":"***REDACTED***","scope":"api1","grant_type":"password","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:29:34.545 +01:00 [DBG] Getting claims for access token for client: ro.client
2020-05-02 11:29:34.546 +01:00 [DBG] Getting claims for access token for subject: 1
2020-05-02 11:29:34.550 +01:00 [DBG] Get profile called for subject 1 from client ro.client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:29:34.553 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:29:34.598 +01:00 [DBG] Token request success.
2020-05-02 11:29:34.790 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:29:34.791 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:29:34.791 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:29:34.791 +01:00 [DBG] Start discovery request
2020-05-02 11:29:34.885 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:29:34.885 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:29:34.885 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:29:34.885 +01:00 [DBG] Start key discovery request
2020-05-02 11:29:35.430 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:29:35.430 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:29:35.430 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:29:35.430 +01:00 [DBG] Start discovery request
2020-05-02 11:29:35.514 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:29:35.514 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:29:35.514 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:29:35.514 +01:00 [DBG] Start key discovery request
2020-05-02 11:29:35.545 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-05-02 11:29:35.547 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-05-02 11:29:35.547 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-05-02 11:29:35.549 +01:00 [DBG] Start authorize request
2020-05-02 11:29:35.554 +01:00 [DBG] No user present in authorize request
2020-05-02 11:29:35.558 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:29:35.567 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:29:35.568 +01:00 [DBG] No PKCE used.
2020-05-02 11:29:35.592 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:29:35.594 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeJVJuil1XsUXdgOqNU6Lo0Rv1GFjcs1AAWtNT19ZKPyperTfgAe23Rw88p0YSlGtGildUFDxXdWnoFiWmPBWFum189H4t2ZeTKPeZcnwSzqpooriIMSMg3Ghh7sropG_bIsUf-r5evHJQFJiQmw0Hl_CBgu59SWS2rNmMvj2ZzLIcTkjTGTR2pptejvhQOEp5L9tOeE8U-CEuYYcwuffu9wXgCvOgrdDali3V9XkfY8AIfuhlYPb2KI-I8nYkhOCpd4abhsS3oG5jmHX_mO7ww9u1FduQdWI-uCL7-zD46lQFSx6QG1jnAK1C9r24iX0Mo","UiLocales":null,"Nonce":"637240121755255107.MWU1Y2IxNjEtYjk5ZS00OWE4LThkZDktNDYwNmZjNzg4MDcwOWY0Mzg4ZTYtZTUxOC00ZjNlLTk2MDMtMGQwMTZjNzMwMmUy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240121755255107.MWU1Y2IxNjEtYjk5ZS00OWE4LThkZDktNDYwNmZjNzg4MDcwOWY0Mzg4ZTYtZTUxOC00ZjNlLTk2MDMtMGQwMTZjNzMwMmUy","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeJVJuil1XsUXdgOqNU6Lo0Rv1GFjcs1AAWtNT19ZKPyperTfgAe23Rw88p0YSlGtGildUFDxXdWnoFiWmPBWFum189H4t2ZeTKPeZcnwSzqpooriIMSMg3Ghh7sropG_bIsUf-r5evHJQFJiQmw0Hl_CBgu59SWS2rNmMvj2ZzLIcTkjTGTR2pptejvhQOEp5L9tOeE8U-CEuYYcwuffu9wXgCvOgrdDali3V9XkfY8AIfuhlYPb2KI-I8nYkhOCpd4abhsS3oG5jmHX_mO7ww9u1FduQdWI-uCL7-zD46lQFSx6QG1jnAK1C9r24iX0Mo","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 11:29:35.600 +01:00 [INF] Showing login: User is not authenticated
2020-05-02 11:29:35.641 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:29:35.644 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:29:35.644 +01:00 [DBG] No PKCE used.
2020-05-02 11:29:35.657 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:29:41.819 +01:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-05-02 11:29:41.839 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:29:41.841 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:29:41.841 +01:00 [DBG] No PKCE used.
2020-05-02 11:29:41.857 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:29:41.868 +01:00 [DBG] Augmenting SignInContext
2020-05-02 11:29:41.870 +01:00 [DBG] Adding idp claim with value: local
2020-05-02 11:29:41.870 +01:00 [DBG] Adding amr claim with value: pwd
2020-05-02 11:29:41.879 +01:00 [INF] AuthenticationScheme: idsrv signed in.
2020-05-02 11:29:41.888 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-05-02 11:29:41.889 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-05-02 11:29:41.889 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-05-02 11:29:41.893 +01:00 [DBG] Start authorize callback request
2020-05-02 11:29:41.895 +01:00 [DBG] User in authorize request: 2
2020-05-02 11:29:41.895 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:29:41.898 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:29:41.898 +01:00 [DBG] No PKCE used.
2020-05-02 11:29:41.912 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:29:41.912 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeJVJuil1XsUXdgOqNU6Lo0Rv1GFjcs1AAWtNT19ZKPyperTfgAe23Rw88p0YSlGtGildUFDxXdWnoFiWmPBWFum189H4t2ZeTKPeZcnwSzqpooriIMSMg3Ghh7sropG_bIsUf-r5evHJQFJiQmw0Hl_CBgu59SWS2rNmMvj2ZzLIcTkjTGTR2pptejvhQOEp5L9tOeE8U-CEuYYcwuffu9wXgCvOgrdDali3V9XkfY8AIfuhlYPb2KI-I8nYkhOCpd4abhsS3oG5jmHX_mO7ww9u1FduQdWI-uCL7-zD46lQFSx6QG1jnAK1C9r24iX0Mo","UiLocales":null,"Nonce":"637240121755255107.MWU1Y2IxNjEtYjk5ZS00OWE4LThkZDktNDYwNmZjNzg4MDcwOWY0Mzg4ZTYtZTUxOC00ZjNlLTk2MDMtMGQwMTZjNzMwMmUy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"ac065466c0092689f308db66e51a614c","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240121755255107.MWU1Y2IxNjEtYjk5ZS00OWE4LThkZDktNDYwNmZjNzg4MDcwOWY0Mzg4ZTYtZTUxOC00ZjNlLTk2MDMtMGQwMTZjNzMwMmUy","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeJVJuil1XsUXdgOqNU6Lo0Rv1GFjcs1AAWtNT19ZKPyperTfgAe23Rw88p0YSlGtGildUFDxXdWnoFiWmPBWFum189H4t2ZeTKPeZcnwSzqpooriIMSMg3Ghh7sropG_bIsUf-r5evHJQFJiQmw0Hl_CBgu59SWS2rNmMvj2ZzLIcTkjTGTR2pptejvhQOEp5L9tOeE8U-CEuYYcwuffu9wXgCvOgrdDali3V9XkfY8AIfuhlYPb2KI-I8nYkhOCpd4abhsS3oG5jmHX_mO7ww9u1FduQdWI-uCL7-zD46lQFSx6QG1jnAK1C9r24iX0Mo","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 11:29:41.912 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2020-05-02 11:29:41.918 +01:00 [DBG] Scopes contains offline_access, consent is required
2020-05-02 11:29:41.918 +01:00 [INF] Showing consent: User has not yet consented
2020-05-02 11:29:41.937 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:29:41.939 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:29:41.939 +01:00 [DBG] No PKCE used.
2020-05-02 11:29:41.955 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:29:43.486 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-05-02 11:29:43.498 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:29:43.502 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:29:43.502 +01:00 [DBG] No PKCE used.
2020-05-02 11:29:43.519 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:29:43.535 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-05-02 11:29:43.536 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-05-02 11:29:43.536 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-05-02 11:29:43.536 +01:00 [DBG] Start authorize callback request
2020-05-02 11:29:43.538 +01:00 [DBG] User in authorize request: 2
2020-05-02 11:29:43.538 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:29:43.541 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:29:43.541 +01:00 [DBG] No PKCE used.
2020-05-02 11:29:43.555 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:29:43.556 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeJVJuil1XsUXdgOqNU6Lo0Rv1GFjcs1AAWtNT19ZKPyperTfgAe23Rw88p0YSlGtGildUFDxXdWnoFiWmPBWFum189H4t2ZeTKPeZcnwSzqpooriIMSMg3Ghh7sropG_bIsUf-r5evHJQFJiQmw0Hl_CBgu59SWS2rNmMvj2ZzLIcTkjTGTR2pptejvhQOEp5L9tOeE8U-CEuYYcwuffu9wXgCvOgrdDali3V9XkfY8AIfuhlYPb2KI-I8nYkhOCpd4abhsS3oG5jmHX_mO7ww9u1FduQdWI-uCL7-zD46lQFSx6QG1jnAK1C9r24iX0Mo","UiLocales":null,"Nonce":"637240121755255107.MWU1Y2IxNjEtYjk5ZS00OWE4LThkZDktNDYwNmZjNzg4MDcwOWY0Mzg4ZTYtZTUxOC00ZjNlLTk2MDMtMGQwMTZjNzMwMmUy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"ac065466c0092689f308db66e51a614c","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240121755255107.MWU1Y2IxNjEtYjk5ZS00OWE4LThkZDktNDYwNmZjNzg4MDcwOWY0Mzg4ZTYtZTUxOC00ZjNlLTk2MDMtMGQwMTZjNzMwMmUy","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeJVJuil1XsUXdgOqNU6Lo0Rv1GFjcs1AAWtNT19ZKPyperTfgAe23Rw88p0YSlGtGildUFDxXdWnoFiWmPBWFum189H4t2ZeTKPeZcnwSzqpooriIMSMg3Ghh7sropG_bIsUf-r5evHJQFJiQmw0Hl_CBgu59SWS2rNmMvj2ZzLIcTkjTGTR2pptejvhQOEp5L9tOeE8U-CEuYYcwuffu9wXgCvOgrdDali3V9XkfY8AIfuhlYPb2KI-I8nYkhOCpd4abhsS3oG5jmHX_mO7ww9u1FduQdWI-uCL7-zD46lQFSx6QG1jnAK1C9r24iX0Mo","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 11:29:43.556 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2020-05-02 11:29:43.556 +01:00 [DBG] Scopes contains offline_access, consent is required
2020-05-02 11:29:43.560 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2020-05-02 11:29:43.560 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2020-05-02 11:29:43.562 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 2
2020-05-02 11:29:43.629 +01:00 [DBG] Creating Hybrid Flow response.
2020-05-02 11:29:43.646 +01:00 [DBG] Creating Implicit Flow response.
2020-05-02 11:29:43.652 +01:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2020-05-02 11:29:43.652 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2020-05-02 11:29:43.658 +01:00 [INF] Authorize endpoint response
{"SubjectId":"2","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeJVJuil1XsUXdgOqNU6Lo0Rv1GFjcs1AAWtNT19ZKPyperTfgAe23Rw88p0YSlGtGildUFDxXdWnoFiWmPBWFum189H4t2ZeTKPeZcnwSzqpooriIMSMg3Ghh7sropG_bIsUf-r5evHJQFJiQmw0Hl_CBgu59SWS2rNmMvj2ZzLIcTkjTGTR2pptejvhQOEp5L9tOeE8U-CEuYYcwuffu9wXgCvOgrdDali3V9XkfY8AIfuhlYPb2KI-I8nYkhOCpd4abhsS3oG5jmHX_mO7ww9u1FduQdWI-uCL7-zD46lQFSx6QG1jnAK1C9r24iX0Mo","Scope":"openid profile api1 offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-05-02 11:29:43.671 +01:00 [DBG] Augmenting SignInContext
2020-05-02 11:29:43.671 +01:00 [INF] AuthenticationScheme: idsrv signed in.
2020-05-02 11:29:43.772 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:29:43.773 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:29:43.774 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:29:43.774 +01:00 [DBG] Start token request.
2020-05-02 11:29:43.774 +01:00 [DBG] Start client validation
2020-05-02 11:29:43.774 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:29:43.774 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 11:29:43.774 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 11:29:43.774 +01:00 [DBG] Secret id found: mvc
2020-05-02 11:29:43.777 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:29:43.777 +01:00 [DBG] Client validation success
2020-05-02 11:29:43.777 +01:00 [DBG] Start token request validation
2020-05-02 11:29:43.783 +01:00 [DBG] Start validation of authorization code token request
2020-05-02 11:29:43.812 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2020-05-02 11:29:43.812 +01:00 [DBG] Validation of authorization code token request success
2020-05-02 11:29:43.812 +01:00 [INF] Token request validation success
{"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"639a3161b49303d8da33b7959c88d685ae2f7e95856876eaecdeaf01900f84b4","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"639a3161b49303d8da33b7959c88d685ae2f7e95856876eaecdeaf01900f84b4","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:29:43.828 +01:00 [DBG] Getting claims for access token for client: mvc
2020-05-02 11:29:43.828 +01:00 [DBG] Getting claims for access token for subject: 2
2020-05-02 11:29:43.828 +01:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:29:43.828 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:29:43.833 +01:00 [DBG] Creating refresh token
2020-05-02 11:29:43.833 +01:00 [DBG] Setting an absolute lifetime: 2592000
2020-05-02 11:29:43.854 +01:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2020-05-02 11:29:43.854 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2020-05-02 11:29:43.856 +01:00 [DBG] Token request success.
2020-05-02 11:29:43.868 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-05-02 11:29:43.869 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-05-02 11:29:43.869 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-05-02 11:29:43.873 +01:00 [DBG] Start userinfo request
2020-05-02 11:29:43.875 +01:00 [DBG] Bearer token found in header
2020-05-02 11:29:43.900 +01:00 [DBG] IsActive called from: AccessTokenValidation
2020-05-02 11:29:43.900 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-05-02 11:29:43.901 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1588415383,"exp":1588418983,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvc","sub":"2","auth_time":1588415381,"idp":"local","name":"Bob","website":"https://bob.com","scope":["openid","profile","api1","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-05-02 11:29:43.901 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2020-05-02 11:29:43.905 +01:00 [DBG] Creating userinfo response
2020-05-02 11:29:43.908 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:29:43.910 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:29:43.914 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2020-05-02 11:29:43.914 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:29:43.917 +01:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2020-05-02 11:29:43.917 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:29:43.917 +01:00 [INF] Profile service returned the following claim types: name website
2020-05-02 11:29:43.917 +01:00 [DBG] End userinfo request
2020-05-02 11:30:27.087 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 11:30:27.450 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 11:30:27.450 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 11:30:27.450 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 11:30:27.451 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 11:30:27.451 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 11:30:27.451 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 11:30:27.985 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 11:30:27.986 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 11:30:27.986 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 11:30:27.986 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 11:30:27.986 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 11:30:27.987 +01:00 [DBG] Error Url: /home/error
2020-05-02 11:30:27.987 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 11:30:28.015 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:30:28.020 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:30:28.020 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:30:28.023 +01:00 [DBG] Start discovery request
2020-05-02 11:30:28.289 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:30:28.289 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:30:28.289 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:30:28.292 +01:00 [DBG] Start key discovery request
2020-05-02 11:30:28.492 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:30:28.495 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:30:28.495 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:30:28.500 +01:00 [DBG] Start token request.
2020-05-02 11:30:28.505 +01:00 [DBG] Start client validation
2020-05-02 11:30:28.509 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:30:28.511 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 11:30:28.523 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 11:30:28.523 +01:00 [DBG] Secret id found: ro.client
2020-05-02 11:30:28.595 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:30:28.595 +01:00 [DBG] Client validation success
2020-05-02 11:30:28.601 +01:00 [DBG] Start token request validation
2020-05-02 11:30:28.610 +01:00 [DBG] Start resource owner password token request validation
2020-05-02 11:30:28.684 +01:00 [DBG] IsActive called from: ResourceOwnerValidation
2020-05-02 11:30:28.685 +01:00 [DBG] Resource owner password token request validation success.
2020-05-02 11:30:28.693 +01:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"username":"alice","password":"***REDACTED***","scope":"api1","grant_type":"password","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:30:28.716 +01:00 [DBG] Getting claims for access token for client: ro.client
2020-05-02 11:30:28.716 +01:00 [DBG] Getting claims for access token for subject: 1
2020-05-02 11:30:28.720 +01:00 [DBG] Get profile called for subject 1 from client ro.client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:30:28.723 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:30:28.767 +01:00 [DBG] Token request success.
2020-05-02 11:30:28.931 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:30:28.932 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:30:28.932 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:30:28.932 +01:00 [DBG] Start discovery request
2020-05-02 11:30:29.024 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:30:29.024 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:30:29.024 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:30:29.024 +01:00 [DBG] Start key discovery request
2020-05-02 11:31:12.775 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 11:31:13.142 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 11:31:13.142 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 11:31:13.142 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 11:31:13.142 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 11:31:13.142 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 11:31:13.142 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 11:31:13.750 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 11:31:13.751 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 11:31:13.751 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 11:31:13.751 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 11:31:13.751 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 11:31:13.751 +01:00 [DBG] Error Url: /home/error
2020-05-02 11:31:13.751 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 11:31:13.774 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:31:13.779 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:31:13.779 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:31:13.782 +01:00 [DBG] Start discovery request
2020-05-02 11:31:14.035 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:31:14.035 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:31:14.035 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:31:14.038 +01:00 [DBG] Start key discovery request
2020-05-02 11:31:14.236 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:31:14.240 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:31:14.240 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:31:14.246 +01:00 [DBG] Start token request.
2020-05-02 11:31:14.250 +01:00 [DBG] Start client validation
2020-05-02 11:31:14.253 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:31:14.256 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 11:31:14.267 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 11:31:14.267 +01:00 [DBG] Secret id found: ro.client
2020-05-02 11:31:14.337 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:31:14.337 +01:00 [DBG] Client validation success
2020-05-02 11:31:14.344 +01:00 [DBG] Start token request validation
2020-05-02 11:31:14.352 +01:00 [DBG] Start resource owner password token request validation
2020-05-02 11:31:14.426 +01:00 [DBG] IsActive called from: ResourceOwnerValidation
2020-05-02 11:31:14.426 +01:00 [DBG] Resource owner password token request validation success.
2020-05-02 11:31:14.435 +01:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"username":"alice","password":"***REDACTED***","scope":"api1","grant_type":"password","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:31:14.458 +01:00 [DBG] Getting claims for access token for client: ro.client
2020-05-02 11:31:14.458 +01:00 [DBG] Getting claims for access token for subject: 1
2020-05-02 11:31:14.463 +01:00 [DBG] Get profile called for subject 1 from client ro.client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:31:14.465 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:31:14.509 +01:00 [DBG] Token request success.
2020-05-02 11:31:14.688 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:31:14.689 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:31:14.689 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:31:14.689 +01:00 [DBG] Start discovery request
2020-05-02 11:31:14.787 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:31:14.788 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:31:14.788 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:31:14.788 +01:00 [DBG] Start key discovery request
2020-05-02 11:31:24.464 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:31:24.464 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:31:24.464 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:31:24.464 +01:00 [DBG] Start discovery request
2020-05-02 11:31:24.549 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:31:24.550 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:31:24.550 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:31:24.550 +01:00 [DBG] Start key discovery request
2020-05-02 11:31:24.580 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-05-02 11:31:24.581 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-05-02 11:31:24.581 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-05-02 11:31:24.584 +01:00 [DBG] Start authorize request
2020-05-02 11:31:24.589 +01:00 [DBG] No user present in authorize request
2020-05-02 11:31:24.592 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:31:24.600 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:31:24.601 +01:00 [DBG] No PKCE used.
2020-05-02 11:31:24.625 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:31:24.628 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeK5D3UXdl5TPnGKX1YYkYKyePKz9jh36DYVt_CNInLrr_mU2oRhi2kI22nVUnQhfcu-RyPcv1piVvN06tWNCKv9Oo3ecgl3JhoZpzYnPApNXw9CS667-tTG9q45dXyp_JSWhglVy5DGsAN5rR9oQwWg-zy8JoDNQcnxPHWnZjlzQeP6g3iSpQhICUtiEUs3IWcgRFFA1JII-H_gQuE4Axg49mnRikdX6CE3JfkAVmQ-IMWnWx8Fe9zZMkp_wmVQfMI7uhZFj4RcwdhXOt5qoVRzG46fvpv1-HeidELTfBa4DduH3VuoXi99HLmKdvhYEyc","UiLocales":null,"Nonce":"637240122845612768.MGI1YmQxMGYtYzgzNy00NmRjLTllN2UtNTI1MDk0MDI4ZTkyODZiMmRiOWEtMDA1NS00MDk0LTgwODEtYThkZGUwNGZkMTg3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240122845612768.MGI1YmQxMGYtYzgzNy00NmRjLTllN2UtNTI1MDk0MDI4ZTkyODZiMmRiOWEtMDA1NS00MDk0LTgwODEtYThkZGUwNGZkMTg3","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeK5D3UXdl5TPnGKX1YYkYKyePKz9jh36DYVt_CNInLrr_mU2oRhi2kI22nVUnQhfcu-RyPcv1piVvN06tWNCKv9Oo3ecgl3JhoZpzYnPApNXw9CS667-tTG9q45dXyp_JSWhglVy5DGsAN5rR9oQwWg-zy8JoDNQcnxPHWnZjlzQeP6g3iSpQhICUtiEUs3IWcgRFFA1JII-H_gQuE4Axg49mnRikdX6CE3JfkAVmQ-IMWnWx8Fe9zZMkp_wmVQfMI7uhZFj4RcwdhXOt5qoVRzG46fvpv1-HeidELTfBa4DduH3VuoXi99HLmKdvhYEyc","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 11:31:24.633 +01:00 [INF] Showing login: User is not authenticated
2020-05-02 11:31:24.673 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:31:24.676 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:31:24.676 +01:00 [DBG] No PKCE used.
2020-05-02 11:31:24.690 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:31:30.517 +01:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-05-02 11:31:30.535 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:31:30.538 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:31:30.538 +01:00 [DBG] No PKCE used.
2020-05-02 11:31:30.553 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:31:30.564 +01:00 [DBG] Augmenting SignInContext
2020-05-02 11:31:30.566 +01:00 [DBG] Adding idp claim with value: local
2020-05-02 11:31:30.566 +01:00 [DBG] Adding amr claim with value: pwd
2020-05-02 11:31:30.574 +01:00 [INF] AuthenticationScheme: idsrv signed in.
2020-05-02 11:31:30.584 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-05-02 11:31:30.585 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-05-02 11:31:30.585 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-05-02 11:31:30.589 +01:00 [DBG] Start authorize callback request
2020-05-02 11:31:30.591 +01:00 [DBG] User in authorize request: 2
2020-05-02 11:31:30.591 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:31:30.593 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:31:30.593 +01:00 [DBG] No PKCE used.
2020-05-02 11:31:30.606 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:31:30.606 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeK5D3UXdl5TPnGKX1YYkYKyePKz9jh36DYVt_CNInLrr_mU2oRhi2kI22nVUnQhfcu-RyPcv1piVvN06tWNCKv9Oo3ecgl3JhoZpzYnPApNXw9CS667-tTG9q45dXyp_JSWhglVy5DGsAN5rR9oQwWg-zy8JoDNQcnxPHWnZjlzQeP6g3iSpQhICUtiEUs3IWcgRFFA1JII-H_gQuE4Axg49mnRikdX6CE3JfkAVmQ-IMWnWx8Fe9zZMkp_wmVQfMI7uhZFj4RcwdhXOt5qoVRzG46fvpv1-HeidELTfBa4DduH3VuoXi99HLmKdvhYEyc","UiLocales":null,"Nonce":"637240122845612768.MGI1YmQxMGYtYzgzNy00NmRjLTllN2UtNTI1MDk0MDI4ZTkyODZiMmRiOWEtMDA1NS00MDk0LTgwODEtYThkZGUwNGZkMTg3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"937cd82d701c6eb3b5967640ea4c9b5d","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240122845612768.MGI1YmQxMGYtYzgzNy00NmRjLTllN2UtNTI1MDk0MDI4ZTkyODZiMmRiOWEtMDA1NS00MDk0LTgwODEtYThkZGUwNGZkMTg3","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeK5D3UXdl5TPnGKX1YYkYKyePKz9jh36DYVt_CNInLrr_mU2oRhi2kI22nVUnQhfcu-RyPcv1piVvN06tWNCKv9Oo3ecgl3JhoZpzYnPApNXw9CS667-tTG9q45dXyp_JSWhglVy5DGsAN5rR9oQwWg-zy8JoDNQcnxPHWnZjlzQeP6g3iSpQhICUtiEUs3IWcgRFFA1JII-H_gQuE4Axg49mnRikdX6CE3JfkAVmQ-IMWnWx8Fe9zZMkp_wmVQfMI7uhZFj4RcwdhXOt5qoVRzG46fvpv1-HeidELTfBa4DduH3VuoXi99HLmKdvhYEyc","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 11:31:30.606 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2020-05-02 11:31:30.612 +01:00 [DBG] Scopes contains offline_access, consent is required
2020-05-02 11:31:30.612 +01:00 [INF] Showing consent: User has not yet consented
2020-05-02 11:31:30.629 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:31:30.632 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:31:30.632 +01:00 [DBG] No PKCE used.
2020-05-02 11:31:30.647 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:31:32.151 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-05-02 11:31:32.163 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:31:32.168 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:31:32.168 +01:00 [DBG] No PKCE used.
2020-05-02 11:31:32.187 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:31:32.204 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-05-02 11:31:32.205 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-05-02 11:31:32.205 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-05-02 11:31:32.205 +01:00 [DBG] Start authorize callback request
2020-05-02 11:31:32.209 +01:00 [DBG] User in authorize request: 2
2020-05-02 11:31:32.209 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:31:32.212 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:31:32.213 +01:00 [DBG] No PKCE used.
2020-05-02 11:31:32.227 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:31:32.227 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeK5D3UXdl5TPnGKX1YYkYKyePKz9jh36DYVt_CNInLrr_mU2oRhi2kI22nVUnQhfcu-RyPcv1piVvN06tWNCKv9Oo3ecgl3JhoZpzYnPApNXw9CS667-tTG9q45dXyp_JSWhglVy5DGsAN5rR9oQwWg-zy8JoDNQcnxPHWnZjlzQeP6g3iSpQhICUtiEUs3IWcgRFFA1JII-H_gQuE4Axg49mnRikdX6CE3JfkAVmQ-IMWnWx8Fe9zZMkp_wmVQfMI7uhZFj4RcwdhXOt5qoVRzG46fvpv1-HeidELTfBa4DduH3VuoXi99HLmKdvhYEyc","UiLocales":null,"Nonce":"637240122845612768.MGI1YmQxMGYtYzgzNy00NmRjLTllN2UtNTI1MDk0MDI4ZTkyODZiMmRiOWEtMDA1NS00MDk0LTgwODEtYThkZGUwNGZkMTg3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"937cd82d701c6eb3b5967640ea4c9b5d","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240122845612768.MGI1YmQxMGYtYzgzNy00NmRjLTllN2UtNTI1MDk0MDI4ZTkyODZiMmRiOWEtMDA1NS00MDk0LTgwODEtYThkZGUwNGZkMTg3","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeK5D3UXdl5TPnGKX1YYkYKyePKz9jh36DYVt_CNInLrr_mU2oRhi2kI22nVUnQhfcu-RyPcv1piVvN06tWNCKv9Oo3ecgl3JhoZpzYnPApNXw9CS667-tTG9q45dXyp_JSWhglVy5DGsAN5rR9oQwWg-zy8JoDNQcnxPHWnZjlzQeP6g3iSpQhICUtiEUs3IWcgRFFA1JII-H_gQuE4Axg49mnRikdX6CE3JfkAVmQ-IMWnWx8Fe9zZMkp_wmVQfMI7uhZFj4RcwdhXOt5qoVRzG46fvpv1-HeidELTfBa4DduH3VuoXi99HLmKdvhYEyc","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 11:31:32.227 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2020-05-02 11:31:32.227 +01:00 [DBG] Scopes contains offline_access, consent is required
2020-05-02 11:31:32.231 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2020-05-02 11:31:32.231 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2020-05-02 11:31:32.233 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 2
2020-05-02 11:31:32.298 +01:00 [DBG] Creating Hybrid Flow response.
2020-05-02 11:31:32.314 +01:00 [DBG] Creating Implicit Flow response.
2020-05-02 11:31:32.321 +01:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2020-05-02 11:31:32.321 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2020-05-02 11:31:32.327 +01:00 [INF] Authorize endpoint response
{"SubjectId":"2","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeK5D3UXdl5TPnGKX1YYkYKyePKz9jh36DYVt_CNInLrr_mU2oRhi2kI22nVUnQhfcu-RyPcv1piVvN06tWNCKv9Oo3ecgl3JhoZpzYnPApNXw9CS667-tTG9q45dXyp_JSWhglVy5DGsAN5rR9oQwWg-zy8JoDNQcnxPHWnZjlzQeP6g3iSpQhICUtiEUs3IWcgRFFA1JII-H_gQuE4Axg49mnRikdX6CE3JfkAVmQ-IMWnWx8Fe9zZMkp_wmVQfMI7uhZFj4RcwdhXOt5qoVRzG46fvpv1-HeidELTfBa4DduH3VuoXi99HLmKdvhYEyc","Scope":"openid profile api1 offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-05-02 11:31:32.340 +01:00 [DBG] Augmenting SignInContext
2020-05-02 11:31:32.340 +01:00 [INF] AuthenticationScheme: idsrv signed in.
2020-05-02 11:31:32.444 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:31:32.445 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:31:32.445 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:31:32.445 +01:00 [DBG] Start token request.
2020-05-02 11:31:32.445 +01:00 [DBG] Start client validation
2020-05-02 11:31:32.445 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:31:32.445 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 11:31:32.445 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 11:31:32.445 +01:00 [DBG] Secret id found: mvc
2020-05-02 11:31:32.448 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:31:32.448 +01:00 [DBG] Client validation success
2020-05-02 11:31:32.448 +01:00 [DBG] Start token request validation
2020-05-02 11:31:32.454 +01:00 [DBG] Start validation of authorization code token request
2020-05-02 11:31:32.481 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2020-05-02 11:31:32.481 +01:00 [DBG] Validation of authorization code token request success
2020-05-02 11:31:32.482 +01:00 [INF] Token request validation success
{"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"789fe441bec3ebce281d4f12c3a2703afe6726c489a047dab945d1dc5cc92f3b","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"789fe441bec3ebce281d4f12c3a2703afe6726c489a047dab945d1dc5cc92f3b","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:31:32.495 +01:00 [DBG] Getting claims for access token for client: mvc
2020-05-02 11:31:32.495 +01:00 [DBG] Getting claims for access token for subject: 2
2020-05-02 11:31:32.495 +01:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:31:32.495 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:31:32.499 +01:00 [DBG] Creating refresh token
2020-05-02 11:31:32.499 +01:00 [DBG] Setting an absolute lifetime: 2592000
2020-05-02 11:31:32.519 +01:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2020-05-02 11:31:32.519 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2020-05-02 11:31:32.522 +01:00 [DBG] Token request success.
2020-05-02 11:31:32.532 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-05-02 11:31:32.533 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-05-02 11:31:32.533 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-05-02 11:31:32.538 +01:00 [DBG] Start userinfo request
2020-05-02 11:31:32.540 +01:00 [DBG] Bearer token found in header
2020-05-02 11:31:32.563 +01:00 [DBG] IsActive called from: AccessTokenValidation
2020-05-02 11:31:32.564 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-05-02 11:31:32.565 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1588415492,"exp":1588419092,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvc","sub":"2","auth_time":1588415490,"idp":"local","name":"Bob","website":"https://bob.com","scope":["openid","profile","api1","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-05-02 11:31:32.566 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2020-05-02 11:31:32.570 +01:00 [DBG] Creating userinfo response
2020-05-02 11:31:32.572 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:31:32.574 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:31:32.578 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2020-05-02 11:31:32.578 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:31:32.580 +01:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2020-05-02 11:31:32.580 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:31:32.581 +01:00 [INF] Profile service returned the following claim types: name website
2020-05-02 11:31:32.581 +01:00 [DBG] End userinfo request
2020-05-02 11:32:40.520 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 11:32:40.906 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 11:32:40.906 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 11:32:40.906 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 11:32:40.906 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 11:32:40.906 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 11:32:40.906 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 11:32:41.497 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 11:32:41.498 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 11:32:41.498 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 11:32:41.498 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 11:32:41.498 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 11:32:41.498 +01:00 [DBG] Error Url: /home/error
2020-05-02 11:32:41.498 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 11:32:41.523 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:32:41.527 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:32:41.527 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:32:41.530 +01:00 [DBG] Start discovery request
2020-05-02 11:32:41.789 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:32:41.790 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:32:41.790 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:32:41.793 +01:00 [DBG] Start key discovery request
2020-05-02 11:32:41.996 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:32:42.000 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:32:42.000 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:32:42.005 +01:00 [DBG] Start token request.
2020-05-02 11:32:42.010 +01:00 [DBG] Start client validation
2020-05-02 11:32:42.013 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:32:42.016 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 11:32:42.028 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 11:32:42.028 +01:00 [DBG] Secret id found: ro.client
2020-05-02 11:32:42.099 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:32:42.099 +01:00 [DBG] Client validation success
2020-05-02 11:32:42.106 +01:00 [DBG] Start token request validation
2020-05-02 11:32:42.114 +01:00 [DBG] Start resource owner password token request validation
2020-05-02 11:32:42.190 +01:00 [DBG] IsActive called from: ResourceOwnerValidation
2020-05-02 11:32:42.191 +01:00 [DBG] Resource owner password token request validation success.
2020-05-02 11:32:42.199 +01:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"username":"alice","password":"***REDACTED***","scope":"api1","grant_type":"password","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:32:42.225 +01:00 [DBG] Getting claims for access token for client: ro.client
2020-05-02 11:32:42.225 +01:00 [DBG] Getting claims for access token for subject: 1
2020-05-02 11:32:42.230 +01:00 [DBG] Get profile called for subject 1 from client ro.client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:32:42.232 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:32:42.280 +01:00 [DBG] Token request success.
2020-05-02 11:32:42.438 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:32:42.438 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:32:42.438 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:32:42.438 +01:00 [DBG] Start discovery request
2020-05-02 11:32:42.534 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:32:42.535 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:32:42.535 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:32:42.535 +01:00 [DBG] Start key discovery request
2020-05-02 11:32:42.712 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:32:42.712 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:32:42.712 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:32:42.712 +01:00 [DBG] Start discovery request
2020-05-02 11:32:56.275 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:32:56.275 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:32:56.275 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:32:56.275 +01:00 [DBG] Start key discovery request
2020-05-02 11:32:56.308 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-05-02 11:32:56.309 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-05-02 11:32:56.309 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-05-02 11:32:56.312 +01:00 [DBG] Start authorize request
2020-05-02 11:32:56.317 +01:00 [DBG] No user present in authorize request
2020-05-02 11:32:56.320 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:32:56.329 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:32:56.330 +01:00 [DBG] No PKCE used.
2020-05-02 11:32:56.354 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:32:56.356 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeJNv8OfIO_1b4fHUGdzMwrp4wILGm4Q8ZQxxDNDboDqCFu9XfGZwmzG2J80vuEIrbElelXgd22JAg7XiSGK21yygSCfiV57mx-Tp5bfnSENNkohHpWFiwkIEkuGMHatE3aVsmkqWZq-Pp3BFas6czfKwTNt1M3IPJWUmjWUHa8Dn6y2hu5gg8mLJrlSSOByUmS3ndLikrRWyj1ztqaItojZozN1eflnSzHxStGCctO5O23EGcmfjhI73eEI6qkBLuGYM3L_Vz_bS1yR3PnhYBa00y2LnKZunnlhM2XQdG0fHm-eMXPr7Au9Kf4MSQgIPH8","UiLocales":null,"Nonce":"637240123762868404.OWYwZThiNWEtNWY1YS00OWVlLWEyMzAtYWJiMDIwM2ExOGFkODVmNjAwNmMtMTVlNi00YzkzLWIxMDItZTJjMWZiZmU2NThl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240123762868404.OWYwZThiNWEtNWY1YS00OWVlLWEyMzAtYWJiMDIwM2ExOGFkODVmNjAwNmMtMTVlNi00YzkzLWIxMDItZTJjMWZiZmU2NThl","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeJNv8OfIO_1b4fHUGdzMwrp4wILGm4Q8ZQxxDNDboDqCFu9XfGZwmzG2J80vuEIrbElelXgd22JAg7XiSGK21yygSCfiV57mx-Tp5bfnSENNkohHpWFiwkIEkuGMHatE3aVsmkqWZq-Pp3BFas6czfKwTNt1M3IPJWUmjWUHa8Dn6y2hu5gg8mLJrlSSOByUmS3ndLikrRWyj1ztqaItojZozN1eflnSzHxStGCctO5O23EGcmfjhI73eEI6qkBLuGYM3L_Vz_bS1yR3PnhYBa00y2LnKZunnlhM2XQdG0fHm-eMXPr7Au9Kf4MSQgIPH8","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 11:32:56.361 +01:00 [INF] Showing login: User is not authenticated
2020-05-02 11:32:56.403 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:32:56.406 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:32:56.406 +01:00 [DBG] No PKCE used.
2020-05-02 11:32:56.422 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:33:05.429 +01:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-05-02 11:33:05.446 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:33:05.449 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:33:05.449 +01:00 [DBG] No PKCE used.
2020-05-02 11:33:05.463 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:33:05.474 +01:00 [DBG] Augmenting SignInContext
2020-05-02 11:33:05.476 +01:00 [DBG] Adding idp claim with value: local
2020-05-02 11:33:05.476 +01:00 [DBG] Adding amr claim with value: pwd
2020-05-02 11:33:05.484 +01:00 [INF] AuthenticationScheme: idsrv signed in.
2020-05-02 11:33:05.494 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-05-02 11:33:05.495 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-05-02 11:33:05.495 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-05-02 11:33:05.499 +01:00 [DBG] Start authorize callback request
2020-05-02 11:33:05.501 +01:00 [DBG] User in authorize request: 2
2020-05-02 11:33:05.501 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:33:05.504 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:33:05.504 +01:00 [DBG] No PKCE used.
2020-05-02 11:33:05.519 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:33:05.519 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeJNv8OfIO_1b4fHUGdzMwrp4wILGm4Q8ZQxxDNDboDqCFu9XfGZwmzG2J80vuEIrbElelXgd22JAg7XiSGK21yygSCfiV57mx-Tp5bfnSENNkohHpWFiwkIEkuGMHatE3aVsmkqWZq-Pp3BFas6czfKwTNt1M3IPJWUmjWUHa8Dn6y2hu5gg8mLJrlSSOByUmS3ndLikrRWyj1ztqaItojZozN1eflnSzHxStGCctO5O23EGcmfjhI73eEI6qkBLuGYM3L_Vz_bS1yR3PnhYBa00y2LnKZunnlhM2XQdG0fHm-eMXPr7Au9Kf4MSQgIPH8","UiLocales":null,"Nonce":"637240123762868404.OWYwZThiNWEtNWY1YS00OWVlLWEyMzAtYWJiMDIwM2ExOGFkODVmNjAwNmMtMTVlNi00YzkzLWIxMDItZTJjMWZiZmU2NThl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"cd385e5aefe2c8df88dfc42d79096f02","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240123762868404.OWYwZThiNWEtNWY1YS00OWVlLWEyMzAtYWJiMDIwM2ExOGFkODVmNjAwNmMtMTVlNi00YzkzLWIxMDItZTJjMWZiZmU2NThl","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeJNv8OfIO_1b4fHUGdzMwrp4wILGm4Q8ZQxxDNDboDqCFu9XfGZwmzG2J80vuEIrbElelXgd22JAg7XiSGK21yygSCfiV57mx-Tp5bfnSENNkohHpWFiwkIEkuGMHatE3aVsmkqWZq-Pp3BFas6czfKwTNt1M3IPJWUmjWUHa8Dn6y2hu5gg8mLJrlSSOByUmS3ndLikrRWyj1ztqaItojZozN1eflnSzHxStGCctO5O23EGcmfjhI73eEI6qkBLuGYM3L_Vz_bS1yR3PnhYBa00y2LnKZunnlhM2XQdG0fHm-eMXPr7Au9Kf4MSQgIPH8","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 11:33:05.519 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2020-05-02 11:33:05.525 +01:00 [DBG] Scopes contains offline_access, consent is required
2020-05-02 11:33:05.525 +01:00 [INF] Showing consent: User has not yet consented
2020-05-02 11:33:05.541 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:33:05.544 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:33:05.544 +01:00 [DBG] No PKCE used.
2020-05-02 11:33:05.559 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:33:06.895 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-05-02 11:33:06.909 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:33:06.912 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:33:06.912 +01:00 [DBG] No PKCE used.
2020-05-02 11:33:06.928 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:33:06.944 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-05-02 11:33:06.944 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-05-02 11:33:06.944 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-05-02 11:33:06.944 +01:00 [DBG] Start authorize callback request
2020-05-02 11:33:06.947 +01:00 [DBG] User in authorize request: 2
2020-05-02 11:33:06.947 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:33:06.949 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:33:06.949 +01:00 [DBG] No PKCE used.
2020-05-02 11:33:06.964 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:33:06.964 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeJNv8OfIO_1b4fHUGdzMwrp4wILGm4Q8ZQxxDNDboDqCFu9XfGZwmzG2J80vuEIrbElelXgd22JAg7XiSGK21yygSCfiV57mx-Tp5bfnSENNkohHpWFiwkIEkuGMHatE3aVsmkqWZq-Pp3BFas6czfKwTNt1M3IPJWUmjWUHa8Dn6y2hu5gg8mLJrlSSOByUmS3ndLikrRWyj1ztqaItojZozN1eflnSzHxStGCctO5O23EGcmfjhI73eEI6qkBLuGYM3L_Vz_bS1yR3PnhYBa00y2LnKZunnlhM2XQdG0fHm-eMXPr7Au9Kf4MSQgIPH8","UiLocales":null,"Nonce":"637240123762868404.OWYwZThiNWEtNWY1YS00OWVlLWEyMzAtYWJiMDIwM2ExOGFkODVmNjAwNmMtMTVlNi00YzkzLWIxMDItZTJjMWZiZmU2NThl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"cd385e5aefe2c8df88dfc42d79096f02","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240123762868404.OWYwZThiNWEtNWY1YS00OWVlLWEyMzAtYWJiMDIwM2ExOGFkODVmNjAwNmMtMTVlNi00YzkzLWIxMDItZTJjMWZiZmU2NThl","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeJNv8OfIO_1b4fHUGdzMwrp4wILGm4Q8ZQxxDNDboDqCFu9XfGZwmzG2J80vuEIrbElelXgd22JAg7XiSGK21yygSCfiV57mx-Tp5bfnSENNkohHpWFiwkIEkuGMHatE3aVsmkqWZq-Pp3BFas6czfKwTNt1M3IPJWUmjWUHa8Dn6y2hu5gg8mLJrlSSOByUmS3ndLikrRWyj1ztqaItojZozN1eflnSzHxStGCctO5O23EGcmfjhI73eEI6qkBLuGYM3L_Vz_bS1yR3PnhYBa00y2LnKZunnlhM2XQdG0fHm-eMXPr7Au9Kf4MSQgIPH8","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 11:33:06.964 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2020-05-02 11:33:06.964 +01:00 [DBG] Scopes contains offline_access, consent is required
2020-05-02 11:33:06.968 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2020-05-02 11:33:06.968 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2020-05-02 11:33:06.970 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 2
2020-05-02 11:33:07.035 +01:00 [DBG] Creating Hybrid Flow response.
2020-05-02 11:33:07.051 +01:00 [DBG] Creating Implicit Flow response.
2020-05-02 11:33:07.057 +01:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2020-05-02 11:33:07.058 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2020-05-02 11:33:07.064 +01:00 [INF] Authorize endpoint response
{"SubjectId":"2","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeJNv8OfIO_1b4fHUGdzMwrp4wILGm4Q8ZQxxDNDboDqCFu9XfGZwmzG2J80vuEIrbElelXgd22JAg7XiSGK21yygSCfiV57mx-Tp5bfnSENNkohHpWFiwkIEkuGMHatE3aVsmkqWZq-Pp3BFas6czfKwTNt1M3IPJWUmjWUHa8Dn6y2hu5gg8mLJrlSSOByUmS3ndLikrRWyj1ztqaItojZozN1eflnSzHxStGCctO5O23EGcmfjhI73eEI6qkBLuGYM3L_Vz_bS1yR3PnhYBa00y2LnKZunnlhM2XQdG0fHm-eMXPr7Au9Kf4MSQgIPH8","Scope":"openid profile api1 offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-05-02 11:33:07.077 +01:00 [DBG] Augmenting SignInContext
2020-05-02 11:33:07.077 +01:00 [INF] AuthenticationScheme: idsrv signed in.
2020-05-02 11:33:07.176 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:33:07.177 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:33:07.177 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:33:07.177 +01:00 [DBG] Start token request.
2020-05-02 11:33:07.177 +01:00 [DBG] Start client validation
2020-05-02 11:33:07.177 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:33:07.177 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 11:33:07.177 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 11:33:07.177 +01:00 [DBG] Secret id found: mvc
2020-05-02 11:33:07.180 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:33:07.180 +01:00 [DBG] Client validation success
2020-05-02 11:33:07.180 +01:00 [DBG] Start token request validation
2020-05-02 11:33:07.186 +01:00 [DBG] Start validation of authorization code token request
2020-05-02 11:33:07.213 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2020-05-02 11:33:07.213 +01:00 [DBG] Validation of authorization code token request success
2020-05-02 11:33:07.213 +01:00 [INF] Token request validation success
{"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"72ec8eb33c69b0f6d5dc3c6fcb03802e36288d33a0d07ddaa8e94f228031b07a","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"72ec8eb33c69b0f6d5dc3c6fcb03802e36288d33a0d07ddaa8e94f228031b07a","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:33:07.226 +01:00 [DBG] Getting claims for access token for client: mvc
2020-05-02 11:33:07.227 +01:00 [DBG] Getting claims for access token for subject: 2
2020-05-02 11:33:07.227 +01:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:33:07.227 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:33:07.231 +01:00 [DBG] Creating refresh token
2020-05-02 11:33:07.231 +01:00 [DBG] Setting an absolute lifetime: 2592000
2020-05-02 11:33:07.250 +01:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2020-05-02 11:33:07.250 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2020-05-02 11:33:07.252 +01:00 [DBG] Token request success.
2020-05-02 11:33:07.259 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-05-02 11:33:07.260 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-05-02 11:33:07.260 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-05-02 11:33:07.265 +01:00 [DBG] Start userinfo request
2020-05-02 11:33:07.267 +01:00 [DBG] Bearer token found in header
2020-05-02 11:33:07.291 +01:00 [DBG] IsActive called from: AccessTokenValidation
2020-05-02 11:33:07.291 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-05-02 11:33:07.292 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1588415587,"exp":1588419187,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvc","sub":"2","auth_time":1588415585,"idp":"local","name":"Bob","website":"https://bob.com","scope":["openid","profile","api1","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-05-02 11:33:07.293 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2020-05-02 11:33:07.296 +01:00 [DBG] Creating userinfo response
2020-05-02 11:33:07.299 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:33:07.300 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:33:07.304 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2020-05-02 11:33:07.304 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:33:07.306 +01:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2020-05-02 11:33:07.307 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:33:07.307 +01:00 [INF] Profile service returned the following claim types: name website
2020-05-02 11:33:07.307 +01:00 [DBG] End userinfo request
2020-05-02 11:34:13.110 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 11:34:13.463 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 11:34:13.463 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 11:34:13.463 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 11:34:13.463 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 11:34:13.463 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 11:34:13.463 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 11:34:14.037 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 11:34:14.038 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 11:34:14.038 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 11:34:14.038 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 11:34:14.038 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 11:34:14.038 +01:00 [DBG] Error Url: /home/error
2020-05-02 11:34:14.038 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 11:34:14.062 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:34:14.071 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:34:14.071 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:34:14.074 +01:00 [DBG] Start discovery request
2020-05-02 11:34:14.317 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:34:14.318 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:34:14.318 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:34:14.321 +01:00 [DBG] Start key discovery request
2020-05-02 11:34:14.525 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:34:14.529 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:34:14.529 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:34:14.534 +01:00 [DBG] Start token request.
2020-05-02 11:34:14.539 +01:00 [DBG] Start client validation
2020-05-02 11:34:14.543 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:34:14.545 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 11:34:14.558 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 11:34:14.558 +01:00 [DBG] Secret id found: ro.client
2020-05-02 11:34:14.640 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:34:14.640 +01:00 [DBG] Client validation success
2020-05-02 11:34:14.647 +01:00 [DBG] Start token request validation
2020-05-02 11:34:14.655 +01:00 [DBG] Start resource owner password token request validation
2020-05-02 11:34:14.733 +01:00 [DBG] IsActive called from: ResourceOwnerValidation
2020-05-02 11:34:14.733 +01:00 [DBG] Resource owner password token request validation success.
2020-05-02 11:34:14.742 +01:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"username":"alice","password":"***REDACTED***","scope":"api1","grant_type":"password","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:34:14.765 +01:00 [DBG] Getting claims for access token for client: ro.client
2020-05-02 11:34:14.765 +01:00 [DBG] Getting claims for access token for subject: 1
2020-05-02 11:34:14.770 +01:00 [DBG] Get profile called for subject 1 from client ro.client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:34:14.773 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:34:14.819 +01:00 [DBG] Token request success.
2020-05-02 11:34:15.013 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:34:15.014 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:34:15.014 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:34:15.014 +01:00 [DBG] Start discovery request
2020-05-02 11:34:15.131 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:34:15.132 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:34:15.132 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:34:15.132 +01:00 [DBG] Start key discovery request
2020-05-02 11:34:24.274 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:34:24.274 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:34:24.274 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:34:24.275 +01:00 [DBG] Start discovery request
2020-05-02 11:34:24.356 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:34:24.357 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:34:24.357 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:34:24.357 +01:00 [DBG] Start key discovery request
2020-05-02 11:34:24.393 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-05-02 11:34:24.394 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-05-02 11:34:24.394 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-05-02 11:34:24.397 +01:00 [DBG] Start authorize request
2020-05-02 11:34:24.402 +01:00 [DBG] User in authorize request: 2
2020-05-02 11:34:24.406 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:34:24.414 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:34:24.415 +01:00 [DBG] No PKCE used.
2020-05-02 11:34:24.440 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:34:24.442 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeJdJUPqdHHufX01NhhuqVKunQ1-zzefv51qeFulBbSPHkykV22aJ-546P8koZxaU-WXZsKbQaKftnaYnGUxNaz-HX2VDPiPCy5LuAXF6tYId_58FRjSCGLgtDlawPxZ569ZlykFe3-6drBQKHbjf93sdNYxI1yhrj06H_ai6tcaCNtXt7_G-Re8T_-iTMTzwU7cDgIohjyte2FLM6r7S4o1dqEBx9w_Fde5c-86Nkre-i0a3ERgpwK1zJbUidxPizAVAJeUdeZarAJcJRmNsq4VnXOdWUH-1sgXj73_FazfYrkMShaNTJFOn7pPunDXMlc","UiLocales":null,"Nonce":"637240124643744405.OTA0ZjMyMmEtMzNhMi00NDEzLThmNjUtNTU5ZWZiNjllODM1MDY1ODM4YjMtNmQ5ZS00YzY0LThjMWUtNDQ5NzA1ZDczZmVi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"cd385e5aefe2c8df88dfc42d79096f02","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240124643744405.OTA0ZjMyMmEtMzNhMi00NDEzLThmNjUtNTU5ZWZiNjllODM1MDY1ODM4YjMtNmQ5ZS00YzY0LThjMWUtNDQ5NzA1ZDczZmVi","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeJdJUPqdHHufX01NhhuqVKunQ1-zzefv51qeFulBbSPHkykV22aJ-546P8koZxaU-WXZsKbQaKftnaYnGUxNaz-HX2VDPiPCy5LuAXF6tYId_58FRjSCGLgtDlawPxZ569ZlykFe3-6drBQKHbjf93sdNYxI1yhrj06H_ai6tcaCNtXt7_G-Re8T_-iTMTzwU7cDgIohjyte2FLM6r7S4o1dqEBx9w_Fde5c-86Nkre-i0a3ERgpwK1zJbUidxPizAVAJeUdeZarAJcJRmNsq4VnXOdWUH-1sgXj73_FazfYrkMShaNTJFOn7pPunDXMlc","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 11:34:24.448 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2020-05-02 11:34:24.454 +01:00 [DBG] Scopes contains offline_access, consent is required
2020-05-02 11:34:24.454 +01:00 [INF] Showing consent: User has not yet consented
2020-05-02 11:34:24.502 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:34:24.504 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:34:24.504 +01:00 [DBG] No PKCE used.
2020-05-02 11:34:24.520 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:34:27.033 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-05-02 11:34:27.053 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:34:27.056 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:34:27.056 +01:00 [DBG] No PKCE used.
2020-05-02 11:34:27.071 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:34:27.091 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-05-02 11:34:27.092 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-05-02 11:34:27.092 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-05-02 11:34:27.096 +01:00 [DBG] Start authorize callback request
2020-05-02 11:34:27.100 +01:00 [DBG] User in authorize request: 2
2020-05-02 11:34:27.100 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:34:27.103 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:34:27.103 +01:00 [DBG] No PKCE used.
2020-05-02 11:34:27.117 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:34:27.118 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeJdJUPqdHHufX01NhhuqVKunQ1-zzefv51qeFulBbSPHkykV22aJ-546P8koZxaU-WXZsKbQaKftnaYnGUxNaz-HX2VDPiPCy5LuAXF6tYId_58FRjSCGLgtDlawPxZ569ZlykFe3-6drBQKHbjf93sdNYxI1yhrj06H_ai6tcaCNtXt7_G-Re8T_-iTMTzwU7cDgIohjyte2FLM6r7S4o1dqEBx9w_Fde5c-86Nkre-i0a3ERgpwK1zJbUidxPizAVAJeUdeZarAJcJRmNsq4VnXOdWUH-1sgXj73_FazfYrkMShaNTJFOn7pPunDXMlc","UiLocales":null,"Nonce":"637240124643744405.OTA0ZjMyMmEtMzNhMi00NDEzLThmNjUtNTU5ZWZiNjllODM1MDY1ODM4YjMtNmQ5ZS00YzY0LThjMWUtNDQ5NzA1ZDczZmVi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"cd385e5aefe2c8df88dfc42d79096f02","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240124643744405.OTA0ZjMyMmEtMzNhMi00NDEzLThmNjUtNTU5ZWZiNjllODM1MDY1ODM4YjMtNmQ5ZS00YzY0LThjMWUtNDQ5NzA1ZDczZmVi","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeJdJUPqdHHufX01NhhuqVKunQ1-zzefv51qeFulBbSPHkykV22aJ-546P8koZxaU-WXZsKbQaKftnaYnGUxNaz-HX2VDPiPCy5LuAXF6tYId_58FRjSCGLgtDlawPxZ569ZlykFe3-6drBQKHbjf93sdNYxI1yhrj06H_ai6tcaCNtXt7_G-Re8T_-iTMTzwU7cDgIohjyte2FLM6r7S4o1dqEBx9w_Fde5c-86Nkre-i0a3ERgpwK1zJbUidxPizAVAJeUdeZarAJcJRmNsq4VnXOdWUH-1sgXj73_FazfYrkMShaNTJFOn7pPunDXMlc","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 11:34:27.118 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2020-05-02 11:34:27.118 +01:00 [DBG] Scopes contains offline_access, consent is required
2020-05-02 11:34:27.122 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2020-05-02 11:34:27.122 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2020-05-02 11:34:27.124 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 2
2020-05-02 11:34:27.188 +01:00 [DBG] Creating Hybrid Flow response.
2020-05-02 11:34:27.205 +01:00 [DBG] Creating Implicit Flow response.
2020-05-02 11:34:27.211 +01:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2020-05-02 11:34:27.211 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2020-05-02 11:34:27.217 +01:00 [INF] Authorize endpoint response
{"SubjectId":"2","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeJdJUPqdHHufX01NhhuqVKunQ1-zzefv51qeFulBbSPHkykV22aJ-546P8koZxaU-WXZsKbQaKftnaYnGUxNaz-HX2VDPiPCy5LuAXF6tYId_58FRjSCGLgtDlawPxZ569ZlykFe3-6drBQKHbjf93sdNYxI1yhrj06H_ai6tcaCNtXt7_G-Re8T_-iTMTzwU7cDgIohjyte2FLM6r7S4o1dqEBx9w_Fde5c-86Nkre-i0a3ERgpwK1zJbUidxPizAVAJeUdeZarAJcJRmNsq4VnXOdWUH-1sgXj73_FazfYrkMShaNTJFOn7pPunDXMlc","Scope":"openid profile api1 offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-05-02 11:34:27.324 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:34:27.325 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:34:27.325 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:34:27.325 +01:00 [DBG] Start token request.
2020-05-02 11:34:27.325 +01:00 [DBG] Start client validation
2020-05-02 11:34:27.325 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:34:27.325 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 11:34:27.325 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 11:34:27.326 +01:00 [DBG] Secret id found: mvc
2020-05-02 11:34:27.328 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:34:27.328 +01:00 [DBG] Client validation success
2020-05-02 11:34:27.328 +01:00 [DBG] Start token request validation
2020-05-02 11:34:27.335 +01:00 [DBG] Start validation of authorization code token request
2020-05-02 11:34:27.361 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2020-05-02 11:34:27.361 +01:00 [DBG] Validation of authorization code token request success
2020-05-02 11:34:27.361 +01:00 [INF] Token request validation success
{"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"741e407e8ace694e07677ab6e86ffafcb99ba4734d4a8bb91f0c8badbf4ec470","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"741e407e8ace694e07677ab6e86ffafcb99ba4734d4a8bb91f0c8badbf4ec470","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:34:27.374 +01:00 [DBG] Getting claims for access token for client: mvc
2020-05-02 11:34:27.374 +01:00 [DBG] Getting claims for access token for subject: 2
2020-05-02 11:34:27.374 +01:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:34:27.374 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:34:27.378 +01:00 [DBG] Creating refresh token
2020-05-02 11:34:27.378 +01:00 [DBG] Setting an absolute lifetime: 2592000
2020-05-02 11:34:27.397 +01:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2020-05-02 11:34:27.397 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2020-05-02 11:34:27.399 +01:00 [DBG] Token request success.
2020-05-02 11:34:27.406 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-05-02 11:34:27.407 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-05-02 11:34:27.407 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-05-02 11:34:27.411 +01:00 [DBG] Start userinfo request
2020-05-02 11:34:27.414 +01:00 [DBG] Bearer token found in header
2020-05-02 11:34:27.438 +01:00 [DBG] IsActive called from: AccessTokenValidation
2020-05-02 11:34:27.438 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-05-02 11:34:27.439 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1588415667,"exp":1588419267,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvc","sub":"2","auth_time":1588415585,"idp":"local","name":"Bob","website":"https://bob.com","scope":["openid","profile","api1","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-05-02 11:34:27.439 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2020-05-02 11:34:27.443 +01:00 [DBG] Creating userinfo response
2020-05-02 11:34:27.446 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:34:27.448 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:34:27.452 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2020-05-02 11:34:27.452 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:34:27.454 +01:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2020-05-02 11:34:27.454 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:34:27.454 +01:00 [INF] Profile service returned the following claim types: name website
2020-05-02 11:34:27.455 +01:00 [DBG] End userinfo request
2020-05-02 11:35:04.088 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 11:35:04.447 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 11:35:04.447 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 11:35:04.447 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 11:35:04.447 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 11:35:04.447 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 11:35:04.447 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 11:35:05.098 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 11:35:05.099 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 11:35:05.099 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 11:35:05.099 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 11:35:05.099 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 11:35:05.099 +01:00 [DBG] Error Url: /home/error
2020-05-02 11:35:05.099 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 11:35:05.127 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:35:05.135 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:35:05.135 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:35:05.138 +01:00 [DBG] Start discovery request
2020-05-02 11:35:05.380 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:35:05.380 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:35:05.380 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:35:05.383 +01:00 [DBG] Start key discovery request
2020-05-02 11:35:05.602 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:35:05.606 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:35:05.606 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:35:05.611 +01:00 [DBG] Start token request.
2020-05-02 11:35:05.615 +01:00 [DBG] Start client validation
2020-05-02 11:35:05.619 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:35:05.622 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 11:35:05.634 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 11:35:05.634 +01:00 [DBG] Secret id found: ro.client
2020-05-02 11:35:05.704 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:35:05.704 +01:00 [DBG] Client validation success
2020-05-02 11:35:05.711 +01:00 [DBG] Start token request validation
2020-05-02 11:35:05.719 +01:00 [DBG] Start resource owner password token request validation
2020-05-02 11:35:05.795 +01:00 [DBG] IsActive called from: ResourceOwnerValidation
2020-05-02 11:35:05.796 +01:00 [DBG] Resource owner password token request validation success.
2020-05-02 11:35:05.804 +01:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"username":"alice","password":"***REDACTED***","scope":"api1","grant_type":"password","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:35:05.827 +01:00 [DBG] Getting claims for access token for client: ro.client
2020-05-02 11:35:05.827 +01:00 [DBG] Getting claims for access token for subject: 1
2020-05-02 11:35:05.832 +01:00 [DBG] Get profile called for subject 1 from client ro.client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:35:05.835 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:35:05.880 +01:00 [DBG] Token request success.
2020-05-02 11:35:06.033 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:35:06.034 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:35:06.034 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:35:06.034 +01:00 [DBG] Start discovery request
2020-05-02 11:35:06.065 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:35:06.065 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:35:06.065 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:35:06.066 +01:00 [DBG] Start discovery request
2020-05-02 11:35:06.123 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:35:06.124 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:35:06.124 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:35:06.124 +01:00 [DBG] Start key discovery request
2020-05-02 11:35:06.159 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:35:06.160 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:35:06.160 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:35:06.160 +01:00 [DBG] Start key discovery request
2020-05-02 11:35:06.160 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-05-02 11:35:06.162 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-05-02 11:35:06.162 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-05-02 11:35:06.165 +01:00 [DBG] Start authorize request
2020-05-02 11:35:06.170 +01:00 [DBG] User in authorize request: 2
2020-05-02 11:35:06.174 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:35:06.182 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:35:06.184 +01:00 [DBG] No PKCE used.
2020-05-02 11:35:06.209 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:35:06.211 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeIKHzK2H2b9NwyTTdp0jZhTAfzb5MVNlhmhwpyYho1lhuNa_YzDQe3xU1lyzVcWh_OvE1Inqmm__MUi32nQVBw1340Zn30JZaRCcRWkiSTG0tEO_stiFkY9V-R-yotgkHfbD1JJ2fav_EgpLIIwUy90kwlQuUP0SbiMwa_N-cdFLkIsy9hhHMIQUMQPt5Xlkr69uEBxvEZ0eybXRzCUUVSnemfsBYWWwewLbjNC3Av2VcpSb6lQpGCnHM9-a4n2SEYmnEo0a2ZGKxkzUC9g4FR6JqttzGa_oDTGdqY3RMR3DJ6oVFyhhdvp8WcZNlOCcr4","UiLocales":null,"Nonce":"637240125061362065.ZWY1YjRiMTgtOTg3Ny00ZDVlLTk5ZjAtMjU5NDA4MzhlNmRiYTE4Njg4YWUtNzA5Mi00MmFjLTg0MzUtOTRlOWNmZGYzMzg4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"cd385e5aefe2c8df88dfc42d79096f02","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240125061362065.ZWY1YjRiMTgtOTg3Ny00ZDVlLTk5ZjAtMjU5NDA4MzhlNmRiYTE4Njg4YWUtNzA5Mi00MmFjLTg0MzUtOTRlOWNmZGYzMzg4","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeIKHzK2H2b9NwyTTdp0jZhTAfzb5MVNlhmhwpyYho1lhuNa_YzDQe3xU1lyzVcWh_OvE1Inqmm__MUi32nQVBw1340Zn30JZaRCcRWkiSTG0tEO_stiFkY9V-R-yotgkHfbD1JJ2fav_EgpLIIwUy90kwlQuUP0SbiMwa_N-cdFLkIsy9hhHMIQUMQPt5Xlkr69uEBxvEZ0eybXRzCUUVSnemfsBYWWwewLbjNC3Av2VcpSb6lQpGCnHM9-a4n2SEYmnEo0a2ZGKxkzUC9g4FR6JqttzGa_oDTGdqY3RMR3DJ6oVFyhhdvp8WcZNlOCcr4","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 11:35:06.217 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2020-05-02 11:35:06.223 +01:00 [DBG] Scopes contains offline_access, consent is required
2020-05-02 11:35:06.223 +01:00 [INF] Showing consent: User has not yet consented
2020-05-02 11:35:06.270 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:35:06.273 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:35:06.273 +01:00 [DBG] No PKCE used.
2020-05-02 11:35:06.287 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:35:08.717 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-05-02 11:35:08.736 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:35:08.739 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:35:08.739 +01:00 [DBG] No PKCE used.
2020-05-02 11:35:08.753 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:35:08.771 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-05-02 11:35:08.772 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-05-02 11:35:08.772 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-05-02 11:35:08.776 +01:00 [DBG] Start authorize callback request
2020-05-02 11:35:08.779 +01:00 [DBG] User in authorize request: 2
2020-05-02 11:35:08.779 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:35:08.782 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:35:08.782 +01:00 [DBG] No PKCE used.
2020-05-02 11:35:08.795 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:35:08.795 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeIKHzK2H2b9NwyTTdp0jZhTAfzb5MVNlhmhwpyYho1lhuNa_YzDQe3xU1lyzVcWh_OvE1Inqmm__MUi32nQVBw1340Zn30JZaRCcRWkiSTG0tEO_stiFkY9V-R-yotgkHfbD1JJ2fav_EgpLIIwUy90kwlQuUP0SbiMwa_N-cdFLkIsy9hhHMIQUMQPt5Xlkr69uEBxvEZ0eybXRzCUUVSnemfsBYWWwewLbjNC3Av2VcpSb6lQpGCnHM9-a4n2SEYmnEo0a2ZGKxkzUC9g4FR6JqttzGa_oDTGdqY3RMR3DJ6oVFyhhdvp8WcZNlOCcr4","UiLocales":null,"Nonce":"637240125061362065.ZWY1YjRiMTgtOTg3Ny00ZDVlLTk5ZjAtMjU5NDA4MzhlNmRiYTE4Njg4YWUtNzA5Mi00MmFjLTg0MzUtOTRlOWNmZGYzMzg4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"cd385e5aefe2c8df88dfc42d79096f02","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240125061362065.ZWY1YjRiMTgtOTg3Ny00ZDVlLTk5ZjAtMjU5NDA4MzhlNmRiYTE4Njg4YWUtNzA5Mi00MmFjLTg0MzUtOTRlOWNmZGYzMzg4","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeIKHzK2H2b9NwyTTdp0jZhTAfzb5MVNlhmhwpyYho1lhuNa_YzDQe3xU1lyzVcWh_OvE1Inqmm__MUi32nQVBw1340Zn30JZaRCcRWkiSTG0tEO_stiFkY9V-R-yotgkHfbD1JJ2fav_EgpLIIwUy90kwlQuUP0SbiMwa_N-cdFLkIsy9hhHMIQUMQPt5Xlkr69uEBxvEZ0eybXRzCUUVSnemfsBYWWwewLbjNC3Av2VcpSb6lQpGCnHM9-a4n2SEYmnEo0a2ZGKxkzUC9g4FR6JqttzGa_oDTGdqY3RMR3DJ6oVFyhhdvp8WcZNlOCcr4","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 11:35:08.795 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2020-05-02 11:35:08.795 +01:00 [DBG] Scopes contains offline_access, consent is required
2020-05-02 11:35:08.799 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2020-05-02 11:35:08.799 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2020-05-02 11:35:08.802 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 2
2020-05-02 11:35:08.865 +01:00 [DBG] Creating Hybrid Flow response.
2020-05-02 11:35:08.883 +01:00 [DBG] Creating Implicit Flow response.
2020-05-02 11:35:08.889 +01:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2020-05-02 11:35:08.889 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2020-05-02 11:35:08.895 +01:00 [INF] Authorize endpoint response
{"SubjectId":"2","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeIKHzK2H2b9NwyTTdp0jZhTAfzb5MVNlhmhwpyYho1lhuNa_YzDQe3xU1lyzVcWh_OvE1Inqmm__MUi32nQVBw1340Zn30JZaRCcRWkiSTG0tEO_stiFkY9V-R-yotgkHfbD1JJ2fav_EgpLIIwUy90kwlQuUP0SbiMwa_N-cdFLkIsy9hhHMIQUMQPt5Xlkr69uEBxvEZ0eybXRzCUUVSnemfsBYWWwewLbjNC3Av2VcpSb6lQpGCnHM9-a4n2SEYmnEo0a2ZGKxkzUC9g4FR6JqttzGa_oDTGdqY3RMR3DJ6oVFyhhdvp8WcZNlOCcr4","Scope":"openid profile api1 offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-05-02 11:35:09.009 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:35:09.010 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:35:09.010 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:35:09.010 +01:00 [DBG] Start token request.
2020-05-02 11:35:09.010 +01:00 [DBG] Start client validation
2020-05-02 11:35:09.010 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:35:09.010 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 11:35:09.010 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 11:35:09.010 +01:00 [DBG] Secret id found: mvc
2020-05-02 11:35:09.013 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:35:09.013 +01:00 [DBG] Client validation success
2020-05-02 11:35:09.013 +01:00 [DBG] Start token request validation
2020-05-02 11:35:09.019 +01:00 [DBG] Start validation of authorization code token request
2020-05-02 11:35:09.045 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2020-05-02 11:35:09.046 +01:00 [DBG] Validation of authorization code token request success
2020-05-02 11:35:09.046 +01:00 [INF] Token request validation success
{"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"49464316133ace191e22264d028d761fdbd3979b85f6f9b37983dfad05aa463a","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"49464316133ace191e22264d028d761fdbd3979b85f6f9b37983dfad05aa463a","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:35:09.059 +01:00 [DBG] Getting claims for access token for client: mvc
2020-05-02 11:35:09.059 +01:00 [DBG] Getting claims for access token for subject: 2
2020-05-02 11:35:09.059 +01:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:35:09.059 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:35:09.064 +01:00 [DBG] Creating refresh token
2020-05-02 11:35:09.064 +01:00 [DBG] Setting an absolute lifetime: 2592000
2020-05-02 11:35:09.082 +01:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2020-05-02 11:35:09.083 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2020-05-02 11:35:09.085 +01:00 [DBG] Token request success.
2020-05-02 11:35:09.095 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-05-02 11:35:09.096 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-05-02 11:35:09.096 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-05-02 11:35:09.101 +01:00 [DBG] Start userinfo request
2020-05-02 11:35:09.104 +01:00 [DBG] Bearer token found in header
2020-05-02 11:35:09.127 +01:00 [DBG] IsActive called from: AccessTokenValidation
2020-05-02 11:35:09.128 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-05-02 11:35:09.129 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1588415709,"exp":1588419309,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvc","sub":"2","auth_time":1588415585,"idp":"local","name":"Bob","website":"https://bob.com","scope":["openid","profile","api1","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-05-02 11:35:09.129 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2020-05-02 11:35:09.133 +01:00 [DBG] Creating userinfo response
2020-05-02 11:35:09.135 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:35:09.137 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:35:09.141 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2020-05-02 11:35:09.141 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:35:09.143 +01:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2020-05-02 11:35:09.143 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:35:09.144 +01:00 [INF] Profile service returned the following claim types: name website
2020-05-02 11:35:09.144 +01:00 [DBG] End userinfo request
2020-05-02 11:35:37.028 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 11:35:37.390 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 11:35:37.390 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 11:35:37.390 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 11:35:37.390 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 11:35:37.390 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 11:35:37.390 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 11:35:37.903 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 11:35:37.904 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 11:35:37.904 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 11:35:37.904 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 11:35:37.904 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 11:35:37.904 +01:00 [DBG] Error Url: /home/error
2020-05-02 11:35:37.904 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 11:35:37.931 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:35:37.937 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:35:37.938 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:35:37.940 +01:00 [DBG] Start discovery request
2020-05-02 11:35:38.198 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:35:38.198 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:35:38.198 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:35:38.201 +01:00 [DBG] Start key discovery request
2020-05-02 11:35:38.405 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:35:38.409 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:35:38.409 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:35:38.414 +01:00 [DBG] Start token request.
2020-05-02 11:35:38.419 +01:00 [DBG] Start client validation
2020-05-02 11:35:38.423 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:35:38.426 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 11:35:38.438 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 11:35:38.438 +01:00 [DBG] Secret id found: ro.client
2020-05-02 11:35:38.511 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:35:38.511 +01:00 [DBG] Client validation success
2020-05-02 11:35:38.517 +01:00 [DBG] Start token request validation
2020-05-02 11:35:38.526 +01:00 [DBG] Start resource owner password token request validation
2020-05-02 11:35:38.609 +01:00 [DBG] IsActive called from: ResourceOwnerValidation
2020-05-02 11:35:38.609 +01:00 [DBG] Resource owner password token request validation success.
2020-05-02 11:35:38.618 +01:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"username":"alice","password":"***REDACTED***","scope":"api1","grant_type":"password","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:35:38.641 +01:00 [DBG] Getting claims for access token for client: ro.client
2020-05-02 11:35:38.642 +01:00 [DBG] Getting claims for access token for subject: 1
2020-05-02 11:35:38.647 +01:00 [DBG] Get profile called for subject 1 from client ro.client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:35:38.649 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:35:38.696 +01:00 [DBG] Token request success.
2020-05-02 11:35:38.861 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:35:38.862 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:35:38.862 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:35:38.862 +01:00 [DBG] Start discovery request
2020-05-02 11:35:38.954 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:35:38.955 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:35:38.955 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:35:38.955 +01:00 [DBG] Start key discovery request
2020-05-02 11:35:39.562 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:35:39.562 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:35:39.562 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:35:39.562 +01:00 [DBG] Start discovery request
2020-05-02 11:35:39.645 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:35:39.646 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:35:39.646 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:35:39.646 +01:00 [DBG] Start key discovery request
2020-05-02 11:35:39.676 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-05-02 11:35:39.678 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-05-02 11:35:39.678 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-05-02 11:35:39.680 +01:00 [DBG] Start authorize request
2020-05-02 11:35:39.685 +01:00 [DBG] User in authorize request: 2
2020-05-02 11:35:39.688 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:35:39.697 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:35:39.698 +01:00 [DBG] No PKCE used.
2020-05-02 11:35:39.723 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:35:39.725 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeKA4-BR20TSe8kRhUKP9b2uf_iB-ei0OcxPveeuB_K9-noQvGzoeJE_GCRwOInHB3XiX9qne-DUCdsDgL2Rw22ImviGA3hebrq6uwvCfSjLpAyzgFMr0SjyclwNQWdzyCcmIc8BvT75p6eoo1quqlsQ6xRaYgY2jvxTq9myZ5a4cTmVreTO94zydLVWNDzGlCy88RwGzYtKur-m0K6gFkWt5swfKp3DkcX-xu05h-Ja4ZkGZkM17-peOLIc34yrztAXXvo_ydjQ15uQxVh7wNF-FupNNnzpdYCOf1krt1fruJJClf64TPA65cQNThBjfVc","UiLocales":null,"Nonce":"637240125396571896.YjE4NTkxZTctZGI5Yy00OWUzLTllNzYtMGQ0ZWVjMjVkZjk1OGMzOWUwZjItNGRkZS00MmQ5LWI5MzYtM2Q5NzQ1NGUwNmY2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"cd385e5aefe2c8df88dfc42d79096f02","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240125396571896.YjE4NTkxZTctZGI5Yy00OWUzLTllNzYtMGQ0ZWVjMjVkZjk1OGMzOWUwZjItNGRkZS00MmQ5LWI5MzYtM2Q5NzQ1NGUwNmY2","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeKA4-BR20TSe8kRhUKP9b2uf_iB-ei0OcxPveeuB_K9-noQvGzoeJE_GCRwOInHB3XiX9qne-DUCdsDgL2Rw22ImviGA3hebrq6uwvCfSjLpAyzgFMr0SjyclwNQWdzyCcmIc8BvT75p6eoo1quqlsQ6xRaYgY2jvxTq9myZ5a4cTmVreTO94zydLVWNDzGlCy88RwGzYtKur-m0K6gFkWt5swfKp3DkcX-xu05h-Ja4ZkGZkM17-peOLIc34yrztAXXvo_ydjQ15uQxVh7wNF-FupNNnzpdYCOf1krt1fruJJClf64TPA65cQNThBjfVc","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 11:35:39.731 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2020-05-02 11:35:39.737 +01:00 [DBG] Scopes contains offline_access, consent is required
2020-05-02 11:35:39.737 +01:00 [INF] Showing consent: User has not yet consented
2020-05-02 11:35:39.785 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:35:39.788 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:35:39.788 +01:00 [DBG] No PKCE used.
2020-05-02 11:35:39.805 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:35:41.185 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-05-02 11:35:41.207 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:35:41.210 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:35:41.210 +01:00 [DBG] No PKCE used.
2020-05-02 11:35:41.227 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:35:41.245 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-05-02 11:35:41.246 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-05-02 11:35:41.246 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-05-02 11:35:41.250 +01:00 [DBG] Start authorize callback request
2020-05-02 11:35:41.253 +01:00 [DBG] User in authorize request: 2
2020-05-02 11:35:41.253 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:35:41.256 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:35:41.256 +01:00 [DBG] No PKCE used.
2020-05-02 11:35:41.270 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:35:41.270 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeKA4-BR20TSe8kRhUKP9b2uf_iB-ei0OcxPveeuB_K9-noQvGzoeJE_GCRwOInHB3XiX9qne-DUCdsDgL2Rw22ImviGA3hebrq6uwvCfSjLpAyzgFMr0SjyclwNQWdzyCcmIc8BvT75p6eoo1quqlsQ6xRaYgY2jvxTq9myZ5a4cTmVreTO94zydLVWNDzGlCy88RwGzYtKur-m0K6gFkWt5swfKp3DkcX-xu05h-Ja4ZkGZkM17-peOLIc34yrztAXXvo_ydjQ15uQxVh7wNF-FupNNnzpdYCOf1krt1fruJJClf64TPA65cQNThBjfVc","UiLocales":null,"Nonce":"637240125396571896.YjE4NTkxZTctZGI5Yy00OWUzLTllNzYtMGQ0ZWVjMjVkZjk1OGMzOWUwZjItNGRkZS00MmQ5LWI5MzYtM2Q5NzQ1NGUwNmY2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"cd385e5aefe2c8df88dfc42d79096f02","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240125396571896.YjE4NTkxZTctZGI5Yy00OWUzLTllNzYtMGQ0ZWVjMjVkZjk1OGMzOWUwZjItNGRkZS00MmQ5LWI5MzYtM2Q5NzQ1NGUwNmY2","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeKA4-BR20TSe8kRhUKP9b2uf_iB-ei0OcxPveeuB_K9-noQvGzoeJE_GCRwOInHB3XiX9qne-DUCdsDgL2Rw22ImviGA3hebrq6uwvCfSjLpAyzgFMr0SjyclwNQWdzyCcmIc8BvT75p6eoo1quqlsQ6xRaYgY2jvxTq9myZ5a4cTmVreTO94zydLVWNDzGlCy88RwGzYtKur-m0K6gFkWt5swfKp3DkcX-xu05h-Ja4ZkGZkM17-peOLIc34yrztAXXvo_ydjQ15uQxVh7wNF-FupNNnzpdYCOf1krt1fruJJClf64TPA65cQNThBjfVc","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 11:35:41.270 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2020-05-02 11:35:41.270 +01:00 [DBG] Scopes contains offline_access, consent is required
2020-05-02 11:35:41.274 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2020-05-02 11:35:41.274 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2020-05-02 11:35:41.277 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 2
2020-05-02 11:35:41.343 +01:00 [DBG] Creating Hybrid Flow response.
2020-05-02 11:35:41.361 +01:00 [DBG] Creating Implicit Flow response.
2020-05-02 11:35:41.367 +01:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2020-05-02 11:35:41.367 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2020-05-02 11:35:41.373 +01:00 [INF] Authorize endpoint response
{"SubjectId":"2","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeKA4-BR20TSe8kRhUKP9b2uf_iB-ei0OcxPveeuB_K9-noQvGzoeJE_GCRwOInHB3XiX9qne-DUCdsDgL2Rw22ImviGA3hebrq6uwvCfSjLpAyzgFMr0SjyclwNQWdzyCcmIc8BvT75p6eoo1quqlsQ6xRaYgY2jvxTq9myZ5a4cTmVreTO94zydLVWNDzGlCy88RwGzYtKur-m0K6gFkWt5swfKp3DkcX-xu05h-Ja4ZkGZkM17-peOLIc34yrztAXXvo_ydjQ15uQxVh7wNF-FupNNnzpdYCOf1krt1fruJJClf64TPA65cQNThBjfVc","Scope":"openid profile api1 offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-05-02 11:35:41.483 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:35:41.484 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:35:41.484 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:35:41.484 +01:00 [DBG] Start token request.
2020-05-02 11:35:41.484 +01:00 [DBG] Start client validation
2020-05-02 11:35:41.484 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:35:41.484 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 11:35:41.484 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 11:35:41.484 +01:00 [DBG] Secret id found: mvc
2020-05-02 11:35:41.487 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:35:41.487 +01:00 [DBG] Client validation success
2020-05-02 11:35:41.487 +01:00 [DBG] Start token request validation
2020-05-02 11:35:41.493 +01:00 [DBG] Start validation of authorization code token request
2020-05-02 11:35:41.520 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2020-05-02 11:35:41.520 +01:00 [DBG] Validation of authorization code token request success
2020-05-02 11:35:41.520 +01:00 [INF] Token request validation success
{"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"0b53c0717147c8a597cd6b210b1e3953dcddd2751752dfbaf74836c8a2613755","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"0b53c0717147c8a597cd6b210b1e3953dcddd2751752dfbaf74836c8a2613755","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:35:41.532 +01:00 [DBG] Getting claims for access token for client: mvc
2020-05-02 11:35:41.533 +01:00 [DBG] Getting claims for access token for subject: 2
2020-05-02 11:35:41.533 +01:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:35:41.533 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:35:41.537 +01:00 [DBG] Creating refresh token
2020-05-02 11:35:41.537 +01:00 [DBG] Setting an absolute lifetime: 2592000
2020-05-02 11:35:41.556 +01:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2020-05-02 11:35:41.557 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2020-05-02 11:35:41.559 +01:00 [DBG] Token request success.
2020-05-02 11:35:41.565 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-05-02 11:35:41.566 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-05-02 11:35:41.566 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-05-02 11:35:41.570 +01:00 [DBG] Start userinfo request
2020-05-02 11:35:41.573 +01:00 [DBG] Bearer token found in header
2020-05-02 11:35:41.597 +01:00 [DBG] IsActive called from: AccessTokenValidation
2020-05-02 11:35:41.597 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-05-02 11:35:41.598 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1588415741,"exp":1588419341,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvc","sub":"2","auth_time":1588415585,"idp":"local","name":"Bob","website":"https://bob.com","scope":["openid","profile","api1","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-05-02 11:35:41.599 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2020-05-02 11:35:41.603 +01:00 [DBG] Creating userinfo response
2020-05-02 11:35:41.606 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:35:41.608 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:35:41.612 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2020-05-02 11:35:41.612 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:35:41.614 +01:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2020-05-02 11:35:41.614 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:35:41.614 +01:00 [INF] Profile service returned the following claim types: name website
2020-05-02 11:35:41.614 +01:00 [DBG] End userinfo request
2020-05-02 11:36:18.731 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 11:36:19.095 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 11:36:19.095 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 11:36:19.095 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 11:36:19.095 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 11:36:19.095 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 11:36:19.095 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 11:36:19.740 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 11:36:19.742 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 11:36:19.742 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 11:36:19.742 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 11:36:19.742 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 11:36:19.742 +01:00 [DBG] Error Url: /home/error
2020-05-02 11:36:19.742 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 11:36:19.766 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:36:19.771 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:36:19.771 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:36:19.773 +01:00 [DBG] Start discovery request
2020-05-02 11:36:20.018 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:36:20.019 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:36:20.019 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:36:20.021 +01:00 [DBG] Start key discovery request
2020-05-02 11:36:20.225 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:36:20.229 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:36:20.229 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:36:20.235 +01:00 [DBG] Start token request.
2020-05-02 11:36:20.239 +01:00 [DBG] Start client validation
2020-05-02 11:36:20.243 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:36:20.246 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 11:36:20.258 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 11:36:20.258 +01:00 [DBG] Secret id found: ro.client
2020-05-02 11:36:20.330 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:36:20.330 +01:00 [DBG] Client validation success
2020-05-02 11:36:20.336 +01:00 [DBG] Start token request validation
2020-05-02 11:36:20.345 +01:00 [DBG] Start resource owner password token request validation
2020-05-02 11:36:20.422 +01:00 [DBG] IsActive called from: ResourceOwnerValidation
2020-05-02 11:36:20.423 +01:00 [DBG] Resource owner password token request validation success.
2020-05-02 11:36:20.433 +01:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"username":"alice","password":"***REDACTED***","scope":"api1","grant_type":"password","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:36:20.457 +01:00 [DBG] Getting claims for access token for client: ro.client
2020-05-02 11:36:20.458 +01:00 [DBG] Getting claims for access token for subject: 1
2020-05-02 11:36:20.463 +01:00 [DBG] Get profile called for subject 1 from client ro.client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:36:20.466 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:36:20.510 +01:00 [DBG] Token request success.
2020-05-02 11:36:20.689 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:36:20.689 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:36:20.689 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:36:20.690 +01:00 [DBG] Start discovery request
2020-05-02 11:36:20.782 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:36:20.783 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:36:20.783 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:36:20.783 +01:00 [DBG] Start key discovery request
2020-05-02 11:36:20.987 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:36:20.987 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:36:20.987 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:36:20.988 +01:00 [DBG] Start discovery request
2020-05-02 11:36:21.071 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:36:21.071 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:36:21.071 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:36:21.071 +01:00 [DBG] Start key discovery request
2020-05-02 11:36:21.105 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-05-02 11:36:21.106 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-05-02 11:36:21.106 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-05-02 11:36:21.109 +01:00 [DBG] Start authorize request
2020-05-02 11:36:21.115 +01:00 [DBG] User in authorize request: 2
2020-05-02 11:36:21.118 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:36:21.127 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:36:21.128 +01:00 [DBG] No PKCE used.
2020-05-02 11:36:21.153 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:36:21.155 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeIBpZfbIZGt3cD4iMOt1DRNzaA8cxloyOEZuBmfs632oMCOLDbMh92fo-Msya9JpmhIxGj1HtxvXScdK8VmqpNt5hq29U2jwnZQwxSXqk3JVocF1gBRUVxpePri5FBmvhoCHbTTaitpGJCCuxSa1hP1pk2XJxhvzjeJjit7Vfns9_KGER-GFIzBa32QErzgmAhq6d-vnyV8_8T0bOZVGWD1M5cybCX1Go5iaR83fvygQjEB50L7m0vH19lPH34Yd1OUJO4P4oRU507h8KmY4LSvjmPvLsoqu8dNoq1DaJEmboApGWoSn4GDOJigTs2WAcQ","UiLocales":null,"Nonce":"637240125810828676.MWNjYzBkZjgtZDM4Yi00MGI2LThmN2QtYzdlYTIzZDcxOTFjNDlhZDE5MzItNDIyZS00MGVjLThhMDUtMjZmY2Y5MzNjYjEw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"cd385e5aefe2c8df88dfc42d79096f02","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240125810828676.MWNjYzBkZjgtZDM4Yi00MGI2LThmN2QtYzdlYTIzZDcxOTFjNDlhZDE5MzItNDIyZS00MGVjLThhMDUtMjZmY2Y5MzNjYjEw","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeIBpZfbIZGt3cD4iMOt1DRNzaA8cxloyOEZuBmfs632oMCOLDbMh92fo-Msya9JpmhIxGj1HtxvXScdK8VmqpNt5hq29U2jwnZQwxSXqk3JVocF1gBRUVxpePri5FBmvhoCHbTTaitpGJCCuxSa1hP1pk2XJxhvzjeJjit7Vfns9_KGER-GFIzBa32QErzgmAhq6d-vnyV8_8T0bOZVGWD1M5cybCX1Go5iaR83fvygQjEB50L7m0vH19lPH34Yd1OUJO4P4oRU507h8KmY4LSvjmPvLsoqu8dNoq1DaJEmboApGWoSn4GDOJigTs2WAcQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 11:36:21.161 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2020-05-02 11:36:21.168 +01:00 [DBG] Scopes contains offline_access, consent is required
2020-05-02 11:36:21.168 +01:00 [INF] Showing consent: User has not yet consented
2020-05-02 11:36:21.215 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:36:21.218 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:36:21.218 +01:00 [DBG] No PKCE used.
2020-05-02 11:36:21.233 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:36:22.682 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-05-02 11:36:22.704 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:36:22.707 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:36:22.707 +01:00 [DBG] No PKCE used.
2020-05-02 11:36:22.722 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:36:22.740 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-05-02 11:36:22.741 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-05-02 11:36:22.741 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-05-02 11:36:22.745 +01:00 [DBG] Start authorize callback request
2020-05-02 11:36:22.748 +01:00 [DBG] User in authorize request: 2
2020-05-02 11:36:22.748 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:36:22.751 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:36:22.751 +01:00 [DBG] No PKCE used.
2020-05-02 11:36:22.765 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:36:22.765 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeIBpZfbIZGt3cD4iMOt1DRNzaA8cxloyOEZuBmfs632oMCOLDbMh92fo-Msya9JpmhIxGj1HtxvXScdK8VmqpNt5hq29U2jwnZQwxSXqk3JVocF1gBRUVxpePri5FBmvhoCHbTTaitpGJCCuxSa1hP1pk2XJxhvzjeJjit7Vfns9_KGER-GFIzBa32QErzgmAhq6d-vnyV8_8T0bOZVGWD1M5cybCX1Go5iaR83fvygQjEB50L7m0vH19lPH34Yd1OUJO4P4oRU507h8KmY4LSvjmPvLsoqu8dNoq1DaJEmboApGWoSn4GDOJigTs2WAcQ","UiLocales":null,"Nonce":"637240125810828676.MWNjYzBkZjgtZDM4Yi00MGI2LThmN2QtYzdlYTIzZDcxOTFjNDlhZDE5MzItNDIyZS00MGVjLThhMDUtMjZmY2Y5MzNjYjEw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"cd385e5aefe2c8df88dfc42d79096f02","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240125810828676.MWNjYzBkZjgtZDM4Yi00MGI2LThmN2QtYzdlYTIzZDcxOTFjNDlhZDE5MzItNDIyZS00MGVjLThhMDUtMjZmY2Y5MzNjYjEw","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeIBpZfbIZGt3cD4iMOt1DRNzaA8cxloyOEZuBmfs632oMCOLDbMh92fo-Msya9JpmhIxGj1HtxvXScdK8VmqpNt5hq29U2jwnZQwxSXqk3JVocF1gBRUVxpePri5FBmvhoCHbTTaitpGJCCuxSa1hP1pk2XJxhvzjeJjit7Vfns9_KGER-GFIzBa32QErzgmAhq6d-vnyV8_8T0bOZVGWD1M5cybCX1Go5iaR83fvygQjEB50L7m0vH19lPH34Yd1OUJO4P4oRU507h8KmY4LSvjmPvLsoqu8dNoq1DaJEmboApGWoSn4GDOJigTs2WAcQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 11:36:22.765 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2020-05-02 11:36:22.765 +01:00 [DBG] Scopes contains offline_access, consent is required
2020-05-02 11:36:22.770 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2020-05-02 11:36:22.770 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2020-05-02 11:36:22.772 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 2
2020-05-02 11:36:22.839 +01:00 [DBG] Creating Hybrid Flow response.
2020-05-02 11:36:22.856 +01:00 [DBG] Creating Implicit Flow response.
2020-05-02 11:36:22.862 +01:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2020-05-02 11:36:22.862 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2020-05-02 11:36:22.869 +01:00 [INF] Authorize endpoint response
{"SubjectId":"2","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeIBpZfbIZGt3cD4iMOt1DRNzaA8cxloyOEZuBmfs632oMCOLDbMh92fo-Msya9JpmhIxGj1HtxvXScdK8VmqpNt5hq29U2jwnZQwxSXqk3JVocF1gBRUVxpePri5FBmvhoCHbTTaitpGJCCuxSa1hP1pk2XJxhvzjeJjit7Vfns9_KGER-GFIzBa32QErzgmAhq6d-vnyV8_8T0bOZVGWD1M5cybCX1Go5iaR83fvygQjEB50L7m0vH19lPH34Yd1OUJO4P4oRU507h8KmY4LSvjmPvLsoqu8dNoq1DaJEmboApGWoSn4GDOJigTs2WAcQ","Scope":"openid profile api1 offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-05-02 11:36:22.999 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:36:23.000 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:36:23.000 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:36:23.000 +01:00 [DBG] Start token request.
2020-05-02 11:36:23.000 +01:00 [DBG] Start client validation
2020-05-02 11:36:23.000 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:36:23.000 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 11:36:23.000 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 11:36:23.000 +01:00 [DBG] Secret id found: mvc
2020-05-02 11:36:23.003 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:36:23.003 +01:00 [DBG] Client validation success
2020-05-02 11:36:23.003 +01:00 [DBG] Start token request validation
2020-05-02 11:36:23.009 +01:00 [DBG] Start validation of authorization code token request
2020-05-02 11:36:23.038 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2020-05-02 11:36:23.038 +01:00 [DBG] Validation of authorization code token request success
2020-05-02 11:36:23.038 +01:00 [INF] Token request validation success
{"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"97619992789c24b2ddbd1fe2f285226fd23a6fa66c7dc00c25254ea3ceed5a30","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"97619992789c24b2ddbd1fe2f285226fd23a6fa66c7dc00c25254ea3ceed5a30","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:36:23.051 +01:00 [DBG] Getting claims for access token for client: mvc
2020-05-02 11:36:23.052 +01:00 [DBG] Getting claims for access token for subject: 2
2020-05-02 11:36:23.052 +01:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:36:23.052 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:36:23.056 +01:00 [DBG] Creating refresh token
2020-05-02 11:36:23.056 +01:00 [DBG] Setting an absolute lifetime: 2592000
2020-05-02 11:36:23.076 +01:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2020-05-02 11:36:23.076 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2020-05-02 11:36:23.079 +01:00 [DBG] Token request success.
2020-05-02 11:36:23.086 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-05-02 11:36:23.087 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-05-02 11:36:23.087 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-05-02 11:36:23.092 +01:00 [DBG] Start userinfo request
2020-05-02 11:36:23.094 +01:00 [DBG] Bearer token found in header
2020-05-02 11:36:23.120 +01:00 [DBG] IsActive called from: AccessTokenValidation
2020-05-02 11:36:23.120 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-05-02 11:36:23.121 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1588415783,"exp":1588419383,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvc","sub":"2","auth_time":1588415585,"idp":"local","name":"Bob","website":"https://bob.com","scope":["openid","profile","api1","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-05-02 11:36:23.122 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2020-05-02 11:36:23.126 +01:00 [DBG] Creating userinfo response
2020-05-02 11:36:23.129 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:36:23.131 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:36:23.135 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2020-05-02 11:36:23.135 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:36:23.137 +01:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2020-05-02 11:36:23.137 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:36:23.137 +01:00 [INF] Profile service returned the following claim types: name website
2020-05-02 11:36:23.138 +01:00 [DBG] End userinfo request
2020-05-02 11:36:57.709 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 11:36:58.076 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 11:36:58.076 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 11:36:58.076 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 11:36:58.077 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 11:36:58.077 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 11:36:58.077 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 11:36:58.708 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 11:36:58.709 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 11:36:58.709 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 11:36:58.709 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 11:36:58.709 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 11:36:58.709 +01:00 [DBG] Error Url: /home/error
2020-05-02 11:36:58.709 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 11:36:58.742 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:36:58.748 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:36:58.748 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:36:58.751 +01:00 [DBG] Start discovery request
2020-05-02 11:36:58.994 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:36:58.994 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:36:58.994 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:36:58.998 +01:00 [DBG] Start key discovery request
2020-05-02 11:36:59.200 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:36:59.203 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:36:59.203 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:36:59.209 +01:00 [DBG] Start token request.
2020-05-02 11:36:59.213 +01:00 [DBG] Start client validation
2020-05-02 11:36:59.216 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:36:59.219 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 11:36:59.230 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 11:36:59.230 +01:00 [DBG] Secret id found: ro.client
2020-05-02 11:36:59.301 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:36:59.301 +01:00 [DBG] Client validation success
2020-05-02 11:36:59.308 +01:00 [DBG] Start token request validation
2020-05-02 11:36:59.321 +01:00 [DBG] Start resource owner password token request validation
2020-05-02 11:36:59.403 +01:00 [DBG] IsActive called from: ResourceOwnerValidation
2020-05-02 11:36:59.403 +01:00 [DBG] Resource owner password token request validation success.
2020-05-02 11:36:59.410 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:36:59.411 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:36:59.411 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:36:59.411 +01:00 [DBG] Start discovery request
2020-05-02 11:36:59.413 +01:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"username":"alice","password":"***REDACTED***","scope":"api1","grant_type":"password","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:36:59.439 +01:00 [DBG] Getting claims for access token for client: ro.client
2020-05-02 11:36:59.439 +01:00 [DBG] Getting claims for access token for subject: 1
2020-05-02 11:36:59.444 +01:00 [DBG] Get profile called for subject 1 from client ro.client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:36:59.447 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:36:59.493 +01:00 [DBG] Token request success.
2020-05-02 11:36:59.497 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:36:59.497 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:36:59.497 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:36:59.497 +01:00 [DBG] Start key discovery request
2020-05-02 11:36:59.529 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-05-02 11:36:59.531 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-05-02 11:36:59.531 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-05-02 11:36:59.534 +01:00 [DBG] Start authorize request
2020-05-02 11:36:59.540 +01:00 [DBG] User in authorize request: 2
2020-05-02 11:36:59.543 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:36:59.553 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:36:59.555 +01:00 [DBG] No PKCE used.
2020-05-02 11:36:59.582 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:36:59.584 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeIFL4n8qLoguLDoDruCUMdw4tKsdQZmWYcjQw6OJexB0E_51RZTZDKZ3QHgXKGZ1-fr3CfSzrBr0Sbjru4M-GGLct1zuJ9aTf1ZrX99oWnplU1pofVBS3U93l8nPvKSUmG0KmaTJCMYzu0hAPxlf_x8Us6ubNppdvYHLve5a8lHicRzBJgLnhHcdmVqpNRm3pAVJctm8xhvwQWyi9h5wmYAa9ZOSP_3bWDsIqKrgFHUNQlKwyaJIFNpUWnRbpuupf1-Wb7FwRnw9s_GZ089nskckwU8il8TkntxoT1stANhE_Te43pGDalH45EYdFFz02o","UiLocales":null,"Nonce":"637240126195091721.MzEzMzUwNjYtYmJiOC00MWQwLTllNWQtOWQyMjcwOTQ5MDY3YmJiZWFlYjgtY2YwYy00NDY0LTk0NmItMmRiMTEwY2U1NWI3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"cd385e5aefe2c8df88dfc42d79096f02","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240126195091721.MzEzMzUwNjYtYmJiOC00MWQwLTllNWQtOWQyMjcwOTQ5MDY3YmJiZWFlYjgtY2YwYy00NDY0LTk0NmItMmRiMTEwY2U1NWI3","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeIFL4n8qLoguLDoDruCUMdw4tKsdQZmWYcjQw6OJexB0E_51RZTZDKZ3QHgXKGZ1-fr3CfSzrBr0Sbjru4M-GGLct1zuJ9aTf1ZrX99oWnplU1pofVBS3U93l8nPvKSUmG0KmaTJCMYzu0hAPxlf_x8Us6ubNppdvYHLve5a8lHicRzBJgLnhHcdmVqpNRm3pAVJctm8xhvwQWyi9h5wmYAa9ZOSP_3bWDsIqKrgFHUNQlKwyaJIFNpUWnRbpuupf1-Wb7FwRnw9s_GZ089nskckwU8il8TkntxoT1stANhE_Te43pGDalH45EYdFFz02o","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 11:36:59.590 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2020-05-02 11:36:59.597 +01:00 [DBG] Scopes contains offline_access, consent is required
2020-05-02 11:36:59.597 +01:00 [INF] Showing consent: User has not yet consented
2020-05-02 11:36:59.646 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:36:59.649 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:36:59.649 +01:00 [DBG] No PKCE used.
2020-05-02 11:36:59.665 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:36:59.668 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:36:59.668 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:36:59.669 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:36:59.669 +01:00 [DBG] Start discovery request
2020-05-02 11:36:59.770 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:36:59.770 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:36:59.770 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:36:59.770 +01:00 [DBG] Start key discovery request
2020-05-02 11:37:01.213 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-05-02 11:37:01.237 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:37:01.239 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:37:01.239 +01:00 [DBG] No PKCE used.
2020-05-02 11:37:01.255 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:37:01.274 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-05-02 11:37:01.274 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-05-02 11:37:01.274 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-05-02 11:37:01.278 +01:00 [DBG] Start authorize callback request
2020-05-02 11:37:01.281 +01:00 [DBG] User in authorize request: 2
2020-05-02 11:37:01.281 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:37:01.284 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:37:01.284 +01:00 [DBG] No PKCE used.
2020-05-02 11:37:01.297 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:37:01.297 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeIFL4n8qLoguLDoDruCUMdw4tKsdQZmWYcjQw6OJexB0E_51RZTZDKZ3QHgXKGZ1-fr3CfSzrBr0Sbjru4M-GGLct1zuJ9aTf1ZrX99oWnplU1pofVBS3U93l8nPvKSUmG0KmaTJCMYzu0hAPxlf_x8Us6ubNppdvYHLve5a8lHicRzBJgLnhHcdmVqpNRm3pAVJctm8xhvwQWyi9h5wmYAa9ZOSP_3bWDsIqKrgFHUNQlKwyaJIFNpUWnRbpuupf1-Wb7FwRnw9s_GZ089nskckwU8il8TkntxoT1stANhE_Te43pGDalH45EYdFFz02o","UiLocales":null,"Nonce":"637240126195091721.MzEzMzUwNjYtYmJiOC00MWQwLTllNWQtOWQyMjcwOTQ5MDY3YmJiZWFlYjgtY2YwYy00NDY0LTk0NmItMmRiMTEwY2U1NWI3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"cd385e5aefe2c8df88dfc42d79096f02","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240126195091721.MzEzMzUwNjYtYmJiOC00MWQwLTllNWQtOWQyMjcwOTQ5MDY3YmJiZWFlYjgtY2YwYy00NDY0LTk0NmItMmRiMTEwY2U1NWI3","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeIFL4n8qLoguLDoDruCUMdw4tKsdQZmWYcjQw6OJexB0E_51RZTZDKZ3QHgXKGZ1-fr3CfSzrBr0Sbjru4M-GGLct1zuJ9aTf1ZrX99oWnplU1pofVBS3U93l8nPvKSUmG0KmaTJCMYzu0hAPxlf_x8Us6ubNppdvYHLve5a8lHicRzBJgLnhHcdmVqpNRm3pAVJctm8xhvwQWyi9h5wmYAa9ZOSP_3bWDsIqKrgFHUNQlKwyaJIFNpUWnRbpuupf1-Wb7FwRnw9s_GZ089nskckwU8il8TkntxoT1stANhE_Te43pGDalH45EYdFFz02o","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 11:37:01.297 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2020-05-02 11:37:01.297 +01:00 [DBG] Scopes contains offline_access, consent is required
2020-05-02 11:37:01.302 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2020-05-02 11:37:01.302 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2020-05-02 11:37:01.304 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 2
2020-05-02 11:37:01.371 +01:00 [DBG] Creating Hybrid Flow response.
2020-05-02 11:37:01.388 +01:00 [DBG] Creating Implicit Flow response.
2020-05-02 11:37:01.394 +01:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2020-05-02 11:37:01.395 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2020-05-02 11:37:01.401 +01:00 [INF] Authorize endpoint response
{"SubjectId":"2","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeIFL4n8qLoguLDoDruCUMdw4tKsdQZmWYcjQw6OJexB0E_51RZTZDKZ3QHgXKGZ1-fr3CfSzrBr0Sbjru4M-GGLct1zuJ9aTf1ZrX99oWnplU1pofVBS3U93l8nPvKSUmG0KmaTJCMYzu0hAPxlf_x8Us6ubNppdvYHLve5a8lHicRzBJgLnhHcdmVqpNRm3pAVJctm8xhvwQWyi9h5wmYAa9ZOSP_3bWDsIqKrgFHUNQlKwyaJIFNpUWnRbpuupf1-Wb7FwRnw9s_GZ089nskckwU8il8TkntxoT1stANhE_Te43pGDalH45EYdFFz02o","Scope":"openid profile api1 offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-05-02 11:37:01.528 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:37:01.529 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:37:01.529 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:37:01.529 +01:00 [DBG] Start token request.
2020-05-02 11:37:01.529 +01:00 [DBG] Start client validation
2020-05-02 11:37:01.529 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:37:01.529 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 11:37:01.529 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 11:37:01.529 +01:00 [DBG] Secret id found: mvc
2020-05-02 11:37:01.533 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:37:01.533 +01:00 [DBG] Client validation success
2020-05-02 11:37:01.533 +01:00 [DBG] Start token request validation
2020-05-02 11:37:01.539 +01:00 [DBG] Start validation of authorization code token request
2020-05-02 11:37:01.568 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2020-05-02 11:37:01.568 +01:00 [DBG] Validation of authorization code token request success
2020-05-02 11:37:01.568 +01:00 [INF] Token request validation success
{"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"0284eab11744db6a5cc2448f897e969d4a9577d897e837342d0ea0109ac3b5e9","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"0284eab11744db6a5cc2448f897e969d4a9577d897e837342d0ea0109ac3b5e9","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:37:01.582 +01:00 [DBG] Getting claims for access token for client: mvc
2020-05-02 11:37:01.582 +01:00 [DBG] Getting claims for access token for subject: 2
2020-05-02 11:37:01.582 +01:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:37:01.582 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:37:01.587 +01:00 [DBG] Creating refresh token
2020-05-02 11:37:01.587 +01:00 [DBG] Setting an absolute lifetime: 2592000
2020-05-02 11:37:01.608 +01:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2020-05-02 11:37:01.608 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2020-05-02 11:37:01.611 +01:00 [DBG] Token request success.
2020-05-02 11:37:01.619 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-05-02 11:37:01.620 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-05-02 11:37:01.620 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-05-02 11:37:01.625 +01:00 [DBG] Start userinfo request
2020-05-02 11:37:01.627 +01:00 [DBG] Bearer token found in header
2020-05-02 11:37:01.653 +01:00 [DBG] IsActive called from: AccessTokenValidation
2020-05-02 11:37:01.653 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-05-02 11:37:01.654 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1588415821,"exp":1588419421,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvc","sub":"2","auth_time":1588415585,"idp":"local","name":"Bob","website":"https://bob.com","scope":["openid","profile","api1","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-05-02 11:37:01.655 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2020-05-02 11:37:01.659 +01:00 [DBG] Creating userinfo response
2020-05-02 11:37:01.662 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:37:01.663 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:37:01.669 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2020-05-02 11:37:01.669 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:37:01.671 +01:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2020-05-02 11:37:01.671 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:37:01.671 +01:00 [INF] Profile service returned the following claim types: name website
2020-05-02 11:37:01.671 +01:00 [DBG] End userinfo request
2020-05-02 11:38:11.895 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 11:38:12.282 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 11:38:12.283 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 11:38:12.283 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 11:38:12.283 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 11:38:12.283 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 11:38:12.283 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 11:38:13.021 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 11:38:13.023 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 11:38:13.023 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 11:38:13.023 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 11:38:13.023 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 11:38:13.023 +01:00 [DBG] Error Url: /home/error
2020-05-02 11:38:13.023 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 11:38:13.052 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:38:13.057 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:38:13.057 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:38:13.059 +01:00 [DBG] Start discovery request
2020-05-02 11:38:13.315 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:38:13.316 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:38:13.316 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:38:13.319 +01:00 [DBG] Start key discovery request
2020-05-02 11:38:13.519 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:38:13.522 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:38:13.523 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:38:13.530 +01:00 [DBG] Start token request.
2020-05-02 11:38:13.535 +01:00 [DBG] Start client validation
2020-05-02 11:38:13.539 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:38:13.541 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 11:38:13.553 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 11:38:13.553 +01:00 [DBG] Secret id found: ro.client
2020-05-02 11:38:13.626 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:38:13.627 +01:00 [DBG] Client validation success
2020-05-02 11:38:13.633 +01:00 [DBG] Start token request validation
2020-05-02 11:38:13.643 +01:00 [DBG] Start resource owner password token request validation
2020-05-02 11:38:13.724 +01:00 [DBG] IsActive called from: ResourceOwnerValidation
2020-05-02 11:38:13.724 +01:00 [DBG] Resource owner password token request validation success.
2020-05-02 11:38:13.733 +01:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"username":"alice","password":"***REDACTED***","scope":"api1","grant_type":"password","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:38:13.758 +01:00 [DBG] Getting claims for access token for client: ro.client
2020-05-02 11:38:13.758 +01:00 [DBG] Getting claims for access token for subject: 1
2020-05-02 11:38:13.763 +01:00 [DBG] Get profile called for subject 1 from client ro.client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:38:13.765 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:38:13.813 +01:00 [DBG] Token request success.
2020-05-02 11:38:13.981 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:38:13.981 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:38:13.981 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:38:13.981 +01:00 [DBG] Start discovery request
2020-05-02 11:38:14.081 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:38:14.082 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:38:14.082 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:38:14.082 +01:00 [DBG] Start key discovery request
2020-05-02 11:38:54.367 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 11:38:54.761 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 11:38:54.761 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 11:38:54.761 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 11:38:54.762 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 11:38:54.762 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 11:38:54.762 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 11:38:55.505 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 11:38:55.506 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 11:38:55.506 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 11:38:55.506 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 11:38:55.506 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 11:38:55.506 +01:00 [DBG] Error Url: /home/error
2020-05-02 11:38:55.506 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 11:38:55.532 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:38:55.536 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:38:55.536 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:38:55.539 +01:00 [DBG] Start discovery request
2020-05-02 11:38:55.796 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:38:55.796 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:38:55.796 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:38:55.799 +01:00 [DBG] Start key discovery request
2020-05-02 11:38:56.003 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:38:56.006 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:38:56.007 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:38:56.012 +01:00 [DBG] Start token request.
2020-05-02 11:38:56.016 +01:00 [DBG] Start client validation
2020-05-02 11:38:56.019 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:38:56.022 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 11:38:56.033 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 11:38:56.033 +01:00 [DBG] Secret id found: ro.client
2020-05-02 11:38:56.103 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:38:56.103 +01:00 [DBG] Client validation success
2020-05-02 11:38:56.109 +01:00 [DBG] Start token request validation
2020-05-02 11:38:56.118 +01:00 [DBG] Start resource owner password token request validation
2020-05-02 11:38:56.198 +01:00 [DBG] IsActive called from: ResourceOwnerValidation
2020-05-02 11:38:56.199 +01:00 [DBG] Resource owner password token request validation success.
2020-05-02 11:38:56.207 +01:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"alice","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"username":"alice","password":"***REDACTED***","scope":"api1","grant_type":"password","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:38:56.231 +01:00 [DBG] Getting claims for access token for client: ro.client
2020-05-02 11:38:56.231 +01:00 [DBG] Getting claims for access token for subject: 1
2020-05-02 11:38:56.236 +01:00 [DBG] Get profile called for subject 1 from client ro.client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:38:56.238 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:38:56.283 +01:00 [DBG] Token request success.
2020-05-02 11:38:56.457 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:38:56.458 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:38:56.458 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:38:56.458 +01:00 [DBG] Start discovery request
2020-05-02 11:38:56.559 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:38:56.560 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:38:56.560 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:38:56.560 +01:00 [DBG] Start key discovery request
2020-05-02 11:44:17.744 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 11:44:18.127 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 11:44:18.127 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 11:44:18.127 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 11:44:18.127 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 11:44:18.128 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 11:44:18.128 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 11:44:18.637 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 11:44:18.639 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 11:44:18.639 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 11:44:18.639 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 11:44:18.639 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 11:44:18.639 +01:00 [DBG] Error Url: /home/error
2020-05-02 11:44:18.639 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 11:44:19.380 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:44:19.385 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:44:19.385 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:44:19.388 +01:00 [DBG] Start discovery request
2020-05-02 11:44:19.609 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:44:19.610 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:44:19.610 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:44:19.613 +01:00 [DBG] Start key discovery request
2020-05-02 11:44:19.654 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-05-02 11:44:19.656 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-05-02 11:44:19.656 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-05-02 11:44:19.659 +01:00 [DBG] Start authorize request
2020-05-02 11:44:19.665 +01:00 [DBG] User in authorize request: 2
2020-05-02 11:44:19.668 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:44:19.741 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:44:19.742 +01:00 [DBG] No PKCE used.
2020-05-02 11:44:19.821 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:44:19.831 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeL3hY-HnIXA-wHVkE30AGADqnr6_HlX4YkwLbVIVBcR0ga32Dj4BJILR4ZotP_XeGXOjTG7ECyA7I7KkFCzakP85Vf60tBTPLP1pZBZhApcFgPhNSlUuCqnj8UsW5_HdgBs3jqQBiVgkTW_aKtMBwVOUOGPX_lLSjdlyZIALZrfGtXGPndFaLDdDrtspdQFflMQ_fmoGAnM7ycpE4duvfqDLeV550qXecVUOL7Ps0NPVLUURNkQklA2lKKT6WaO4cZ_GSvEksCYoD--JglBVCrtZFXfz6jXN2qdz-mdmaSNh-p-af1RGFii1fRvLw1hT-M","UiLocales":null,"Nonce":"637240130596354159.MmUwM2FiZDgtMGEwZC00NzAzLTllZTMtY2ZkYTAyZjc1Zjc5YTI1ZDAzODItMDIwMC00MGE5LWIxYjgtNWI1ZTM5N2RlNjBh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"cd385e5aefe2c8df88dfc42d79096f02","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240130596354159.MmUwM2FiZDgtMGEwZC00NzAzLTllZTMtY2ZkYTAyZjc1Zjc5YTI1ZDAzODItMDIwMC00MGE5LWIxYjgtNWI1ZTM5N2RlNjBh","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeL3hY-HnIXA-wHVkE30AGADqnr6_HlX4YkwLbVIVBcR0ga32Dj4BJILR4ZotP_XeGXOjTG7ECyA7I7KkFCzakP85Vf60tBTPLP1pZBZhApcFgPhNSlUuCqnj8UsW5_HdgBs3jqQBiVgkTW_aKtMBwVOUOGPX_lLSjdlyZIALZrfGtXGPndFaLDdDrtspdQFflMQ_fmoGAnM7ycpE4duvfqDLeV550qXecVUOL7Ps0NPVLUURNkQklA2lKKT6WaO4cZ_GSvEksCYoD--JglBVCrtZFXfz6jXN2qdz-mdmaSNh-p-af1RGFii1fRvLw1hT-M","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 11:44:19.846 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2020-05-02 11:44:19.852 +01:00 [DBG] Scopes contains offline_access, consent is required
2020-05-02 11:44:19.853 +01:00 [INF] Showing consent: User has not yet consented
2020-05-02 11:44:19.900 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:44:19.903 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:44:19.903 +01:00 [DBG] No PKCE used.
2020-05-02 11:44:19.918 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:44:21.365 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-05-02 11:44:21.397 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:44:21.400 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:44:21.400 +01:00 [DBG] No PKCE used.
2020-05-02 11:44:21.414 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:44:21.435 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-05-02 11:44:21.435 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-05-02 11:44:21.436 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-05-02 11:44:21.439 +01:00 [DBG] Start authorize callback request
2020-05-02 11:44:21.443 +01:00 [DBG] User in authorize request: 2
2020-05-02 11:44:21.443 +01:00 [DBG] Start authorize request protocol validation
2020-05-02 11:44:21.445 +01:00 [DBG] Checking for PKCE parameters
2020-05-02 11:44:21.446 +01:00 [DBG] No PKCE used.
2020-05-02 11:44:21.460 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-05-02 11:44:21.461 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":"http://localhost:5002/signin-oidc","AllowedRedirectUris":["http://localhost:5002/signin-oidc"],"SubjectId":"2","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 offline_access","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeL3hY-HnIXA-wHVkE30AGADqnr6_HlX4YkwLbVIVBcR0ga32Dj4BJILR4ZotP_XeGXOjTG7ECyA7I7KkFCzakP85Vf60tBTPLP1pZBZhApcFgPhNSlUuCqnj8UsW5_HdgBs3jqQBiVgkTW_aKtMBwVOUOGPX_lLSjdlyZIALZrfGtXGPndFaLDdDrtspdQFflMQ_fmoGAnM7ycpE4duvfqDLeV550qXecVUOL7Ps0NPVLUURNkQklA2lKKT6WaO4cZ_GSvEksCYoD--JglBVCrtZFXfz6jXN2qdz-mdmaSNh-p-af1RGFii1fRvLw1hT-M","UiLocales":null,"Nonce":"637240130596354159.MmUwM2FiZDgtMGEwZC00NzAzLTllZTMtY2ZkYTAyZjc1Zjc5YTI1ZDAzODItMDIwMC00MGE5LWIxYjgtNWI1ZTM5N2RlNjBh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"cd385e5aefe2c8df88dfc42d79096f02","Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5002/signin-oidc","response_type":"code id_token","scope":"openid profile api1 offline_access","response_mode":"form_post","nonce":"637240130596354159.MmUwM2FiZDgtMGEwZC00NzAzLTllZTMtY2ZkYTAyZjc1Zjc5YTI1ZDAzODItMDIwMC00MGE5LWIxYjgtNWI1ZTM5N2RlNjBh","state":"CfDJ8CWMbb9cwLZFoCyfyt33qeL3hY-HnIXA-wHVkE30AGADqnr6_HlX4YkwLbVIVBcR0ga32Dj4BJILR4ZotP_XeGXOjTG7ECyA7I7KkFCzakP85Vf60tBTPLP1pZBZhApcFgPhNSlUuCqnj8UsW5_HdgBs3jqQBiVgkTW_aKtMBwVOUOGPX_lLSjdlyZIALZrfGtXGPndFaLDdDrtspdQFflMQ_fmoGAnM7ycpE4duvfqDLeV550qXecVUOL7Ps0NPVLUURNkQklA2lKKT6WaO4cZ_GSvEksCYoD--JglBVCrtZFXfz6jXN2qdz-mdmaSNh-p-af1RGFii1fRvLw1hT-M","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-05-02 11:44:21.461 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2020-05-02 11:44:21.461 +01:00 [DBG] Scopes contains offline_access, consent is required
2020-05-02 11:44:21.465 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2020-05-02 11:44:21.466 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2020-05-02 11:44:21.468 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 2
2020-05-02 11:44:21.533 +01:00 [DBG] Creating Hybrid Flow response.
2020-05-02 11:44:21.551 +01:00 [DBG] Creating Implicit Flow response.
2020-05-02 11:44:21.557 +01:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2020-05-02 11:44:21.559 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2020-05-02 11:44:21.606 +01:00 [INF] Authorize endpoint response
{"SubjectId":"2","ClientId":"mvc","RedirectUri":"http://localhost:5002/signin-oidc","State":"CfDJ8CWMbb9cwLZFoCyfyt33qeL3hY-HnIXA-wHVkE30AGADqnr6_HlX4YkwLbVIVBcR0ga32Dj4BJILR4ZotP_XeGXOjTG7ECyA7I7KkFCzakP85Vf60tBTPLP1pZBZhApcFgPhNSlUuCqnj8UsW5_HdgBs3jqQBiVgkTW_aKtMBwVOUOGPX_lLSjdlyZIALZrfGtXGPndFaLDdDrtspdQFflMQ_fmoGAnM7ycpE4duvfqDLeV550qXecVUOL7Ps0NPVLUURNkQklA2lKKT6WaO4cZ_GSvEksCYoD--JglBVCrtZFXfz6jXN2qdz-mdmaSNh-p-af1RGFii1fRvLw1hT-M","Scope":"openid profile api1 offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-05-02 11:44:21.723 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:44:21.726 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:44:21.726 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:44:21.731 +01:00 [DBG] Start token request.
2020-05-02 11:44:21.735 +01:00 [DBG] Start client validation
2020-05-02 11:44:21.740 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:44:21.742 +01:00 [DBG] Start parsing for secret in post body
2020-05-02 11:44:21.743 +01:00 [DBG] Parser found secret: PostBodySecretParser
2020-05-02 11:44:21.743 +01:00 [DBG] Secret id found: mvc
2020-05-02 11:44:21.752 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:44:21.752 +01:00 [DBG] Client validation success
2020-05-02 11:44:21.756 +01:00 [DBG] Start token request validation
2020-05-02 11:44:21.763 +01:00 [DBG] Start validation of authorization code token request
2020-05-02 11:44:21.792 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2020-05-02 11:44:21.792 +01:00 [DBG] Validation of authorization code token request success
2020-05-02 11:44:21.793 +01:00 [INF] Token request validation success
{"ClientId":"mvc","ClientName":"MVC Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"e44a9f3b4c7900bf7867bcc195f22074f8a2112bc22c5997bf393ce5a8ba53d1","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvc","client_secret":"***REDACTED***","code":"e44a9f3b4c7900bf7867bcc195f22074f8a2112bc22c5997bf393ce5a8ba53d1","grant_type":"authorization_code","redirect_uri":"http://localhost:5002/signin-oidc"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:44:21.820 +01:00 [DBG] Getting claims for access token for client: mvc
2020-05-02 11:44:21.820 +01:00 [DBG] Getting claims for access token for subject: 2
2020-05-02 11:44:21.822 +01:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:44:21.824 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:44:21.829 +01:00 [DBG] Creating refresh token
2020-05-02 11:44:21.829 +01:00 [DBG] Setting an absolute lifetime: 2592000
2020-05-02 11:44:21.849 +01:00 [DBG] Getting claims for identity token for subject: 2 and client: mvc
2020-05-02 11:44:21.849 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2020-05-02 11:44:21.853 +01:00 [DBG] Token request success.
2020-05-02 11:44:21.868 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-05-02 11:44:21.869 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-05-02 11:44:21.869 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-05-02 11:44:21.874 +01:00 [DBG] Start userinfo request
2020-05-02 11:44:21.876 +01:00 [DBG] Bearer token found in header
2020-05-02 11:44:21.900 +01:00 [DBG] IsActive called from: AccessTokenValidation
2020-05-02 11:44:21.900 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-05-02 11:44:21.901 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1588416261,"exp":1588419861,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvc","sub":"2","auth_time":1588415585,"idp":"local","name":"Bob","website":"https://bob.com","scope":["openid","profile","api1","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-05-02 11:44:21.902 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2020-05-02 11:44:21.905 +01:00 [DBG] Creating userinfo response
2020-05-02 11:44:21.908 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:44:21.910 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:44:21.914 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2020-05-02 11:44:21.914 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2020-05-02 11:44:21.916 +01:00 [DBG] Get profile called for subject 2 from client MVC Client with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2020-05-02 11:44:21.916 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:44:21.917 +01:00 [INF] Profile service returned the following claim types: name website
2020-05-02 11:44:21.917 +01:00 [DBG] End userinfo request
2020-05-02 11:44:25.235 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:44:25.235 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:44:25.235 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:44:25.235 +01:00 [DBG] Start discovery request
2020-05-02 11:44:25.329 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:44:25.330 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:44:25.330 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:44:25.330 +01:00 [DBG] Start key discovery request
2020-05-02 11:45:47.980 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 11:45:48.339 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 11:45:48.339 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 11:45:48.340 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 11:45:48.340 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 11:45:48.340 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 11:45:48.340 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 11:45:49.068 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 11:45:49.069 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 11:45:49.069 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 11:45:49.069 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 11:45:49.069 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 11:45:49.069 +01:00 [DBG] Error Url: /home/error
2020-05-02 11:45:49.069 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 11:45:53.484 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:45:53.488 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:45:53.488 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:45:53.490 +01:00 [DBG] Start discovery request
2020-05-02 11:45:53.705 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:45:53.708 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:45:53.708 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:45:53.711 +01:00 [DBG] Start key discovery request
2020-05-02 11:47:21.364 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:47:21.367 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:47:21.368 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:47:21.369 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:47:21.369 +01:00 [DBG] Start discovery request
2020-05-02 11:47:21.369 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:47:21.369 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:47:21.369 +01:00 [DBG] Start discovery request
2020-05-02 11:48:30.347 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 11:48:30.738 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 11:48:30.738 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 11:48:30.738 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 11:48:30.738 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 11:48:30.739 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 11:48:30.739 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 11:48:31.366 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 11:48:31.367 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 11:48:31.367 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 11:48:31.367 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 11:48:31.367 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 11:48:31.367 +01:00 [DBG] Error Url: /home/error
2020-05-02 11:48:31.367 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 11:48:35.268 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:48:35.271 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:48:35.271 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:48:35.273 +01:00 [DBG] Start discovery request
2020-05-02 11:48:35.492 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:48:35.517 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:48:35.517 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:48:35.519 +01:00 [DBG] Start key discovery request
2020-05-02 11:48:37.662 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:48:37.662 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:48:37.662 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:48:37.662 +01:00 [DBG] Start discovery request
2020-05-02 11:48:37.674 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:48:37.675 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:48:37.675 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:48:37.675 +01:00 [DBG] Start key discovery request
2020-05-02 11:48:56.951 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:48:56.956 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:48:56.956 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:48:56.965 +01:00 [DBG] Start token request.
2020-05-02 11:48:56.974 +01:00 [DBG] Start client validation
2020-05-02 11:48:56.977 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:48:56.978 +01:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2020-05-02 11:48:56.978 +01:00 [DBG] Secret id found: api1.client
2020-05-02 11:48:57.056 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:48:57.056 +01:00 [DBG] Client validation success
2020-05-02 11:48:57.073 +01:00 [DBG] Start token request validation
2020-05-02 11:48:57.080 +01:00 [DBG] Start validation of custom grant token request
2020-05-02 11:48:57.207 +01:00 [DBG] IsActive called from: AccessTokenValidation
2020-05-02 11:48:57.208 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-05-02 11:48:57.217 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1588416261,"exp":1588419861,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvc","sub":"2","auth_time":1588415585,"idp":"local","name":"Bob","website":"https://bob.com","scope":["openid","profile","api1","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-05-02 11:48:57.232 +01:00 [DBG] IsActive called from: ExtensionGrantValidation
2020-05-02 11:48:57.232 +01:00 [DBG] Validation of extension grant token request success
2020-05-02 11:48:57.234 +01:00 [INF] Token request validation success
{"ClientId":"api1.client","ClientName":null,"GrantType":"delegation","Scopes":"api2","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"delegation","scope":"api2","token":"eyJhbGciOiJSUzI1NiIsImtpZCI6IjRlMTNiY2NjNWEyOTExNzY3NTRiZDRhZjE3ZWRkYWNkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1ODg0MTYyNjEsImV4cCI6MTU4ODQxOTg2MSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjpbImh0dHA6Ly9sb2NhbGhvc3Q6NTAwMC9yZXNvdXJjZXMiLCJhcGkxIl0sImNsaWVudF9pZCI6Im12YyIsInN1YiI6IjIiLCJhdXRoX3RpbWUiOjE1ODg0MTU1ODUsImlkcCI6ImxvY2FsIiwibmFtZSI6IkJvYiIsIndlYnNpdGUiOiJodHRwczovL2JvYi5jb20iLCJzY29wZSI6WyJvcGVuaWQiLCJwcm9maWxlIiwiYXBpMSIsIm9mZmxpbmVfYWNjZXNzIl0sImFtciI6WyJwd2QiXX0.0ciga3r5hkRCLPVMRXtc7LoAmSSKzJArq5XdN2L0TsMjk03g1j-yBxqUikg0h7X5rxq5YE3QKRBrFRKzl8LUfeeqO96Y8WLfLk9BkyT98Gz89777gvH7HyK3E6KbihwhHsISSil05nS8DNSjcTbtyDz3PrimYXv2iL9HNmXtcmyjVwTayVKiGCj3aWr8WHzPbodhy8DbTf0U0uC-6OIPeHctTFIdME1h4Es2O4k2g9CYqV-HHeQ21S1515R_sNmGtJ5t3mcMWHa-PfH3WBrQEwXbp3A4ozOeoFwCr2qfMibWc9RiWhgRJu_PofffYJz1yDhdFI9DfGOdpWVXV-nxcA"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:48:57.249 +01:00 [DBG] Getting claims for access token for client: api1.client
2020-05-02 11:48:57.250 +01:00 [DBG] Getting claims for access token for subject: 2
2020-05-02 11:48:57.253 +01:00 [DBG] Get profile called for subject 2 from client api1.client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:48:57.254 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:48:57.275 +01:00 [DBG] Token request success.
2020-05-02 11:49:39.661 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:49:39.667 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:49:39.667 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:49:39.667 +01:00 [DBG] Start discovery request
2020-05-02 11:49:39.758 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:49:39.759 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:49:39.759 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:49:39.759 +01:00 [DBG] Start key discovery request
2020-05-02 11:50:22.001 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:50:22.001 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:50:22.001 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:50:22.001 +01:00 [DBG] Start discovery request
2020-05-02 11:50:22.011 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:50:22.012 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:50:22.012 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:50:22.012 +01:00 [DBG] Start key discovery request
2020-05-02 11:50:22.019 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:50:22.020 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:50:22.020 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:50:22.020 +01:00 [DBG] Start token request.
2020-05-02 11:50:22.020 +01:00 [DBG] Start client validation
2020-05-02 11:50:22.020 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:50:22.020 +01:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2020-05-02 11:50:22.020 +01:00 [DBG] Secret id found: api1.client
2020-05-02 11:50:22.023 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:50:22.023 +01:00 [DBG] Client validation success
2020-05-02 11:50:22.023 +01:00 [DBG] Start token request validation
2020-05-02 11:50:22.023 +01:00 [DBG] Start validation of custom grant token request
2020-05-02 11:50:22.044 +01:00 [DBG] IsActive called from: AccessTokenValidation
2020-05-02 11:50:22.044 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-05-02 11:50:22.045 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1588416261,"exp":1588419861,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvc","sub":"2","auth_time":1588415585,"idp":"local","name":"Bob","website":"https://bob.com","scope":["openid","profile","api1","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-05-02 11:50:22.045 +01:00 [DBG] IsActive called from: ExtensionGrantValidation
2020-05-02 11:50:22.045 +01:00 [DBG] Validation of extension grant token request success
2020-05-02 11:50:22.045 +01:00 [INF] Token request validation success
{"ClientId":"api1.client","ClientName":null,"GrantType":"delegation","Scopes":"api2","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"delegation","scope":"api2","token":"eyJhbGciOiJSUzI1NiIsImtpZCI6IjRlMTNiY2NjNWEyOTExNzY3NTRiZDRhZjE3ZWRkYWNkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1ODg0MTYyNjEsImV4cCI6MTU4ODQxOTg2MSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjpbImh0dHA6Ly9sb2NhbGhvc3Q6NTAwMC9yZXNvdXJjZXMiLCJhcGkxIl0sImNsaWVudF9pZCI6Im12YyIsInN1YiI6IjIiLCJhdXRoX3RpbWUiOjE1ODg0MTU1ODUsImlkcCI6ImxvY2FsIiwibmFtZSI6IkJvYiIsIndlYnNpdGUiOiJodHRwczovL2JvYi5jb20iLCJzY29wZSI6WyJvcGVuaWQiLCJwcm9maWxlIiwiYXBpMSIsIm9mZmxpbmVfYWNjZXNzIl0sImFtciI6WyJwd2QiXX0.0ciga3r5hkRCLPVMRXtc7LoAmSSKzJArq5XdN2L0TsMjk03g1j-yBxqUikg0h7X5rxq5YE3QKRBrFRKzl8LUfeeqO96Y8WLfLk9BkyT98Gz89777gvH7HyK3E6KbihwhHsISSil05nS8DNSjcTbtyDz3PrimYXv2iL9HNmXtcmyjVwTayVKiGCj3aWr8WHzPbodhy8DbTf0U0uC-6OIPeHctTFIdME1h4Es2O4k2g9CYqV-HHeQ21S1515R_sNmGtJ5t3mcMWHa-PfH3WBrQEwXbp3A4ozOeoFwCr2qfMibWc9RiWhgRJu_PofffYJz1yDhdFI9DfGOdpWVXV-nxcA"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:50:22.045 +01:00 [DBG] Getting claims for access token for client: api1.client
2020-05-02 11:50:22.045 +01:00 [DBG] Getting claims for access token for subject: 2
2020-05-02 11:50:22.045 +01:00 [DBG] Get profile called for subject 2 from client api1.client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:50:22.045 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:50:22.047 +01:00 [DBG] Token request success.
2020-05-02 11:51:18.226 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 11:51:18.608 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 11:51:18.608 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 11:51:18.608 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 11:51:18.608 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 11:51:18.608 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 11:51:18.608 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 11:51:19.095 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 11:51:19.097 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 11:51:19.097 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 11:51:19.097 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 11:51:19.097 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 11:51:19.097 +01:00 [DBG] Error Url: /home/error
2020-05-02 11:51:19.097 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 11:51:24.156 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:51:24.159 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:51:24.159 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:51:24.162 +01:00 [DBG] Start discovery request
2020-05-02 11:51:24.378 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:51:24.379 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:51:24.379 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:51:24.382 +01:00 [DBG] Start key discovery request
2020-05-02 11:51:27.946 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:51:27.947 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:51:27.947 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:51:27.947 +01:00 [DBG] Start discovery request
2020-05-02 11:51:27.961 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:51:27.962 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:51:27.962 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:51:27.962 +01:00 [DBG] Start key discovery request
2020-05-02 11:51:27.991 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:51:27.995 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:51:27.995 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:51:28.001 +01:00 [DBG] Start token request.
2020-05-02 11:51:28.006 +01:00 [DBG] Start client validation
2020-05-02 11:51:28.009 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:51:28.010 +01:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2020-05-02 11:51:28.010 +01:00 [DBG] Secret id found: api1.client
2020-05-02 11:51:28.080 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:51:28.080 +01:00 [DBG] Client validation success
2020-05-02 11:51:28.098 +01:00 [DBG] Start token request validation
2020-05-02 11:51:28.104 +01:00 [DBG] Start validation of custom grant token request
2020-05-02 11:51:28.230 +01:00 [DBG] IsActive called from: AccessTokenValidation
2020-05-02 11:51:28.231 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-05-02 11:51:28.240 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1588416261,"exp":1588419861,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvc","sub":"2","auth_time":1588415585,"idp":"local","name":"Bob","website":"https://bob.com","scope":["openid","profile","api1","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-05-02 11:51:28.251 +01:00 [DBG] IsActive called from: ExtensionGrantValidation
2020-05-02 11:51:28.251 +01:00 [DBG] Validation of extension grant token request success
2020-05-02 11:51:28.254 +01:00 [INF] Token request validation success
{"ClientId":"api1.client","ClientName":null,"GrantType":"delegation","Scopes":"api2","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"delegation","scope":"api2","token":"eyJhbGciOiJSUzI1NiIsImtpZCI6IjRlMTNiY2NjNWEyOTExNzY3NTRiZDRhZjE3ZWRkYWNkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1ODg0MTYyNjEsImV4cCI6MTU4ODQxOTg2MSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjpbImh0dHA6Ly9sb2NhbGhvc3Q6NTAwMC9yZXNvdXJjZXMiLCJhcGkxIl0sImNsaWVudF9pZCI6Im12YyIsInN1YiI6IjIiLCJhdXRoX3RpbWUiOjE1ODg0MTU1ODUsImlkcCI6ImxvY2FsIiwibmFtZSI6IkJvYiIsIndlYnNpdGUiOiJodHRwczovL2JvYi5jb20iLCJzY29wZSI6WyJvcGVuaWQiLCJwcm9maWxlIiwiYXBpMSIsIm9mZmxpbmVfYWNjZXNzIl0sImFtciI6WyJwd2QiXX0.0ciga3r5hkRCLPVMRXtc7LoAmSSKzJArq5XdN2L0TsMjk03g1j-yBxqUikg0h7X5rxq5YE3QKRBrFRKzl8LUfeeqO96Y8WLfLk9BkyT98Gz89777gvH7HyK3E6KbihwhHsISSil05nS8DNSjcTbtyDz3PrimYXv2iL9HNmXtcmyjVwTayVKiGCj3aWr8WHzPbodhy8DbTf0U0uC-6OIPeHctTFIdME1h4Es2O4k2g9CYqV-HHeQ21S1515R_sNmGtJ5t3mcMWHa-PfH3WBrQEwXbp3A4ozOeoFwCr2qfMibWc9RiWhgRJu_PofffYJz1yDhdFI9DfGOdpWVXV-nxcA"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:51:28.269 +01:00 [DBG] Getting claims for access token for client: api1.client
2020-05-02 11:51:28.270 +01:00 [DBG] Getting claims for access token for subject: 2
2020-05-02 11:51:28.273 +01:00 [DBG] Get profile called for subject 2 from client api1.client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:51:28.275 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:51:28.294 +01:00 [DBG] Token request success.
2020-05-02 11:51:29.177 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:51:29.178 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:51:29.178 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:51:29.178 +01:00 [DBG] Start discovery request
2020-05-02 11:51:29.272 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:51:29.273 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:51:29.273 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:51:29.273 +01:00 [DBG] Start key discovery request
2020-05-02 11:51:45.638 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 11:51:46.010 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 11:51:46.011 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 11:51:46.011 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 11:51:46.011 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 11:51:46.011 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 11:51:46.011 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 11:51:46.684 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 11:51:46.685 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 11:51:46.685 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 11:51:46.685 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 11:51:46.685 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 11:51:46.686 +01:00 [DBG] Error Url: /home/error
2020-05-02 11:51:46.686 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 11:51:51.446 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:51:51.450 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:51:51.450 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:51:51.453 +01:00 [DBG] Start discovery request
2020-05-02 11:51:51.664 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:51:51.665 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:51:51.665 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:51:51.668 +01:00 [DBG] Start key discovery request
2020-05-02 11:51:51.858 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:51:51.859 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:51:51.859 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:51:51.859 +01:00 [DBG] Start discovery request
2020-05-02 11:51:51.871 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:51:51.872 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:51:51.872 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:51:51.872 +01:00 [DBG] Start key discovery request
2020-05-02 11:51:51.900 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:51:51.904 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:51:51.904 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:51:51.910 +01:00 [DBG] Start token request.
2020-05-02 11:51:51.915 +01:00 [DBG] Start client validation
2020-05-02 11:51:51.919 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:51:51.919 +01:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2020-05-02 11:51:51.919 +01:00 [DBG] Secret id found: api1.client
2020-05-02 11:51:51.991 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:51:51.991 +01:00 [DBG] Client validation success
2020-05-02 11:51:52.009 +01:00 [DBG] Start token request validation
2020-05-02 11:51:52.015 +01:00 [DBG] Start validation of custom grant token request
2020-05-02 11:51:52.144 +01:00 [DBG] IsActive called from: AccessTokenValidation
2020-05-02 11:51:52.145 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-05-02 11:51:52.154 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1588416261,"exp":1588419861,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvc","sub":"2","auth_time":1588415585,"idp":"local","name":"Bob","website":"https://bob.com","scope":["openid","profile","api1","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-05-02 11:51:52.165 +01:00 [DBG] IsActive called from: ExtensionGrantValidation
2020-05-02 11:51:52.165 +01:00 [DBG] Validation of extension grant token request success
2020-05-02 11:51:52.167 +01:00 [INF] Token request validation success
{"ClientId":"api1.client","ClientName":null,"GrantType":"delegation","Scopes":"api2","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"delegation","scope":"api2","token":"eyJhbGciOiJSUzI1NiIsImtpZCI6IjRlMTNiY2NjNWEyOTExNzY3NTRiZDRhZjE3ZWRkYWNkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1ODg0MTYyNjEsImV4cCI6MTU4ODQxOTg2MSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjpbImh0dHA6Ly9sb2NhbGhvc3Q6NTAwMC9yZXNvdXJjZXMiLCJhcGkxIl0sImNsaWVudF9pZCI6Im12YyIsInN1YiI6IjIiLCJhdXRoX3RpbWUiOjE1ODg0MTU1ODUsImlkcCI6ImxvY2FsIiwibmFtZSI6IkJvYiIsIndlYnNpdGUiOiJodHRwczovL2JvYi5jb20iLCJzY29wZSI6WyJvcGVuaWQiLCJwcm9maWxlIiwiYXBpMSIsIm9mZmxpbmVfYWNjZXNzIl0sImFtciI6WyJwd2QiXX0.0ciga3r5hkRCLPVMRXtc7LoAmSSKzJArq5XdN2L0TsMjk03g1j-yBxqUikg0h7X5rxq5YE3QKRBrFRKzl8LUfeeqO96Y8WLfLk9BkyT98Gz89777gvH7HyK3E6KbihwhHsISSil05nS8DNSjcTbtyDz3PrimYXv2iL9HNmXtcmyjVwTayVKiGCj3aWr8WHzPbodhy8DbTf0U0uC-6OIPeHctTFIdME1h4Es2O4k2g9CYqV-HHeQ21S1515R_sNmGtJ5t3mcMWHa-PfH3WBrQEwXbp3A4ozOeoFwCr2qfMibWc9RiWhgRJu_PofffYJz1yDhdFI9DfGOdpWVXV-nxcA"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:51:52.183 +01:00 [DBG] Getting claims for access token for client: api1.client
2020-05-02 11:51:52.183 +01:00 [DBG] Getting claims for access token for subject: 2
2020-05-02 11:51:52.186 +01:00 [DBG] Get profile called for subject 2 from client api1.client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:51:52.188 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:51:52.207 +01:00 [DBG] Token request success.
2020-05-02 11:51:52.351 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:51:52.351 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:51:52.351 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:51:52.351 +01:00 [DBG] Start discovery request
2020-05-02 11:51:52.448 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:51:52.449 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:51:52.449 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:51:52.449 +01:00 [DBG] Start key discovery request
2020-05-02 11:53:03.347 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 11:53:03.770 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 11:53:03.770 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 11:53:03.770 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 11:53:03.770 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 11:53:03.770 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 11:53:03.770 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 11:53:04.373 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 11:53:04.375 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 11:53:04.375 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 11:53:04.375 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 11:53:04.375 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 11:53:04.375 +01:00 [DBG] Error Url: /home/error
2020-05-02 11:53:04.375 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 11:53:08.073 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:53:08.076 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:53:08.076 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:53:08.079 +01:00 [DBG] Start discovery request
2020-05-02 11:53:08.291 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:53:08.292 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:53:08.292 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:53:08.296 +01:00 [DBG] Start key discovery request
2020-05-02 11:53:08.498 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:53:08.499 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:53:08.499 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:53:08.499 +01:00 [DBG] Start discovery request
2020-05-02 11:53:08.510 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:53:08.511 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:53:08.511 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:53:08.512 +01:00 [DBG] Start key discovery request
2020-05-02 11:53:08.543 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:53:08.546 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:53:08.546 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:53:08.551 +01:00 [DBG] Start token request.
2020-05-02 11:53:08.555 +01:00 [DBG] Start client validation
2020-05-02 11:53:08.559 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:53:08.559 +01:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2020-05-02 11:53:08.559 +01:00 [DBG] Secret id found: api1.client
2020-05-02 11:53:08.628 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:53:08.628 +01:00 [DBG] Client validation success
2020-05-02 11:53:08.645 +01:00 [DBG] Start token request validation
2020-05-02 11:53:08.651 +01:00 [DBG] Start validation of custom grant token request
2020-05-02 11:53:08.774 +01:00 [DBG] IsActive called from: AccessTokenValidation
2020-05-02 11:53:08.775 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-05-02 11:53:08.784 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1588416261,"exp":1588419861,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvc","sub":"2","auth_time":1588415585,"idp":"local","name":"Bob","website":"https://bob.com","scope":["openid","profile","api1","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-05-02 11:53:08.794 +01:00 [DBG] IsActive called from: ExtensionGrantValidation
2020-05-02 11:53:08.794 +01:00 [DBG] Validation of extension grant token request success
2020-05-02 11:53:08.796 +01:00 [INF] Token request validation success
{"ClientId":"api1.client","ClientName":null,"GrantType":"delegation","Scopes":"api2","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"delegation","scope":"api2","token":"eyJhbGciOiJSUzI1NiIsImtpZCI6IjRlMTNiY2NjNWEyOTExNzY3NTRiZDRhZjE3ZWRkYWNkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1ODg0MTYyNjEsImV4cCI6MTU4ODQxOTg2MSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjpbImh0dHA6Ly9sb2NhbGhvc3Q6NTAwMC9yZXNvdXJjZXMiLCJhcGkxIl0sImNsaWVudF9pZCI6Im12YyIsInN1YiI6IjIiLCJhdXRoX3RpbWUiOjE1ODg0MTU1ODUsImlkcCI6ImxvY2FsIiwibmFtZSI6IkJvYiIsIndlYnNpdGUiOiJodHRwczovL2JvYi5jb20iLCJzY29wZSI6WyJvcGVuaWQiLCJwcm9maWxlIiwiYXBpMSIsIm9mZmxpbmVfYWNjZXNzIl0sImFtciI6WyJwd2QiXX0.0ciga3r5hkRCLPVMRXtc7LoAmSSKzJArq5XdN2L0TsMjk03g1j-yBxqUikg0h7X5rxq5YE3QKRBrFRKzl8LUfeeqO96Y8WLfLk9BkyT98Gz89777gvH7HyK3E6KbihwhHsISSil05nS8DNSjcTbtyDz3PrimYXv2iL9HNmXtcmyjVwTayVKiGCj3aWr8WHzPbodhy8DbTf0U0uC-6OIPeHctTFIdME1h4Es2O4k2g9CYqV-HHeQ21S1515R_sNmGtJ5t3mcMWHa-PfH3WBrQEwXbp3A4ozOeoFwCr2qfMibWc9RiWhgRJu_PofffYJz1yDhdFI9DfGOdpWVXV-nxcA"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:53:08.811 +01:00 [DBG] Getting claims for access token for client: api1.client
2020-05-02 11:53:08.811 +01:00 [DBG] Getting claims for access token for subject: 2
2020-05-02 11:53:08.815 +01:00 [DBG] Get profile called for subject 2 from client api1.client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:53:08.816 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:53:08.835 +01:00 [DBG] Token request success.
2020-05-02 11:53:08.976 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:53:08.976 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:53:08.976 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:53:08.976 +01:00 [DBG] Start discovery request
2020-05-02 11:53:09.070 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:53:09.070 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:53:09.070 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:53:09.070 +01:00 [DBG] Start key discovery request
2020-05-02 11:58:19.206 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2020-05-02 11:58:19.601 +01:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-05-02 11:58:19.601 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-05-02 11:58:19.601 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-05-02 11:58:19.601 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-05-02 11:58:19.601 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-05-02 11:58:19.601 +01:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-05-02 11:58:20.258 +01:00 [DBG] Login Url: /Account/Login
2020-05-02 11:58:20.260 +01:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-05-02 11:58:20.260 +01:00 [DBG] Logout Url: /Account/Logout
2020-05-02 11:58:20.260 +01:00 [DBG] ConsentUrl Url: /consent
2020-05-02 11:58:20.260 +01:00 [DBG] Consent Return Url Parameter: returnUrl
2020-05-02 11:58:20.260 +01:00 [DBG] Error Url: /home/error
2020-05-02 11:58:20.260 +01:00 [DBG] Error Id Parameter: errorId
2020-05-02 11:58:34.758 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:58:34.761 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:58:34.762 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:58:34.764 +01:00 [DBG] Start discovery request
2020-05-02 11:58:34.982 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:58:34.983 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:58:34.983 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:58:34.986 +01:00 [DBG] Start key discovery request
2020-05-02 11:58:39.734 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:58:39.734 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:58:39.734 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:58:39.734 +01:00 [DBG] Start discovery request
2020-05-02 11:58:39.745 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:58:39.745 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:58:39.745 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:58:39.745 +01:00 [DBG] Start key discovery request
2020-05-02 11:58:39.776 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-05-02 11:58:39.780 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-05-02 11:58:39.780 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-05-02 11:58:39.785 +01:00 [DBG] Start token request.
2020-05-02 11:58:39.789 +01:00 [DBG] Start client validation
2020-05-02 11:58:39.793 +01:00 [DBG] Start parsing Basic Authentication secret
2020-05-02 11:58:39.793 +01:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2020-05-02 11:58:39.793 +01:00 [DBG] Secret id found: api1.client
2020-05-02 11:58:39.865 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-05-02 11:58:39.865 +01:00 [DBG] Client validation success
2020-05-02 11:58:39.883 +01:00 [DBG] Start token request validation
2020-05-02 11:58:39.889 +01:00 [DBG] Start validation of custom grant token request
2020-05-02 11:58:40.017 +01:00 [DBG] IsActive called from: AccessTokenValidation
2020-05-02 11:58:40.018 +01:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-05-02 11:58:40.027 +01:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1588416261,"exp":1588419861,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvc","sub":"2","auth_time":1588415585,"idp":"local","name":"Bob","website":"https://bob.com","scope":["openid","profile","api1","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-05-02 11:58:40.038 +01:00 [DBG] IsActive called from: ExtensionGrantValidation
2020-05-02 11:58:40.038 +01:00 [DBG] Validation of extension grant token request success
2020-05-02 11:58:40.040 +01:00 [INF] Token request validation success
{"ClientId":"api1.client","ClientName":null,"GrantType":"delegation","Scopes":"api2","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"delegation","scope":"api2","token":"eyJhbGciOiJSUzI1NiIsImtpZCI6IjRlMTNiY2NjNWEyOTExNzY3NTRiZDRhZjE3ZWRkYWNkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1ODg0MTYyNjEsImV4cCI6MTU4ODQxOTg2MSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjpbImh0dHA6Ly9sb2NhbGhvc3Q6NTAwMC9yZXNvdXJjZXMiLCJhcGkxIl0sImNsaWVudF9pZCI6Im12YyIsInN1YiI6IjIiLCJhdXRoX3RpbWUiOjE1ODg0MTU1ODUsImlkcCI6ImxvY2FsIiwibmFtZSI6IkJvYiIsIndlYnNpdGUiOiJodHRwczovL2JvYi5jb20iLCJzY29wZSI6WyJvcGVuaWQiLCJwcm9maWxlIiwiYXBpMSIsIm9mZmxpbmVfYWNjZXNzIl0sImFtciI6WyJwd2QiXX0.0ciga3r5hkRCLPVMRXtc7LoAmSSKzJArq5XdN2L0TsMjk03g1j-yBxqUikg0h7X5rxq5YE3QKRBrFRKzl8LUfeeqO96Y8WLfLk9BkyT98Gz89777gvH7HyK3E6KbihwhHsISSil05nS8DNSjcTbtyDz3PrimYXv2iL9HNmXtcmyjVwTayVKiGCj3aWr8WHzPbodhy8DbTf0U0uC-6OIPeHctTFIdME1h4Es2O4k2g9CYqV-HHeQ21S1515R_sNmGtJ5t3mcMWHa-PfH3WBrQEwXbp3A4ozOeoFwCr2qfMibWc9RiWhgRJu_PofffYJz1yDhdFI9DfGOdpWVXV-nxcA"},"$type":"TokenRequestValidationLog"}
2020-05-02 11:58:40.055 +01:00 [DBG] Getting claims for access token for client: api1.client
2020-05-02 11:58:40.056 +01:00 [DBG] Getting claims for access token for subject: 2
2020-05-02 11:58:40.059 +01:00 [DBG] Get profile called for subject 2 from client api1.client with claim types ["name","website"] via ClaimsProviderAccessToken
2020-05-02 11:58:40.060 +01:00 [DBG] Issued claims: ["name","website"]
2020-05-02 11:58:40.080 +01:00 [DBG] Token request success.
2020-05-02 11:58:40.221 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-05-02 11:58:40.221 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-05-02 11:58:40.221 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-05-02 11:58:40.221 +01:00 [DBG] Start discovery request
2020-05-02 11:58:40.316 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-05-02 11:58:40.316 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-05-02 11:58:40.316 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-05-02 11:58:40.316 +01:00 [DBG] Start key discovery request
